/* contacts-linking.c generated by valac 0.47.2.1-ce69, the Vala compiler
 * generated from contacts-linking.vala, do not modify */

/* -*- Mode: vala; indent-tabs-mode: t; c-basic-offset: 2; tab-width: 8 -*- */
/*
 * Copyright (C) 2011 Alexander Larsson <alexl@redhat.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <glib-object.h>
#include <folks/folks.h>
#include <gee.h>
#include <gio/gio.h>
#include <glib.h>
#include <gobject/gvaluecollector.h>
#include <stdlib.h>
#include <string.h>
#include "contacts.h"

#define CONTACTS_TYPE_LINK_OPERATION (contacts_link_operation_get_type ())
#define CONTACTS_LINK_OPERATION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_LINK_OPERATION, ContactsLinkOperation))
#define CONTACTS_LINK_OPERATION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_LINK_OPERATION, ContactsLinkOperationClass))
#define CONTACTS_IS_LINK_OPERATION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_LINK_OPERATION))
#define CONTACTS_IS_LINK_OPERATION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_LINK_OPERATION))
#define CONTACTS_LINK_OPERATION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_LINK_OPERATION, ContactsLinkOperationClass))

typedef struct _ContactsLinkOperation ContactsLinkOperation;
typedef struct _ContactsLinkOperationClass ContactsLinkOperationClass;
typedef struct _ContactsLinkOperationPrivate ContactsLinkOperationPrivate;

#define CONTACTS_LINK_OPERATION_TYPE_CHANGE (contacts_link_operation_change_get_type ())
#define CONTACTS_LINK_OPERATION_CHANGE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_LINK_OPERATION_TYPE_CHANGE, ContactsLinkOperationChange))
#define CONTACTS_LINK_OPERATION_CHANGE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_LINK_OPERATION_TYPE_CHANGE, ContactsLinkOperationChangeClass))
#define CONTACTS_LINK_OPERATION_IS_CHANGE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_LINK_OPERATION_TYPE_CHANGE))
#define CONTACTS_LINK_OPERATION_IS_CHANGE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_LINK_OPERATION_TYPE_CHANGE))
#define CONTACTS_LINK_OPERATION_CHANGE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_LINK_OPERATION_TYPE_CHANGE, ContactsLinkOperationChangeClass))

typedef struct _ContactsLinkOperationChange ContactsLinkOperationChange;
typedef struct _ContactsLinkOperationChangeClass ContactsLinkOperationChangeClass;
enum  {
	CONTACTS_LINK_OPERATION_0_PROPERTY,
	CONTACTS_LINK_OPERATION_NUM_PROPERTIES
};
static GParamSpec* contacts_link_operation_properties[CONTACTS_LINK_OPERATION_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define CONTACTS_TYPE_PERSONA_ATTRIBUTE (contacts_persona_attribute_get_type ())
#define CONTACTS_PERSONA_ATTRIBUTE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute))
#define CONTACTS_PERSONA_ATTRIBUTE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttributeClass))
#define CONTACTS_IS_PERSONA_ATTRIBUTE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE))
#define CONTACTS_IS_PERSONA_ATTRIBUTE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE))
#define CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttributeClass))

typedef struct _ContactsPersonaAttribute ContactsPersonaAttribute;
typedef struct _ContactsPersonaAttributeClass ContactsPersonaAttributeClass;
typedef struct _ContactsLinkOperationChangePrivate ContactsLinkOperationChangePrivate;
#define _contacts_link_operation_change_unref0(var) ((var == NULL) ? NULL : (var = (contacts_link_operation_change_unref (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _ContactsLinkOperationUndoData ContactsLinkOperationUndoData;
typedef struct _ContactsLinkOperationParamSpecChange ContactsLinkOperationParamSpecChange;
typedef struct _ContactsPersonaAttributePrivate ContactsPersonaAttributePrivate;
enum  {
	CONTACTS_PERSONA_ATTRIBUTE_0_PROPERTY,
	CONTACTS_PERSONA_ATTRIBUTE_NUM_PROPERTIES
};
static GParamSpec* contacts_persona_attribute_properties[CONTACTS_PERSONA_ATTRIBUTE_NUM_PROPERTIES];
#define _g_free0(var) (var = (g_free (var), NULL))

#define CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID (contacts_persona_attribute_local_id_get_type ())
#define CONTACTS_PERSONA_ATTRIBUTE_LOCAL_ID(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID, ContactsPersonaAttributeLocalId))
#define CONTACTS_PERSONA_ATTRIBUTE_LOCAL_ID_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID, ContactsPersonaAttributeLocalIdClass))
#define CONTACTS_IS_PERSONA_ATTRIBUTE_LOCAL_ID(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID))
#define CONTACTS_IS_PERSONA_ATTRIBUTE_LOCAL_ID_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID))
#define CONTACTS_PERSONA_ATTRIBUTE_LOCAL_ID_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID, ContactsPersonaAttributeLocalIdClass))

typedef struct _ContactsPersonaAttributeLocalId ContactsPersonaAttributeLocalId;
typedef struct _ContactsPersonaAttributeLocalIdClass ContactsPersonaAttributeLocalIdClass;
typedef struct _ContactsPersonaAttributeLocalIdPrivate ContactsPersonaAttributeLocalIdPrivate;
enum  {
	CONTACTS_PERSONA_ATTRIBUTE_LOCAL_ID_0_PROPERTY,
	CONTACTS_PERSONA_ATTRIBUTE_LOCAL_ID_NUM_PROPERTIES
};
static GParamSpec* contacts_persona_attribute_local_id_properties[CONTACTS_PERSONA_ATTRIBUTE_LOCAL_ID_NUM_PROPERTIES];
typedef struct _ContactsPersonaAttributeLocalIdPersonaApplyAttributesData ContactsPersonaAttributeLocalIdPersonaApplyAttributesData;
typedef struct _ContactsPersonaAttributeLocalIdSetValueData ContactsPersonaAttributeLocalIdSetValueData;

#define CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS (contacts_persona_attribute_im_address_get_type ())
#define CONTACTS_PERSONA_ATTRIBUTE_IM_ADDRESS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddress))
#define CONTACTS_PERSONA_ATTRIBUTE_IM_ADDRESS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddressClass))
#define CONTACTS_IS_PERSONA_ATTRIBUTE_IM_ADDRESS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS))
#define CONTACTS_IS_PERSONA_ATTRIBUTE_IM_ADDRESS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS))
#define CONTACTS_PERSONA_ATTRIBUTE_IM_ADDRESS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddressClass))

typedef struct _ContactsPersonaAttributeImAddress ContactsPersonaAttributeImAddress;
typedef struct _ContactsPersonaAttributeImAddressClass ContactsPersonaAttributeImAddressClass;
typedef struct _ContactsPersonaAttributeImAddressPrivate ContactsPersonaAttributeImAddressPrivate;
enum  {
	CONTACTS_PERSONA_ATTRIBUTE_IM_ADDRESS_0_PROPERTY,
	CONTACTS_PERSONA_ATTRIBUTE_IM_ADDRESS_NUM_PROPERTIES
};
static GParamSpec* contacts_persona_attribute_im_address_properties[CONTACTS_PERSONA_ATTRIBUTE_IM_ADDRESS_NUM_PROPERTIES];
typedef struct _ContactsPersonaAttributeImAddressPersonaApplyAttributesData ContactsPersonaAttributeImAddressPersonaApplyAttributesData;
typedef struct _ContactsPersonaAttributeImAddressSetValueData ContactsPersonaAttributeImAddressSetValueData;

#define CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE (contacts_persona_attribute_web_service_get_type ())
#define CONTACTS_PERSONA_ATTRIBUTE_WEB_SERVICE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebService))
#define CONTACTS_PERSONA_ATTRIBUTE_WEB_SERVICE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebServiceClass))
#define CONTACTS_IS_PERSONA_ATTRIBUTE_WEB_SERVICE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE))
#define CONTACTS_IS_PERSONA_ATTRIBUTE_WEB_SERVICE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE))
#define CONTACTS_PERSONA_ATTRIBUTE_WEB_SERVICE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebServiceClass))

typedef struct _ContactsPersonaAttributeWebService ContactsPersonaAttributeWebService;
typedef struct _ContactsPersonaAttributeWebServiceClass ContactsPersonaAttributeWebServiceClass;
typedef struct _ContactsPersonaAttributeWebServicePrivate ContactsPersonaAttributeWebServicePrivate;
enum  {
	CONTACTS_PERSONA_ATTRIBUTE_WEB_SERVICE_0_PROPERTY,
	CONTACTS_PERSONA_ATTRIBUTE_WEB_SERVICE_NUM_PROPERTIES
};
static GParamSpec* contacts_persona_attribute_web_service_properties[CONTACTS_PERSONA_ATTRIBUTE_WEB_SERVICE_NUM_PROPERTIES];
typedef struct _ContactsPersonaAttributeWebServicePersonaApplyAttributesData ContactsPersonaAttributeWebServicePersonaApplyAttributesData;
typedef struct _ContactsPersonaAttributeWebServiceSetValueData ContactsPersonaAttributeWebServiceSetValueData;
typedef struct _ContactsPersonaApplyAttributesData ContactsPersonaApplyAttributesData;
#define _g_hash_table_unref0(var) ((var == NULL) ? NULL : (var = (g_hash_table_unref (var), NULL)))
typedef struct _ContactsLinkContactsData ContactsLinkContactsData;
typedef struct _ContactsUnlinkPersonaData ContactsUnlinkPersonaData;

#define CONTACTS_TYPE_LINK_OPERATION2 (contacts_link_operation2_get_type ())
#define CONTACTS_LINK_OPERATION2(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), CONTACTS_TYPE_LINK_OPERATION2, ContactsLinkOperation2))
#define CONTACTS_LINK_OPERATION2_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), CONTACTS_TYPE_LINK_OPERATION2, ContactsLinkOperation2Class))
#define CONTACTS_IS_LINK_OPERATION2(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), CONTACTS_TYPE_LINK_OPERATION2))
#define CONTACTS_IS_LINK_OPERATION2_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), CONTACTS_TYPE_LINK_OPERATION2))
#define CONTACTS_LINK_OPERATION2_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), CONTACTS_TYPE_LINK_OPERATION2, ContactsLinkOperation2Class))

typedef struct _ContactsLinkOperation2 ContactsLinkOperation2;
typedef struct _ContactsLinkOperation2Class ContactsLinkOperation2Class;
typedef struct _ContactsLinkOperation2Private ContactsLinkOperation2Private;
enum  {
	CONTACTS_LINK_OPERATION2_0_PROPERTY,
	CONTACTS_LINK_OPERATION2_NUM_PROPERTIES
};
static GParamSpec* contacts_link_operation2_properties[CONTACTS_LINK_OPERATION2_NUM_PROPERTIES];
typedef struct _ContactsLinkOperation2UndoData ContactsLinkOperation2UndoData;
typedef struct _ContactsLinkContactsListData ContactsLinkContactsListData;

struct _ContactsLinkOperation {
	GObject parent_instance;
	ContactsLinkOperationPrivate * priv;
};

struct _ContactsLinkOperationClass {
	GObjectClass parent_class;
};

struct _ContactsLinkOperationPrivate {
	FolksPersona* _added_persona;
	FolksIndividual* main_contact;
	GeeArrayList* split_out_personas;
	GeeArrayList* changes;
};

struct _ContactsLinkOperationChange {
	GTypeInstance parent_instance;
	volatile int ref_count;
	ContactsLinkOperationChangePrivate * priv;
	ContactsPersonaAttribute* attribute;
	FolksPersona* persona;
	GObject* old_value;
};

struct _ContactsLinkOperationChangeClass {
	GTypeClass parent_class;
	void (*finalize) (ContactsLinkOperationChange *self);
};

struct _ContactsLinkOperationUndoData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsLinkOperation* self;
	FolksIndividual* _tmp0_;
	FolksIndividual* _tmp1_;
	GeeArrayList* _tmp2_;
	GeeArrayList* _p_list;
	GeeArrayList* _tmp3_;
	GeeArrayList* _tmp4_;
	gint _p_size;
	GeeArrayList* _tmp5_;
	gint _tmp6_;
	gint _tmp7_;
	gint _p_index;
	FolksPersona* p;
	GeeArrayList* _tmp8_;
	gpointer _tmp9_;
	FolksPersona* _tmp10_;
	FolksPersona* _tmp11_;
	FolksPersona* _tmp12_;
	FolksPersonaStore* _tmp13_;
	FolksPersonaStore* _tmp14_;
	FolksPersona* _tmp15_;
	GeeArrayList* _c_list;
	GeeArrayList* _tmp16_;
	GeeArrayList* _tmp17_;
	gint _c_size;
	GeeArrayList* _tmp18_;
	gint _tmp19_;
	gint _tmp20_;
	gint _c_index;
	ContactsLinkOperationChange* c;
	GeeArrayList* _tmp21_;
	gpointer _tmp22_;
	ContactsLinkOperationChange* _tmp23_;
	FolksPersona* _tmp24_;
	FolksPersona* _tmp25_;
	ContactsLinkOperationChange* _tmp26_;
	ContactsPersonaAttribute* _tmp27_;
	ContactsLinkOperationChange* _tmp28_;
	FolksPersona* _tmp29_;
	ContactsLinkOperationChange* _tmp30_;
	GObject* _tmp31_;
	GError* e;
	GError* _tmp32_;
	const gchar* _tmp33_;
	FolksIndividual* _tmp34_;
	FolksIndividual* _tmp35_;
	GeeArrayList* _tmp36_;
	GeeArrayList* _vala1__p_list;
	GeeArrayList* _tmp37_;
	GeeArrayList* _tmp38_;
	gint _vala1__p_size;
	GeeArrayList* _tmp39_;
	gint _tmp40_;
	gint _tmp41_;
	gint _vala1__p_index;
	FolksPersona* _vala1_p;
	GeeArrayList* _tmp42_;
	gpointer _tmp43_;
	FolksPersona* _tmp44_;
	GError* _inner_error0_;
};

struct _ContactsLinkOperationParamSpecChange {
	GParamSpec parent_instance;
};

struct _ContactsPersonaAttribute {
	GObject parent_instance;
	ContactsPersonaAttributePrivate * priv;
	gchar* property_name;
};

struct _ContactsPersonaAttributeClass {
	GObjectClass parent_class;
	gboolean (*is_removable) (ContactsPersonaAttribute* self, FolksPersona* from_persona);
	gboolean (*is_referenced_by_persona) (ContactsPersonaAttribute* self, FolksPersona* persona);
	gchar* (*to_string) (ContactsPersonaAttribute* self);
	gboolean (*equal) (ContactsPersonaAttribute* self, ContactsPersonaAttribute* that);
	guint (*hash) (ContactsPersonaAttribute* self);
	void (*persona_apply_attributes) (ContactsPersonaAttribute* self, FolksPersona* persona, GeeSet* added_attributes, GeeSet* removed_attributes, ContactsLinkOperation* operation, GAsyncReadyCallback _callback_, gpointer _user_data_);
	void (*persona_apply_attributes_finish) (ContactsPersonaAttribute* self, GAsyncResult* _res_);
	void (*set_value) (ContactsPersonaAttribute* self, FolksPersona* persona, GObject* value, GAsyncReadyCallback _callback_, gpointer _user_data_);
	void (*set_value_finish) (ContactsPersonaAttribute* self, GAsyncResult* _res_);
};

struct _ContactsPersonaAttributeLocalId {
	ContactsPersonaAttribute parent_instance;
	ContactsPersonaAttributeLocalIdPrivate * priv;
};

struct _ContactsPersonaAttributeLocalIdClass {
	ContactsPersonaAttributeClass parent_class;
};

struct _ContactsPersonaAttributeLocalIdPrivate {
	gchar* value;
};

struct _ContactsPersonaAttributeLocalIdPersonaApplyAttributesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsPersonaAttributeLocalId* self;
	FolksPersona* persona;
	GeeSet* added_attributes;
	GeeSet* removed_attributes;
	ContactsLinkOperation* operation;
	FolksLocalIdDetails* details;
	FolksLocalIdDetails* _tmp0_;
	FolksLocalIdDetails* _tmp1_;
	GeeHashSet* added_values;
	GeeHashSet* _tmp2_;
	GeeIterator* _added_it;
	GeeIterator* _tmp3_;
	GeeIterator* _tmp4_;
	ContactsPersonaAttribute* added;
	GeeIterator* _tmp5_;
	gpointer _tmp6_;
	GeeHashSet* _tmp7_;
	ContactsPersonaAttribute* _tmp8_;
	const gchar* _tmp9_;
	GeeHashSet* removed_values;
	GeeHashSet* _tmp10_;
	GeeIterator* _removed_it;
	GeeIterator* _tmp11_;
	GeeIterator* _tmp12_;
	ContactsPersonaAttribute* removed;
	GeeIterator* _tmp13_;
	gpointer _tmp14_;
	GeeHashSet* _tmp15_;
	ContactsPersonaAttribute* _tmp16_;
	const gchar* _tmp17_;
	GeeHashSet* new_values;
	GeeHashSet* _tmp18_;
	gboolean changed;
	GeeIterator* _v_it;
	FolksLocalIdDetails* _tmp19_;
	GeeSet* _tmp20_;
	GeeSet* _tmp21_;
	GeeIterator* _tmp22_;
	GeeIterator* _tmp23_;
	gchar* v;
	GeeIterator* _tmp24_;
	gpointer _tmp25_;
	GeeHashSet* _tmp26_;
	const gchar* _tmp27_;
	GeeHashSet* _tmp28_;
	const gchar* _tmp29_;
	GeeHashSet* _tmp30_;
	const gchar* _tmp31_;
	GeeHashSet* _tmp32_;
	const gchar* _tmp33_;
	GeeIterator* _v2_it;
	GeeHashSet* _tmp34_;
	GeeIterator* _tmp35_;
	GeeIterator* _tmp36_;
	gchar* v2;
	GeeIterator* _tmp37_;
	gpointer _tmp38_;
	GeeHashSet* _tmp39_;
	const gchar* _tmp40_;
	GeeHashSet* old_value;
	GeeHashSet* _tmp41_;
	GeeHashSet* _tmp42_;
	FolksLocalIdDetails* _tmp43_;
	GeeSet* _tmp44_;
	GeeSet* _tmp45_;
	FolksLocalIdDetails* _tmp46_;
	GeeHashSet* _tmp47_;
	GeeHashSet* _tmp48_;
	GError* e;
	GError* _tmp49_;
	const gchar* _tmp50_;
	GError* _inner_error0_;
};

struct _ContactsPersonaAttributeLocalIdSetValueData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsPersonaAttributeLocalId* self;
	FolksPersona* persona;
	GObject* value;
	FolksLocalIdDetails* details;
	FolksLocalIdDetails* _tmp0_;
	FolksLocalIdDetails* _tmp1_;
	GeeHashSet* v;
	GeeHashSet* _tmp2_;
	FolksLocalIdDetails* _tmp3_;
	GeeHashSet* _tmp4_;
	GError* e;
	GError* _tmp5_;
	const gchar* _tmp6_;
	GError* _inner_error0_;
};

struct _ContactsPersonaAttributeImAddress {
	ContactsPersonaAttribute parent_instance;
	ContactsPersonaAttributeImAddressPrivate * priv;
};

struct _ContactsPersonaAttributeImAddressClass {
	ContactsPersonaAttributeClass parent_class;
};

struct _ContactsPersonaAttributeImAddressPrivate {
	gchar* protocol;
	FolksImFieldDetails* detail;
};

struct _ContactsPersonaAttributeImAddressPersonaApplyAttributesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsPersonaAttributeImAddress* self;
	FolksPersona* persona;
	GeeSet* added_attributes;
	GeeSet* removed_attributes;
	ContactsLinkOperation* operation;
	FolksImDetails* details;
	FolksImDetails* _tmp0_;
	FolksImDetails* _tmp1_;
	GeeHashMultiMap* added_values;
	GeeHashMultiMap* _tmp2_;
	GeeIterator* _added_it;
	GeeIterator* _tmp3_;
	GeeIterator* _tmp4_;
	ContactsPersonaAttribute* added;
	GeeIterator* _tmp5_;
	gpointer _tmp6_;
	GeeHashMultiMap* _tmp7_;
	ContactsPersonaAttribute* _tmp8_;
	const gchar* _tmp9_;
	ContactsPersonaAttribute* _tmp10_;
	FolksImFieldDetails* _tmp11_;
	GeeHashMultiMap* removed_values;
	GeeHashMultiMap* _tmp12_;
	GeeIterator* _removed_it;
	GeeIterator* _tmp13_;
	GeeIterator* _tmp14_;
	ContactsPersonaAttribute* removed;
	GeeIterator* _tmp15_;
	gpointer _tmp16_;
	GeeHashMultiMap* _tmp17_;
	ContactsPersonaAttribute* _tmp18_;
	const gchar* _tmp19_;
	ContactsPersonaAttribute* _tmp20_;
	FolksImFieldDetails* _tmp21_;
	GeeHashMultiMap* new_values;
	GeeHashMultiMap* _tmp22_;
	gboolean changed;
	GeeIterator* _proto1_it;
	FolksImDetails* _tmp23_;
	GeeMultiMap* _tmp24_;
	GeeMultiMap* _tmp25_;
	GeeSet* _tmp26_;
	GeeSet* _tmp27_;
	GeeIterator* _tmp28_;
	GeeIterator* _tmp29_;
	GeeIterator* _tmp30_;
	gchar* proto1;
	GeeIterator* _tmp31_;
	gpointer _tmp32_;
	GeeIterator* _detail1_it;
	FolksImDetails* _tmp33_;
	GeeMultiMap* _tmp34_;
	GeeMultiMap* _tmp35_;
	const gchar* _tmp36_;
	GeeCollection* _tmp37_;
	GeeCollection* _tmp38_;
	GeeIterator* _tmp39_;
	GeeIterator* _tmp40_;
	GeeIterator* _tmp41_;
	FolksImFieldDetails* detail1;
	GeeIterator* _tmp42_;
	gpointer _tmp43_;
	GeeHashMultiMap* _tmp44_;
	const gchar* _tmp45_;
	GeeCollection* _tmp46_;
	GeeCollection* _tmp47_;
	FolksImFieldDetails* _tmp48_;
	gboolean _tmp49_;
	GeeHashMultiMap* _tmp50_;
	const gchar* _tmp51_;
	FolksImFieldDetails* _tmp52_;
	GeeHashMultiMap* _tmp53_;
	const gchar* _tmp54_;
	GeeCollection* _tmp55_;
	GeeCollection* _tmp56_;
	FolksImFieldDetails* _tmp57_;
	gboolean _tmp58_;
	GeeHashMultiMap* _tmp59_;
	const gchar* _tmp60_;
	FolksImFieldDetails* _tmp61_;
	GeeIterator* _proto2_it;
	GeeHashMultiMap* _tmp62_;
	GeeSet* _tmp63_;
	GeeSet* _tmp64_;
	GeeIterator* _tmp65_;
	GeeIterator* _tmp66_;
	GeeIterator* _tmp67_;
	gchar* proto2;
	GeeIterator* _tmp68_;
	gpointer _tmp69_;
	GeeIterator* _detail2_it;
	GeeHashMultiMap* _tmp70_;
	const gchar* _tmp71_;
	GeeCollection* _tmp72_;
	GeeCollection* _tmp73_;
	GeeIterator* _tmp74_;
	GeeIterator* _tmp75_;
	GeeIterator* _tmp76_;
	FolksImFieldDetails* detail2;
	GeeIterator* _tmp77_;
	gpointer _tmp78_;
	GeeHashMultiMap* _tmp79_;
	const gchar* _tmp80_;
	FolksImFieldDetails* _tmp81_;
	GeeMultiMap* old_value;
	FolksImDetails* _tmp82_;
	GeeMultiMap* _tmp83_;
	GeeMultiMap* _tmp84_;
	GeeMultiMap* _tmp85_;
	FolksImDetails* _tmp86_;
	GeeHashMultiMap* _tmp87_;
	GeeMultiMap* _tmp88_;
	GError* e;
	GError* _tmp89_;
	const gchar* _tmp90_;
	GError* _inner_error0_;
};

struct _ContactsPersonaAttributeImAddressSetValueData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsPersonaAttributeImAddress* self;
	FolksPersona* persona;
	GObject* value;
	FolksImDetails* details;
	FolksImDetails* _tmp0_;
	FolksImDetails* _tmp1_;
	GeeHashMultiMap* v;
	GeeHashMultiMap* _tmp2_;
	FolksImDetails* _tmp3_;
	GeeHashMultiMap* _tmp4_;
	GError* e;
	GError* _tmp5_;
	const gchar* _tmp6_;
	GError* _inner_error0_;
};

struct _ContactsPersonaAttributeWebService {
	ContactsPersonaAttribute parent_instance;
	ContactsPersonaAttributeWebServicePrivate * priv;
};

struct _ContactsPersonaAttributeWebServiceClass {
	ContactsPersonaAttributeClass parent_class;
};

struct _ContactsPersonaAttributeWebServicePrivate {
	gchar* service;
	FolksWebServiceFieldDetails* detail;
};

struct _ContactsPersonaAttributeWebServicePersonaApplyAttributesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsPersonaAttributeWebService* self;
	FolksPersona* persona;
	GeeSet* added_attributes;
	GeeSet* removed_attributes;
	ContactsLinkOperation* operation;
	FolksWebServiceDetails* details;
	FolksWebServiceDetails* _tmp0_;
	FolksWebServiceDetails* _tmp1_;
	GeeHashMultiMap* added_values;
	GeeHashMultiMap* _tmp2_;
	GeeIterator* _added_it;
	GeeIterator* _tmp3_;
	GeeIterator* _tmp4_;
	ContactsPersonaAttribute* added;
	GeeIterator* _tmp5_;
	gpointer _tmp6_;
	GeeHashMultiMap* _tmp7_;
	ContactsPersonaAttribute* _tmp8_;
	const gchar* _tmp9_;
	ContactsPersonaAttribute* _tmp10_;
	FolksWebServiceFieldDetails* _tmp11_;
	GeeHashMultiMap* removed_values;
	GeeHashMultiMap* _tmp12_;
	GeeIterator* _removed_it;
	GeeIterator* _tmp13_;
	GeeIterator* _tmp14_;
	ContactsPersonaAttribute* removed;
	GeeIterator* _tmp15_;
	gpointer _tmp16_;
	GeeHashMultiMap* _tmp17_;
	ContactsPersonaAttribute* _tmp18_;
	const gchar* _tmp19_;
	ContactsPersonaAttribute* _tmp20_;
	FolksWebServiceFieldDetails* _tmp21_;
	GeeHashMultiMap* new_values;
	GeeHashMultiMap* _tmp22_;
	gboolean changed;
	GeeIterator* _srv1_it;
	FolksWebServiceDetails* _tmp23_;
	GeeMultiMap* _tmp24_;
	GeeMultiMap* _tmp25_;
	GeeSet* _tmp26_;
	GeeSet* _tmp27_;
	GeeIterator* _tmp28_;
	GeeIterator* _tmp29_;
	GeeIterator* _tmp30_;
	gchar* srv1;
	GeeIterator* _tmp31_;
	gpointer _tmp32_;
	GeeIterator* _detail1_it;
	FolksWebServiceDetails* _tmp33_;
	GeeMultiMap* _tmp34_;
	GeeMultiMap* _tmp35_;
	const gchar* _tmp36_;
	GeeCollection* _tmp37_;
	GeeCollection* _tmp38_;
	GeeIterator* _tmp39_;
	GeeIterator* _tmp40_;
	GeeIterator* _tmp41_;
	FolksWebServiceFieldDetails* detail1;
	GeeIterator* _tmp42_;
	gpointer _tmp43_;
	GeeHashMultiMap* _tmp44_;
	const gchar* _tmp45_;
	GeeCollection* _tmp46_;
	GeeCollection* _tmp47_;
	FolksWebServiceFieldDetails* _tmp48_;
	gboolean _tmp49_;
	GeeHashMultiMap* _tmp50_;
	const gchar* _tmp51_;
	FolksWebServiceFieldDetails* _tmp52_;
	GeeHashMultiMap* _tmp53_;
	const gchar* _tmp54_;
	GeeCollection* _tmp55_;
	GeeCollection* _tmp56_;
	FolksWebServiceFieldDetails* _tmp57_;
	gboolean _tmp58_;
	GeeHashMultiMap* _tmp59_;
	const gchar* _tmp60_;
	FolksWebServiceFieldDetails* _tmp61_;
	GeeIterator* _srv2_it;
	GeeHashMultiMap* _tmp62_;
	GeeSet* _tmp63_;
	GeeSet* _tmp64_;
	GeeIterator* _tmp65_;
	GeeIterator* _tmp66_;
	GeeIterator* _tmp67_;
	gchar* srv2;
	GeeIterator* _tmp68_;
	gpointer _tmp69_;
	GeeIterator* _detail2_it;
	GeeHashMultiMap* _tmp70_;
	const gchar* _tmp71_;
	GeeCollection* _tmp72_;
	GeeCollection* _tmp73_;
	GeeIterator* _tmp74_;
	GeeIterator* _tmp75_;
	GeeIterator* _tmp76_;
	FolksWebServiceFieldDetails* detail2;
	GeeIterator* _tmp77_;
	gpointer _tmp78_;
	GeeHashMultiMap* _tmp79_;
	const gchar* _tmp80_;
	FolksWebServiceFieldDetails* _tmp81_;
	GeeMultiMap* old_value;
	FolksWebServiceDetails* _tmp82_;
	GeeMultiMap* _tmp83_;
	GeeMultiMap* _tmp84_;
	GeeMultiMap* _tmp85_;
	FolksWebServiceDetails* _tmp86_;
	GeeHashMultiMap* _tmp87_;
	GeeMultiMap* _tmp88_;
	GError* e;
	GError* _tmp89_;
	const gchar* _tmp90_;
	GError* _inner_error0_;
};

struct _ContactsPersonaAttributeWebServiceSetValueData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsPersonaAttributeWebService* self;
	FolksPersona* persona;
	GObject* value;
	FolksWebServiceDetails* details;
	FolksWebServiceDetails* _tmp0_;
	FolksWebServiceDetails* _tmp1_;
	GeeHashMultiMap* v;
	GeeHashMultiMap* _tmp2_;
	FolksWebServiceDetails* _tmp3_;
	GeeHashMultiMap* _tmp4_;
	GError* e;
	GError* _tmp5_;
	const gchar* _tmp6_;
	GError* _inner_error0_;
};

struct _ContactsPersonaApplyAttributesData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	FolksPersona* persona;
	GeeSet* added_attributes;
	GeeSet* removed_attributes;
	ContactsLinkOperation* operation;
	GeeHashSet* properties;
	GeeHashSet* _tmp0_;
	GeeIterator* _a1_it;
	GeeIterator* _tmp1_;
	GeeIterator* _tmp2_;
	ContactsPersonaAttribute* a1;
	GeeIterator* _tmp3_;
	gpointer _tmp4_;
	GeeHashSet* _tmp5_;
	ContactsPersonaAttribute* _tmp6_;
	GeeIterator* _a2_it;
	GeeIterator* _tmp7_;
	GeeIterator* _tmp8_;
	ContactsPersonaAttribute* a2;
	GeeIterator* _tmp9_;
	gpointer _tmp10_;
	GeeHashSet* _tmp11_;
	ContactsPersonaAttribute* _tmp12_;
	GeeIterator* _property_it;
	GeeHashSet* _tmp13_;
	GeeIterator* _tmp14_;
	GeeIterator* _tmp15_;
	ContactsPersonaAttribute* property;
	GeeIterator* _tmp16_;
	gpointer _tmp17_;
	GeeHashSet* added;
	GeeHashSet* _tmp18_;
	GeeHashSet* removed;
	GeeHashSet* _tmp19_;
	GeeIterator* _a3_it;
	GeeIterator* _tmp20_;
	GeeIterator* _tmp21_;
	ContactsPersonaAttribute* a3;
	GeeIterator* _tmp22_;
	gpointer _tmp23_;
	ContactsPersonaAttribute* _tmp24_;
	ContactsPersonaAttribute* _tmp25_;
	GeeHashSet* _tmp26_;
	ContactsPersonaAttribute* _tmp27_;
	GeeIterator* _a4_it;
	GeeIterator* _tmp28_;
	GeeIterator* _tmp29_;
	ContactsPersonaAttribute* a4;
	GeeIterator* _tmp30_;
	gpointer _tmp31_;
	ContactsPersonaAttribute* _tmp32_;
	ContactsPersonaAttribute* _tmp33_;
	GeeHashSet* _tmp34_;
	ContactsPersonaAttribute* _tmp35_;
	ContactsPersonaAttribute* _tmp36_;
	GeeHashSet* _tmp37_;
	GeeHashSet* _tmp38_;
};

struct _ContactsLinkContactsData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	FolksIndividual* main;
	FolksIndividual* other;
	ContactsStore* contacts_store;
	ContactsLinkOperation* result;
	ContactsLinkOperation* operation;
	ContactsLinkOperation* _tmp0_;
	ContactsLinkOperation* _tmp1_;
	GeeSet* main_linkables;
	GeeSet* _tmp2_;
	GeeSet* other_linkables;
	GeeSet* _tmp3_;
	GeeSet* linkables;
	GeeSet* _tmp4_;
	GeeSet* _tmp5_;
	GeeSet* _tmp6_;
	GeeSet* _tmp7_;
	GeeSet* _tmp8_;
	FolksPersona* write_persona;
	GeeIterator* _p1_it;
	GeeSet* _tmp9_;
	GeeSet* _tmp10_;
	GeeIterator* _tmp11_;
	GeeIterator* _tmp12_;
	FolksPersona* p1;
	GeeIterator* _tmp13_;
	gpointer _tmp14_;
	gboolean _tmp15_;
	GeeSet* _tmp16_;
	FolksPersona* _tmp17_;
	GeeSet* _tmp18_;
	FolksPersona* _tmp19_;
	FolksPersona* _tmp20_;
	GeeSet* _tmp21_;
	GeeSet* _tmp22_;
	FolksPersona* _tmp23_;
	FolksPersonaStore* _tmp24_;
	FolksPersonaStore* _tmp25_;
	gboolean _tmp26_;
	gboolean _tmp27_;
	gboolean _tmp28_;
	gboolean _tmp29_;
	FolksPersona* _tmp30_;
	FolksPersona* _tmp31_;
	FolksPersonaStore* _tmp32_;
	FolksPersonaStore* _tmp33_;
	gboolean _tmp34_;
	gboolean _tmp35_;
	GeeIterator* _p2_it;
	GeeSet* _tmp36_;
	GeeSet* _tmp37_;
	GeeIterator* _tmp38_;
	GeeIterator* _tmp39_;
	FolksPersona* p2;
	GeeIterator* _tmp40_;
	gpointer _tmp41_;
	FolksPersona* _tmp42_;
	GeeSet* _tmp43_;
	gboolean _tmp44_;
	FolksPersona* _tmp45_;
	FolksPersona* _tmp46_;
	FolksPersonaStore* _tmp47_;
	FolksPersonaStore* _tmp48_;
	gboolean _tmp49_;
	gboolean _tmp50_;
	FolksPersona* _tmp51_;
	FolksPersona* _tmp52_;
	GeeSet* _tmp53_;
	GeeSet* _tmp54_;
	FolksPersona* _tmp55_;
	FolksPersonaStore* _tmp56_;
	FolksPersonaStore* _tmp57_;
	gboolean _tmp58_;
	gboolean _tmp59_;
	FolksPersona* _tmp60_;
	GHashTable* details;
	GHashFunc _tmp61_;
	GEqualFunc _tmp62_;
	GHashTable* _tmp63_;
	GValue v;
	GValue _tmp64_;
	const gchar* _tmp65_;
	const gchar* _tmp66_;
	GHashTable* _tmp67_;
	gchar* _tmp68_;
	GValue _tmp69_;
	GValue _tmp70_;
	GValue* _tmp71_;
	FolksPersona* _tmp72_;
	FolksIndividualAggregator* _tmp73_;
	FolksIndividualAggregator* _tmp74_;
	FolksPersonaStore* _tmp75_;
	FolksPersonaStore* _tmp76_;
	GHashTable* _tmp77_;
	FolksPersona* _tmp78_;
	FolksPersona* _tmp79_;
	ContactsLinkOperation* _tmp80_;
	FolksPersona* _tmp81_;
	GeeSet* _tmp82_;
	GeeSet* _tmp83_;
	GeeSet* _tmp84_;
	GeeSet* _tmp85_;
	GeeSet* _tmp86_;
	GError* e;
	GError* _tmp87_;
	const gchar* _tmp88_;
	FolksPersona* _tmp89_;
	GeeSet* _tmp90_;
	ContactsLinkOperation* _tmp91_;
	GError* _inner_error0_;
};

struct _ContactsUnlinkPersonaData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsStore* store;
	FolksIndividual* individual;
	FolksPersona* persona_to_unlink;
	ContactsLinkOperation* result;
	GeeHashSet* persona_to_unlink_removals;
	GeeHashSet* _tmp0_;
	GeeHashSet* other_personas_removals;
	GeeHashSet* _tmp1_;
	ContactsLinkOperation* operation;
	ContactsLinkOperation* _tmp2_;
	ContactsLinkOperation* _tmp3_;
	GeeIterator* _a1_it;
	GeeSet* _tmp4_;
	GeeSet* _tmp5_;
	GeeIterator* _tmp6_;
	GeeIterator* _tmp7_;
	GeeIterator* _tmp8_;
	ContactsPersonaAttribute* a1;
	GeeIterator* _tmp9_;
	gpointer _tmp10_;
	gboolean used_to_link;
	GeeIterator* _persona_it;
	GeeSet* _tmp11_;
	GeeSet* _tmp12_;
	GeeIterator* _tmp13_;
	GeeIterator* _tmp14_;
	FolksPersona* persona;
	GeeIterator* _tmp15_;
	gpointer _tmp16_;
	gboolean _tmp17_;
	FolksPersona* _tmp18_;
	ContactsPersonaAttribute* _tmp19_;
	FolksPersona* _tmp20_;
	ContactsPersonaAttribute* _tmp21_;
	GeeHashSet* _tmp22_;
	ContactsPersonaAttribute* _tmp23_;
	GeeHashSet* _tmp24_;
	ContactsPersonaAttribute* _tmp25_;
	GeeHashSet* main_persona_additions;
	GeeHashSet* _tmp26_;
	GeeIterator* _p1_it;
	GeeSet* _tmp27_;
	GeeSet* _tmp28_;
	GeeIterator* _tmp29_;
	GeeIterator* _tmp30_;
	FolksPersona* p1;
	GeeIterator* _tmp31_;
	gpointer _tmp32_;
	FolksPersona* _tmp33_;
	GeeIterator* _a2_it;
	FolksPersona* _tmp34_;
	GeeSet* _tmp35_;
	GeeSet* _tmp36_;
	GeeIterator* _tmp37_;
	GeeIterator* _tmp38_;
	GeeIterator* _tmp39_;
	ContactsPersonaAttribute* a2;
	GeeIterator* _tmp40_;
	gpointer _tmp41_;
	GeeHashSet* _tmp42_;
	ContactsPersonaAttribute* _tmp43_;
	GeeHashSet* _tmp44_;
	ContactsPersonaAttribute* _tmp45_;
	FolksPersona* main_persona;
	GeeIterator* _p2_it;
	GeeSet* _tmp46_;
	GeeSet* _tmp47_;
	GeeIterator* _tmp48_;
	GeeIterator* _tmp49_;
	FolksPersona* p2;
	GeeIterator* _tmp50_;
	gpointer _tmp51_;
	gboolean _tmp52_;
	FolksPersona* _tmp53_;
	FolksPersona* _tmp54_;
	GeeHashSet* _tmp55_;
	FolksPersona* _tmp56_;
	FolksPersona* _tmp57_;
	FolksPersona* _tmp58_;
	FolksPersonaStore* _tmp59_;
	FolksPersonaStore* _tmp60_;
	gboolean _tmp61_;
	gboolean _tmp62_;
	GeeHashSet* other_personas;
	GeeHashSet* _tmp63_;
	GeeIterator* _p3_it;
	GeeSet* _tmp64_;
	GeeSet* _tmp65_;
	GeeIterator* _tmp66_;
	GeeIterator* _tmp67_;
	FolksPersona* p3;
	GeeIterator* _tmp68_;
	gpointer _tmp69_;
	gboolean _tmp70_;
	FolksPersona* _tmp71_;
	FolksPersona* _tmp72_;
	FolksPersona* _tmp73_;
	GeeHashSet* _tmp74_;
	FolksPersona* _tmp75_;
	gboolean _tmp76_;
	FolksPersona* _tmp77_;
	GeeHashSet* _tmp78_;
	gint _tmp79_;
	gint _tmp80_;
	GHashTable* details;
	GHashFunc _tmp81_;
	GEqualFunc _tmp82_;
	GHashTable* _tmp83_;
	FolksPersona* _tmp84_;
	FolksIndividualAggregator* _tmp85_;
	FolksIndividualAggregator* _tmp86_;
	FolksPersonaStore* _tmp87_;
	FolksPersonaStore* _tmp88_;
	GHashTable* _tmp89_;
	FolksPersona* _tmp90_;
	FolksPersona* _tmp91_;
	FolksPersona* _tmp92_;
	const gchar* _tmp93_;
	const gchar* _tmp94_;
	ContactsLinkOperation* _tmp95_;
	FolksPersona* _tmp96_;
	GError* e;
	GError* _tmp97_;
	const gchar* _tmp98_;
	FolksPersona* _tmp99_;
	FolksPersona* _tmp100_;
	GeeHashSet* _tmp101_;
	GeeHashSet* _tmp102_;
	ContactsLinkOperation* _tmp103_;
	GeeIterator* _p_it;
	GeeHashSet* _tmp104_;
	GeeIterator* _tmp105_;
	GeeIterator* _tmp106_;
	FolksPersona* p;
	GeeIterator* _tmp107_;
	gpointer _tmp108_;
	FolksPersona* _tmp109_;
	GeeHashSet* _tmp110_;
	ContactsLinkOperation* _tmp111_;
	GeeHashSet* _tmp112_;
	ContactsLinkOperation* _tmp113_;
	GError* _inner_error0_;
};

struct _ContactsLinkOperation2 {
	GObject parent_instance;
	ContactsLinkOperation2Private * priv;
};

struct _ContactsLinkOperation2Class {
	GObjectClass parent_class;
};

struct _ContactsLinkOperation2Private {
	ContactsStore* contacts_store;
	GeeLinkedList* old_personas_distribution;
};

struct _ContactsLinkOperation2UndoData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	ContactsLinkOperation2* self;
	FolksIndividual* ind;
	GeeLinkedList* _tmp0_;
	gint _tmp1_;
	gint _tmp2_;
	GeeHashSet* ps;
	GeeLinkedList* _tmp3_;
	gpointer _tmp4_;
	GeeIterator* _p_it;
	GeeHashSet* _tmp5_;
	GeeIterator* _tmp6_;
	GeeIterator* _tmp7_;
	FolksPersona* p;
	GeeIterator* _tmp8_;
	gpointer _tmp9_;
	FolksPersona* _tmp10_;
	FolksIndividual* _tmp11_;
	FolksIndividual* _tmp12_;
	FolksIndividual* _tmp13_;
	FolksIndividual* _tmp14_;
	ContactsStore* _tmp15_;
	FolksIndividualAggregator* _tmp16_;
	FolksIndividualAggregator* _tmp17_;
	FolksIndividual* _tmp18_;
	GError* e1;
	FolksIndividual* _tmp19_;
	const gchar* _tmp20_;
	const gchar* _tmp21_;
	GError* _tmp22_;
	const gchar* _tmp23_;
	GeeLinkedList* _ps_list;
	GeeLinkedList* _tmp24_;
	GeeLinkedList* _tmp25_;
	gint _ps_size;
	GeeLinkedList* _tmp26_;
	gint _tmp27_;
	gint _tmp28_;
	gint _ps_index;
	GeeHashSet* _vala1_ps;
	GeeLinkedList* _tmp29_;
	gpointer _tmp30_;
	ContactsStore* _tmp31_;
	FolksIndividualAggregator* _tmp32_;
	FolksIndividualAggregator* _tmp33_;
	GeeHashSet* _tmp34_;
	GError* _vala1_e1;
	GError* _tmp35_;
	const gchar* _tmp36_;
	GError* _inner_error0_;
};

struct _ContactsLinkContactsListData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	GeeLinkedList* contact_list;
	ContactsStore* contacts_store;
	ContactsLinkOperation2* result;
	ContactsLinkOperation2* operation;
	ContactsLinkOperation2* _tmp0_;
	GeeHashSet* all_personas;
	GeeHashSet* _tmp1_;
	GeeLinkedList* _i_list;
	GeeLinkedList* _tmp2_;
	gint _i_size;
	GeeLinkedList* _tmp3_;
	gint _tmp4_;
	gint _tmp5_;
	gint _i_index;
	FolksIndividual* i;
	GeeLinkedList* _tmp6_;
	gpointer _tmp7_;
	GeeSet* ps;
	FolksIndividual* _tmp8_;
	GeeSet* _tmp9_;
	GeeSet* _tmp10_;
	GeeSet* _tmp11_;
	GeeHashSet* _tmp12_;
	GeeSet* _tmp13_;
	ContactsLinkOperation2* _tmp14_;
	GeeSet* _tmp15_;
	FolksIndividualAggregator* _tmp16_;
	FolksIndividualAggregator* _tmp17_;
	GeeHashSet* _tmp18_;
	GError* e1;
	GError* _tmp19_;
	const gchar* _tmp20_;
	GError* _inner_error0_;
};

static gint ContactsLinkOperation_private_offset;
static gpointer contacts_link_operation_parent_class = NULL;
static gpointer contacts_link_operation_change_parent_class = NULL;
static gpointer contacts_persona_attribute_parent_class = NULL;
static gint ContactsPersonaAttributeLocalId_private_offset;
static gpointer contacts_persona_attribute_local_id_parent_class = NULL;
static gint ContactsPersonaAttributeImAddress_private_offset;
static gpointer contacts_persona_attribute_im_address_parent_class = NULL;
static gint ContactsPersonaAttributeWebService_private_offset;
static gpointer contacts_persona_attribute_web_service_parent_class = NULL;
static gint ContactsLinkOperation2_private_offset;
static gpointer contacts_link_operation2_parent_class = NULL;

GType contacts_link_operation_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsLinkOperation, g_object_unref)
gpointer contacts_link_operation_change_ref (gpointer instance);
void contacts_link_operation_change_unref (gpointer instance);
GParamSpec* contacts_link_operation_param_spec_change (const gchar* name,
                                                       const gchar* nick,
                                                       const gchar* blurb,
                                                       GType object_type,
                                                       GParamFlags flags);
void contacts_link_operation_value_set_change (GValue* value,
                                               gpointer v_object);
void contacts_link_operation_value_take_change (GValue* value,
                                                gpointer v_object);
gpointer contacts_link_operation_value_get_change (const GValue* value);
GType contacts_link_operation_change_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsLinkOperationChange, contacts_link_operation_change_unref)
ContactsLinkOperation* contacts_link_operation_new (void);
ContactsLinkOperation* contacts_link_operation_construct (GType object_type);
void contacts_link_operation_set_main_contact (ContactsLinkOperation* self,
                                               FolksIndividual* individual);
void contacts_link_operation_set_split_out_contact (ContactsLinkOperation* self,
                                                    FolksIndividual* individual);
void contacts_link_operation_added_persona (ContactsLinkOperation* self,
                                            FolksPersona* persona);
GType contacts_persona_attribute_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsPersonaAttribute, g_object_unref)
void contacts_link_operation_add_change (ContactsLinkOperation* self,
                                         ContactsPersonaAttribute* attribute,
                                         FolksPersona* persona,
                                         GObject* old_value);
ContactsLinkOperationChange* contacts_link_operation_change_new (void);
ContactsLinkOperationChange* contacts_link_operation_change_construct (GType object_type);
static void contacts_link_operation_undo_data_free (gpointer _data);
void contacts_link_operation_undo (ContactsLinkOperation* self,
                                   GAsyncReadyCallback _callback_,
                                   gpointer _user_data_);
void contacts_link_operation_undo_finish (ContactsLinkOperation* self,
                                          GAsyncResult* _res_);
static gboolean contacts_link_operation_undo_co (ContactsLinkOperationUndoData* _data_);
static void contacts_link_operation_undo_ready (GObject* source_object,
                                         GAsyncResult* _res_,
                                         gpointer _user_data_);
void contacts_persona_attribute_set_value (ContactsPersonaAttribute* self,
                                           FolksPersona* persona,
                                           GObject* value,
                                           GAsyncReadyCallback _callback_,
                                           gpointer _user_data_);
void contacts_persona_attribute_set_value_finish (ContactsPersonaAttribute* self,
                                                  GAsyncResult* _res_);
static void contacts_link_operation_change_finalize (ContactsLinkOperationChange * obj);
static GType contacts_link_operation_change_get_type_once (void);
static void contacts_link_operation_finalize (GObject * obj);
static GType contacts_link_operation_get_type_once (void);
GeeHashSet* contacts_persona_attribute_create_set (void);
guint contacts_persona_attribute_hash (ContactsPersonaAttribute* self);
gboolean contacts_persona_attribute_equal (ContactsPersonaAttribute* self,
                                           ContactsPersonaAttribute* that);
gboolean contacts_persona_attribute_is_removable (ContactsPersonaAttribute* self,
                                                  FolksPersona* from_persona);
static gboolean contacts_persona_attribute_real_is_removable (ContactsPersonaAttribute* self,
                                                       FolksPersona* from_persona);
static gboolean _vala_string_array_contains (gchar* * stack,
                                      gint stack_length,
                                      const gchar* needle);
gboolean contacts_persona_attribute_is_referenced_by_persona (ContactsPersonaAttribute* self,
                                                              FolksPersona* persona);
static gboolean contacts_persona_attribute_real_is_referenced_by_persona (ContactsPersonaAttribute* self,
                                                                   FolksPersona* persona);
gchar* contacts_persona_attribute_to_string (ContactsPersonaAttribute* self);
static gchar* contacts_persona_attribute_real_to_string (ContactsPersonaAttribute* self);
static gboolean contacts_persona_attribute_real_equal (ContactsPersonaAttribute* self,
                                                ContactsPersonaAttribute* that);
static guint contacts_persona_attribute_real_hash (ContactsPersonaAttribute* self);
void contacts_persona_attribute_persona_apply_attributes (ContactsPersonaAttribute* self,
                                                          FolksPersona* persona,
                                                          GeeSet* added_attributes,
                                                          GeeSet* removed_attributes,
                                                          ContactsLinkOperation* operation,
                                                          GAsyncReadyCallback _callback_,
                                                          gpointer _user_data_);
void contacts_persona_attribute_persona_apply_attributes_finish (ContactsPersonaAttribute* self,
                                                                 GAsyncResult* _res_);
ContactsPersonaAttribute* contacts_persona_attribute_construct (GType object_type);
static void contacts_persona_attribute_finalize (GObject * obj);
static GType contacts_persona_attribute_get_type_once (void);
GType contacts_persona_attribute_local_id_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsPersonaAttributeLocalId, g_object_unref)
ContactsPersonaAttributeLocalId* contacts_persona_attribute_local_id_new (const gchar* value);
ContactsPersonaAttributeLocalId* contacts_persona_attribute_local_id_construct (GType object_type,
                                                                                const gchar* value);
static gboolean contacts_persona_attribute_local_id_real_is_removable (ContactsPersonaAttribute* base,
                                                                FolksPersona* from_persona);
static gchar* contacts_persona_attribute_local_id_real_to_string (ContactsPersonaAttribute* base);
static gboolean contacts_persona_attribute_local_id_real_is_referenced_by_persona (ContactsPersonaAttribute* base,
                                                                            FolksPersona* persona);
static void contacts_persona_attribute_local_id_real_persona_apply_attributes_data_free (gpointer _data);
static void contacts_persona_attribute_local_id_real_persona_apply_attributes (ContactsPersonaAttribute* base,
                                                                        FolksPersona* persona,
                                                                        GeeSet* added_attributes,
                                                                        GeeSet* removed_attributes,
                                                                        ContactsLinkOperation* operation,
                                                                        GAsyncReadyCallback _callback_,
                                                                        gpointer _user_data_);
static gboolean contacts_persona_attribute_local_id_real_persona_apply_attributes_co (ContactsPersonaAttributeLocalIdPersonaApplyAttributesData* _data_);
static void contacts_persona_attribute_local_id_persona_apply_attributes_ready (GObject* source_object,
                                                                         GAsyncResult* _res_,
                                                                         gpointer _user_data_);
static void contacts_persona_attribute_local_id_real_set_value_data_free (gpointer _data);
static void contacts_persona_attribute_local_id_real_set_value (ContactsPersonaAttribute* base,
                                                         FolksPersona* persona,
                                                         GObject* value,
                                                         GAsyncReadyCallback _callback_,
                                                         gpointer _user_data_);
static gboolean contacts_persona_attribute_local_id_real_set_value_co (ContactsPersonaAttributeLocalIdSetValueData* _data_);
static void contacts_persona_attribute_local_id_set_value_ready (GObject* source_object,
                                                          GAsyncResult* _res_,
                                                          gpointer _user_data_);
static gboolean contacts_persona_attribute_local_id_real_equal (ContactsPersonaAttribute* base,
                                                         ContactsPersonaAttribute* _that);
static guint contacts_persona_attribute_local_id_real_hash (ContactsPersonaAttribute* base);
static void contacts_persona_attribute_local_id_finalize (GObject * obj);
static GType contacts_persona_attribute_local_id_get_type_once (void);
GType contacts_persona_attribute_im_address_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsPersonaAttributeImAddress, g_object_unref)
ContactsPersonaAttributeImAddress* contacts_persona_attribute_im_address_new (const gchar* protocol,
                                                                              FolksImFieldDetails* detail);
ContactsPersonaAttributeImAddress* contacts_persona_attribute_im_address_construct (GType object_type,
                                                                                    const gchar* protocol,
                                                                                    FolksImFieldDetails* detail);
static gchar* contacts_persona_attribute_im_address_real_to_string (ContactsPersonaAttribute* base);
static gboolean contacts_persona_attribute_im_address_real_is_referenced_by_persona (ContactsPersonaAttribute* base,
                                                                              FolksPersona* persona);
static void contacts_persona_attribute_im_address_real_persona_apply_attributes_data_free (gpointer _data);
static void contacts_persona_attribute_im_address_real_persona_apply_attributes (ContactsPersonaAttribute* base,
                                                                          FolksPersona* persona,
                                                                          GeeSet* added_attributes,
                                                                          GeeSet* removed_attributes,
                                                                          ContactsLinkOperation* operation,
                                                                          GAsyncReadyCallback _callback_,
                                                                          gpointer _user_data_);
static gboolean contacts_persona_attribute_im_address_real_persona_apply_attributes_co (ContactsPersonaAttributeImAddressPersonaApplyAttributesData* _data_);
static guint _folks_abstract_field_details_hash_static_gee_hash_data_func (gconstpointer v,
                                                                    gpointer self);
static gboolean _folks_abstract_field_details_equal_static_gee_equal_data_func (gconstpointer a,
                                                                         gconstpointer b,
                                                                         gpointer self);
static void contacts_persona_attribute_im_address_persona_apply_attributes_ready (GObject* source_object,
                                                                           GAsyncResult* _res_,
                                                                           gpointer _user_data_);
static void contacts_persona_attribute_im_address_real_set_value_data_free (gpointer _data);
static void contacts_persona_attribute_im_address_real_set_value (ContactsPersonaAttribute* base,
                                                           FolksPersona* persona,
                                                           GObject* value,
                                                           GAsyncReadyCallback _callback_,
                                                           gpointer _user_data_);
static gboolean contacts_persona_attribute_im_address_real_set_value_co (ContactsPersonaAttributeImAddressSetValueData* _data_);
static void contacts_persona_attribute_im_address_set_value_ready (GObject* source_object,
                                                            GAsyncResult* _res_,
                                                            gpointer _user_data_);
static gboolean contacts_persona_attribute_im_address_real_equal (ContactsPersonaAttribute* base,
                                                           ContactsPersonaAttribute* _that);
static guint contacts_persona_attribute_im_address_real_hash (ContactsPersonaAttribute* base);
static void contacts_persona_attribute_im_address_finalize (GObject * obj);
static GType contacts_persona_attribute_im_address_get_type_once (void);
GType contacts_persona_attribute_web_service_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsPersonaAttributeWebService, g_object_unref)
ContactsPersonaAttributeWebService* contacts_persona_attribute_web_service_new (const gchar* service,
                                                                                FolksWebServiceFieldDetails* detail);
ContactsPersonaAttributeWebService* contacts_persona_attribute_web_service_construct (GType object_type,
                                                                                      const gchar* service,
                                                                                      FolksWebServiceFieldDetails* detail);
static gchar* contacts_persona_attribute_web_service_real_to_string (ContactsPersonaAttribute* base);
static gboolean contacts_persona_attribute_web_service_real_is_referenced_by_persona (ContactsPersonaAttribute* base,
                                                                               FolksPersona* persona);
static void contacts_persona_attribute_web_service_real_persona_apply_attributes_data_free (gpointer _data);
static void contacts_persona_attribute_web_service_real_persona_apply_attributes (ContactsPersonaAttribute* base,
                                                                           FolksPersona* persona,
                                                                           GeeSet* added_attributes,
                                                                           GeeSet* removed_attributes,
                                                                           ContactsLinkOperation* operation,
                                                                           GAsyncReadyCallback _callback_,
                                                                           gpointer _user_data_);
static gboolean contacts_persona_attribute_web_service_real_persona_apply_attributes_co (ContactsPersonaAttributeWebServicePersonaApplyAttributesData* _data_);
static void contacts_persona_attribute_web_service_persona_apply_attributes_ready (GObject* source_object,
                                                                            GAsyncResult* _res_,
                                                                            gpointer _user_data_);
static void contacts_persona_attribute_web_service_real_set_value_data_free (gpointer _data);
static void contacts_persona_attribute_web_service_real_set_value (ContactsPersonaAttribute* base,
                                                            FolksPersona* persona,
                                                            GObject* value,
                                                            GAsyncReadyCallback _callback_,
                                                            gpointer _user_data_);
static gboolean contacts_persona_attribute_web_service_real_set_value_co (ContactsPersonaAttributeWebServiceSetValueData* _data_);
static void contacts_persona_attribute_web_service_set_value_ready (GObject* source_object,
                                                             GAsyncResult* _res_,
                                                             gpointer _user_data_);
static gboolean contacts_persona_attribute_web_service_real_equal (ContactsPersonaAttribute* base,
                                                            ContactsPersonaAttribute* _that);
static guint contacts_persona_attribute_web_service_real_hash (ContactsPersonaAttribute* base);
static void contacts_persona_attribute_web_service_finalize (GObject * obj);
static GType contacts_persona_attribute_web_service_get_type_once (void);
void contacts_add_linkable_attributes (GeeHashSet* set,
                                       FolksPersona* persona);
GeeSet* contacts_get_linkable_attributes (FolksPersona* persona);
GeeSet* contacts_get_linkable_attributes_for_individual (FolksIndividual* individual);
gboolean contacts_persona_can_link_to (FolksPersona* persona,
                                       GeeSet* attributes);
gboolean contacts_attr_type_equal (ContactsPersonaAttribute* a,
                                   ContactsPersonaAttribute* b);
static void contacts_persona_apply_attributes_data_free (gpointer _data);
void contacts_persona_apply_attributes (FolksPersona* persona,
                                        GeeSet* added_attributes,
                                        GeeSet* removed_attributes,
                                        ContactsLinkOperation* operation,
                                        GAsyncReadyCallback _callback_,
                                        gpointer _user_data_);
void contacts_persona_apply_attributes_finish (GAsyncResult* _res_);
static gboolean contacts_persona_apply_attributes_co (ContactsPersonaApplyAttributesData* _data_);
static void contacts_persona_apply_attributes_ready (GObject* source_object,
                                              GAsyncResult* _res_,
                                              gpointer _user_data_);
static void contacts_link_contacts_data_free (gpointer _data);
void contacts_link_contacts (FolksIndividual* main,
                             FolksIndividual* other,
                             ContactsStore* contacts_store,
                             GAsyncReadyCallback _callback_,
                             gpointer _user_data_);
ContactsLinkOperation* contacts_link_contacts_finish (GAsyncResult* _res_);
static gboolean contacts_link_contacts_co (ContactsLinkContactsData* _data_);
static void _g_free0_ (gpointer var);
static void _vala_GValue_free (GValue* self);
static void __vala_GValue_free0_ (gpointer var);
static GValue* _g_value_dup (GValue* self);
static void contacts_link_contacts_ready (GObject* source_object,
                                   GAsyncResult* _res_,
                                   gpointer _user_data_);
static void contacts_unlink_persona_data_free (gpointer _data);
void contacts_unlink_persona (ContactsStore* store,
                              FolksIndividual* individual,
                              FolksPersona* persona_to_unlink,
                              GAsyncReadyCallback _callback_,
                              gpointer _user_data_);
ContactsLinkOperation* contacts_unlink_persona_finish (GAsyncResult* _res_);
static gboolean contacts_unlink_persona_co (ContactsUnlinkPersonaData* _data_);
static void contacts_unlink_persona_ready (GObject* source_object,
                                    GAsyncResult* _res_,
                                    gpointer _user_data_);
GType contacts_link_operation2_get_type (void) G_GNUC_CONST;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (ContactsLinkOperation2, g_object_unref)
ContactsLinkOperation2* contacts_link_operation2_new (ContactsStore* contacts_store);
ContactsLinkOperation2* contacts_link_operation2_construct (GType object_type,
                                                            ContactsStore* contacts_store);
void contacts_link_operation2_add_persona_set (ContactsLinkOperation2* self,
                                               GeeSet* persona_set);
static void contacts_link_operation2_undo_data_free (gpointer _data);
void contacts_link_operation2_undo (ContactsLinkOperation2* self,
                                    GAsyncReadyCallback _callback_,
                                    gpointer _user_data_);
void contacts_link_operation2_undo_finish (ContactsLinkOperation2* self,
                                           GAsyncResult* _res_);
static gboolean contacts_link_operation2_undo_co (ContactsLinkOperation2UndoData* _data_);
static void contacts_link_operation2_undo_ready (GObject* source_object,
                                          GAsyncResult* _res_,
                                          gpointer _user_data_);
static void contacts_link_operation2_finalize (GObject * obj);
static GType contacts_link_operation2_get_type_once (void);
static void contacts_link_contacts_list_data_free (gpointer _data);
void contacts_link_contacts_list (GeeLinkedList* contact_list,
                                  ContactsStore* contacts_store,
                                  GAsyncReadyCallback _callback_,
                                  gpointer _user_data_);
ContactsLinkOperation2* contacts_link_contacts_list_finish (GAsyncResult* _res_);
static gboolean contacts_link_contacts_list_co (ContactsLinkContactsListData* _data_);
static void contacts_link_contacts_list_ready (GObject* source_object,
                                        GAsyncResult* _res_,
                                        gpointer _user_data_);

static inline gpointer
contacts_link_operation_get_instance_private (ContactsLinkOperation* self)
{
	return G_STRUCT_MEMBER_P (self, ContactsLinkOperation_private_offset);
}

ContactsLinkOperation*
contacts_link_operation_construct (GType object_type)
{
	ContactsLinkOperation * self = NULL;
	GeeArrayList* _tmp0_;
#line 35 "../src/contacts-linking.vala"
	self = (ContactsLinkOperation*) g_object_new (object_type, NULL);
#line 36 "../src/contacts-linking.vala"
	_tmp0_ = gee_array_list_new (CONTACTS_LINK_OPERATION_TYPE_CHANGE, (GBoxedCopyFunc) contacts_link_operation_change_ref, (GDestroyNotify) contacts_link_operation_change_unref, NULL, NULL, NULL);
#line 36 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->changes);
#line 36 "../src/contacts-linking.vala"
	self->priv->changes = _tmp0_;
#line 35 "../src/contacts-linking.vala"
	return self;
#line 1456 "contacts-linking.c"
}

ContactsLinkOperation*
contacts_link_operation_new (void)
{
#line 35 "../src/contacts-linking.vala"
	return contacts_link_operation_construct (CONTACTS_TYPE_LINK_OPERATION);
#line 1464 "contacts-linking.c"
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 40 "../src/contacts-linking.vala"
	return self ? g_object_ref (self) : NULL;
#line 1472 "contacts-linking.c"
}

void
contacts_link_operation_set_main_contact (ContactsLinkOperation* self,
                                          FolksIndividual* individual)
{
	FolksIndividual* _tmp0_;
#line 39 "../src/contacts-linking.vala"
	g_return_if_fail (self != NULL);
#line 40 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (individual);
#line 40 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->main_contact);
#line 40 "../src/contacts-linking.vala"
	self->priv->main_contact = _tmp0_;
#line 1488 "contacts-linking.c"
}

void
contacts_link_operation_set_split_out_contact (ContactsLinkOperation* self,
                                               FolksIndividual* individual)
{
#line 43 "../src/contacts-linking.vala"
	g_return_if_fail (self != NULL);
#line 44 "../src/contacts-linking.vala"
	if (individual != NULL) {
#line 1499 "contacts-linking.c"
		GeeArrayList* _tmp0_;
		GeeArrayList* _tmp1_;
		GeeSet* _tmp2_;
		GeeSet* _tmp3_;
#line 45 "../src/contacts-linking.vala"
		_tmp0_ = gee_array_list_new (FOLKS_TYPE_PERSONA, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL);
#line 45 "../src/contacts-linking.vala"
		_g_object_unref0 (self->priv->split_out_personas);
#line 45 "../src/contacts-linking.vala"
		self->priv->split_out_personas = _tmp0_;
#line 46 "../src/contacts-linking.vala"
		_tmp1_ = self->priv->split_out_personas;
#line 46 "../src/contacts-linking.vala"
		_tmp2_ = folks_individual_get_personas (individual);
#line 46 "../src/contacts-linking.vala"
		_tmp3_ = _tmp2_;
#line 46 "../src/contacts-linking.vala"
		gee_array_list_add_all (_tmp1_, (GeeCollection*) _tmp3_);
#line 1518 "contacts-linking.c"
	}
}

void
contacts_link_operation_added_persona (ContactsLinkOperation* self,
                                       FolksPersona* persona)
{
	FolksPersona* _tmp0_;
#line 50 "../src/contacts-linking.vala"
	g_return_if_fail (self != NULL);
#line 50 "../src/contacts-linking.vala"
	g_return_if_fail (persona != NULL);
#line 51 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (persona);
#line 51 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->_added_persona);
#line 51 "../src/contacts-linking.vala"
	self->priv->_added_persona = _tmp0_;
#line 1537 "contacts-linking.c"
}

void
contacts_link_operation_add_change (ContactsLinkOperation* self,
                                    ContactsPersonaAttribute* attribute,
                                    FolksPersona* persona,
                                    GObject* old_value)
{
	ContactsLinkOperationChange* c = NULL;
	ContactsLinkOperationChange* _tmp0_;
	ContactsPersonaAttribute* _tmp1_;
	FolksPersona* _tmp2_;
	GObject* _tmp3_;
	GeeArrayList* _tmp4_;
#line 54 "../src/contacts-linking.vala"
	g_return_if_fail (self != NULL);
#line 54 "../src/contacts-linking.vala"
	g_return_if_fail (attribute != NULL);
#line 54 "../src/contacts-linking.vala"
	g_return_if_fail (persona != NULL);
#line 54 "../src/contacts-linking.vala"
	g_return_if_fail (old_value != NULL);
#line 55 "../src/contacts-linking.vala"
	_tmp0_ = contacts_link_operation_change_new ();
#line 55 "../src/contacts-linking.vala"
	c = _tmp0_;
#line 56 "../src/contacts-linking.vala"
	_tmp1_ = _g_object_ref0 (attribute);
#line 56 "../src/contacts-linking.vala"
	_g_object_unref0 (c->attribute);
#line 56 "../src/contacts-linking.vala"
	c->attribute = _tmp1_;
#line 57 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (persona);
#line 57 "../src/contacts-linking.vala"
	_g_object_unref0 (c->persona);
#line 57 "../src/contacts-linking.vala"
	c->persona = _tmp2_;
#line 58 "../src/contacts-linking.vala"
	_tmp3_ = _g_object_ref0 (old_value);
#line 58 "../src/contacts-linking.vala"
	_g_object_unref0 (c->old_value);
#line 58 "../src/contacts-linking.vala"
	c->old_value = _tmp3_;
#line 59 "../src/contacts-linking.vala"
	_tmp4_ = self->priv->changes;
#line 59 "../src/contacts-linking.vala"
	gee_abstract_collection_add ((GeeAbstractCollection*) _tmp4_, c);
#line 54 "../src/contacts-linking.vala"
	_contacts_link_operation_change_unref0 (c);
#line 1588 "contacts-linking.c"
}

static void
contacts_link_operation_undo_data_free (gpointer _data)
{
	ContactsLinkOperationUndoData* _data_;
	_data_ = _data;
#line 24 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 24 "../src/contacts-linking.vala"
	g_slice_free (ContactsLinkOperationUndoData, _data_);
#line 1600 "contacts-linking.c"
}

void
contacts_link_operation_undo (ContactsLinkOperation* self,
                              GAsyncReadyCallback _callback_,
                              gpointer _user_data_)
{
	ContactsLinkOperationUndoData* _data_;
	ContactsLinkOperation* _tmp0_;
#line 24 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsLinkOperationUndoData);
#line 24 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 24 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_link_operation_undo_data_free);
#line 24 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 24 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 24 "../src/contacts-linking.vala"
	contacts_link_operation_undo_co (_data_);
#line 1622 "contacts-linking.c"
}

void
contacts_link_operation_undo_finish (ContactsLinkOperation* self,
                                     GAsyncResult* _res_)
{
	ContactsLinkOperationUndoData* _data_;
#line 24 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 1632 "contacts-linking.c"
}

static void
contacts_link_operation_undo_ready (GObject* source_object,
                                    GAsyncResult* _res_,
                                    gpointer _user_data_)
{
	ContactsLinkOperationUndoData* _data_;
#line 72 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 72 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 72 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 72 "../src/contacts-linking.vala"
	contacts_link_operation_undo_co (_data_);
#line 1649 "contacts-linking.c"
}

static gboolean
contacts_link_operation_undo_co (ContactsLinkOperationUndoData* _data_)
{
#line 62 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 62 "../src/contacts-linking.vala"
		case 0:
#line 1659 "contacts-linking.c"
		goto _state_0;
#line 62 "../src/contacts-linking.vala"
		case 1:
#line 1663 "contacts-linking.c"
		goto _state_1;
#line 62 "../src/contacts-linking.vala"
		case 2:
#line 1667 "contacts-linking.c"
		goto _state_2;
		default:
#line 62 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 1672 "contacts-linking.c"
	}
	_state_0:
#line 63 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _data_->self->priv->main_contact;
#line 63 "../src/contacts-linking.vala"
	if (_data_->_tmp0_ != NULL) {
#line 64 "../src/contacts-linking.vala"
		_data_->_tmp1_ = _data_->self->priv->main_contact;
#line 64 "../src/contacts-linking.vala"
		g_object_set_data_full ((GObject*) _data_->_tmp1_, "contacts-master-at-join", (gpointer) ((gintptr) TRUE), NULL);
#line 1683 "contacts-linking.c"
	}
#line 65 "../src/contacts-linking.vala"
	_data_->_tmp2_ = _data_->self->priv->split_out_personas;
#line 65 "../src/contacts-linking.vala"
	if (_data_->_tmp2_ != NULL) {
#line 1689 "contacts-linking.c"
		{
#line 66 "../src/contacts-linking.vala"
			_data_->_tmp3_ = _data_->self->priv->split_out_personas;
#line 66 "../src/contacts-linking.vala"
			_data_->_tmp4_ = _g_object_ref0 (_data_->_tmp3_);
#line 66 "../src/contacts-linking.vala"
			_data_->_p_list = _data_->_tmp4_;
#line 66 "../src/contacts-linking.vala"
			_data_->_tmp5_ = _data_->_p_list;
#line 66 "../src/contacts-linking.vala"
			_data_->_tmp6_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _data_->_tmp5_);
#line 66 "../src/contacts-linking.vala"
			_data_->_tmp7_ = _data_->_tmp6_;
#line 66 "../src/contacts-linking.vala"
			_data_->_p_size = _data_->_tmp7_;
#line 66 "../src/contacts-linking.vala"
			_data_->_p_index = -1;
#line 66 "../src/contacts-linking.vala"
			while (TRUE) {
#line 66 "../src/contacts-linking.vala"
				_data_->_p_index = _data_->_p_index + 1;
#line 66 "../src/contacts-linking.vala"
				if (!(_data_->_p_index < _data_->_p_size)) {
#line 66 "../src/contacts-linking.vala"
					break;
#line 1715 "contacts-linking.c"
				}
#line 66 "../src/contacts-linking.vala"
				_data_->_tmp8_ = _data_->_p_list;
#line 66 "../src/contacts-linking.vala"
				_data_->_tmp9_ = gee_abstract_list_get ((GeeAbstractList*) _data_->_tmp8_, _data_->_p_index);
#line 66 "../src/contacts-linking.vala"
				_data_->p = (FolksPersona*) _data_->_tmp9_;
#line 67 "../src/contacts-linking.vala"
				_data_->_tmp10_ = _data_->p;
#line 67 "../src/contacts-linking.vala"
				g_object_set_data_full ((GObject*) _data_->_tmp10_, "contacts-new-contact", (gpointer) ((gintptr) TRUE), NULL);
#line 66 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->p);
#line 1729 "contacts-linking.c"
			}
#line 66 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_p_list);
#line 1733 "contacts-linking.c"
		}
	}
	{
#line 71 "../src/contacts-linking.vala"
		_data_->_tmp11_ = _data_->self->priv->_added_persona;
#line 71 "../src/contacts-linking.vala"
		if (_data_->_tmp11_ != NULL) {
#line 72 "../src/contacts-linking.vala"
			_data_->_tmp12_ = _data_->self->priv->_added_persona;
#line 72 "../src/contacts-linking.vala"
			_data_->_tmp13_ = folks_persona_get_store (_data_->_tmp12_);
#line 72 "../src/contacts-linking.vala"
			_data_->_tmp14_ = _data_->_tmp13_;
#line 72 "../src/contacts-linking.vala"
			_data_->_tmp15_ = _data_->self->priv->_added_persona;
#line 72 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 72 "../src/contacts-linking.vala"
			folks_persona_store_remove_persona (_data_->_tmp14_, _data_->_tmp15_, contacts_link_operation_undo_ready, _data_);
#line 72 "../src/contacts-linking.vala"
			return FALSE;
#line 1755 "contacts-linking.c"
			_state_1:
#line 72 "../src/contacts-linking.vala"
			folks_persona_store_remove_persona_finish (_data_->_tmp14_, _data_->_res_, &_data_->_inner_error0_);
#line 72 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 1761 "contacts-linking.c"
				goto __catch14_g_error;
			}
		}
		{
#line 74 "../src/contacts-linking.vala"
			_data_->_tmp16_ = _data_->self->priv->changes;
#line 74 "../src/contacts-linking.vala"
			_data_->_tmp17_ = _g_object_ref0 (_data_->_tmp16_);
#line 74 "../src/contacts-linking.vala"
			_data_->_c_list = _data_->_tmp17_;
#line 74 "../src/contacts-linking.vala"
			_data_->_tmp18_ = _data_->_c_list;
#line 74 "../src/contacts-linking.vala"
			_data_->_tmp19_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _data_->_tmp18_);
#line 74 "../src/contacts-linking.vala"
			_data_->_tmp20_ = _data_->_tmp19_;
#line 74 "../src/contacts-linking.vala"
			_data_->_c_size = _data_->_tmp20_;
#line 74 "../src/contacts-linking.vala"
			_data_->_c_index = -1;
#line 74 "../src/contacts-linking.vala"
			while (TRUE) {
#line 74 "../src/contacts-linking.vala"
				_data_->_c_index = _data_->_c_index + 1;
#line 74 "../src/contacts-linking.vala"
				if (!(_data_->_c_index < _data_->_c_size)) {
#line 74 "../src/contacts-linking.vala"
					break;
#line 1790 "contacts-linking.c"
				}
#line 74 "../src/contacts-linking.vala"
				_data_->_tmp21_ = _data_->_c_list;
#line 74 "../src/contacts-linking.vala"
				_data_->_tmp22_ = gee_abstract_list_get ((GeeAbstractList*) _data_->_tmp21_, _data_->_c_index);
#line 74 "../src/contacts-linking.vala"
				_data_->c = (ContactsLinkOperationChange*) _data_->_tmp22_;
#line 75 "../src/contacts-linking.vala"
				_data_->_tmp23_ = _data_->c;
#line 75 "../src/contacts-linking.vala"
				_data_->_tmp24_ = _data_->_tmp23_->persona;
#line 75 "../src/contacts-linking.vala"
				_data_->_tmp25_ = _data_->self->priv->_added_persona;
#line 75 "../src/contacts-linking.vala"
				if (_data_->_tmp24_ != _data_->_tmp25_) {
#line 76 "../src/contacts-linking.vala"
					_data_->_tmp26_ = _data_->c;
#line 76 "../src/contacts-linking.vala"
					_data_->_tmp27_ = _data_->_tmp26_->attribute;
#line 76 "../src/contacts-linking.vala"
					_data_->_tmp28_ = _data_->c;
#line 76 "../src/contacts-linking.vala"
					_data_->_tmp29_ = _data_->_tmp28_->persona;
#line 76 "../src/contacts-linking.vala"
					_data_->_tmp30_ = _data_->c;
#line 76 "../src/contacts-linking.vala"
					_data_->_tmp31_ = _data_->_tmp30_->old_value;
#line 76 "../src/contacts-linking.vala"
					_data_->_state_ = 2;
#line 76 "../src/contacts-linking.vala"
					contacts_persona_attribute_set_value (_data_->_tmp27_, _data_->_tmp29_, _data_->_tmp31_, contacts_link_operation_undo_ready, _data_);
#line 76 "../src/contacts-linking.vala"
					return FALSE;
#line 1824 "contacts-linking.c"
					_state_2:
#line 76 "../src/contacts-linking.vala"
					contacts_persona_attribute_set_value_finish (_data_->_tmp27_, _data_->_res_);
#line 1828 "contacts-linking.c"
				}
#line 74 "../src/contacts-linking.vala"
				_contacts_link_operation_change_unref0 (_data_->c);
#line 1832 "contacts-linking.c"
			}
#line 74 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_c_list);
#line 1836 "contacts-linking.c"
		}
	}
	goto __finally14;
	__catch14_g_error:
	{
#line 70 "../src/contacts-linking.vala"
		_data_->e = _data_->_inner_error0_;
#line 70 "../src/contacts-linking.vala"
		_data_->_inner_error0_ = NULL;
#line 80 "../src/contacts-linking.vala"
		_data_->_tmp32_ = _data_->e;
#line 80 "../src/contacts-linking.vala"
		_data_->_tmp33_ = _data_->_tmp32_->message;
#line 80 "../src/contacts-linking.vala"
		g_warning ("contacts-linking.vala:80: Error when undoing linking: %s\n", _data_->_tmp33_);
#line 70 "../src/contacts-linking.vala"
		_g_error_free0 (_data_->e);
#line 1854 "contacts-linking.c"
	}
	__finally14:
#line 70 "../src/contacts-linking.vala"
	if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 70 "../src/contacts-linking.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 70 "../src/contacts-linking.vala"
		g_clear_error (&_data_->_inner_error0_);
#line 70 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 70 "../src/contacts-linking.vala"
		return FALSE;
#line 1867 "contacts-linking.c"
	}
#line 83 "../src/contacts-linking.vala"
	_data_->_tmp34_ = _data_->self->priv->main_contact;
#line 83 "../src/contacts-linking.vala"
	if (_data_->_tmp34_ != NULL) {
#line 84 "../src/contacts-linking.vala"
		_data_->_tmp35_ = _data_->self->priv->main_contact;
#line 84 "../src/contacts-linking.vala"
		g_object_set_data_full ((GObject*) _data_->_tmp35_, "contacts-master-at-join", (gpointer) ((gintptr) FALSE), NULL);
#line 1877 "contacts-linking.c"
	}
#line 86 "../src/contacts-linking.vala"
	_data_->_tmp36_ = _data_->self->priv->split_out_personas;
#line 86 "../src/contacts-linking.vala"
	if (_data_->_tmp36_ != NULL) {
#line 1883 "contacts-linking.c"
		{
#line 87 "../src/contacts-linking.vala"
			_data_->_tmp37_ = _data_->self->priv->split_out_personas;
#line 87 "../src/contacts-linking.vala"
			_data_->_tmp38_ = _g_object_ref0 (_data_->_tmp37_);
#line 87 "../src/contacts-linking.vala"
			_data_->_vala1__p_list = _data_->_tmp38_;
#line 87 "../src/contacts-linking.vala"
			_data_->_tmp39_ = _data_->_vala1__p_list;
#line 87 "../src/contacts-linking.vala"
			_data_->_tmp40_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _data_->_tmp39_);
#line 87 "../src/contacts-linking.vala"
			_data_->_tmp41_ = _data_->_tmp40_;
#line 87 "../src/contacts-linking.vala"
			_data_->_vala1__p_size = _data_->_tmp41_;
#line 87 "../src/contacts-linking.vala"
			_data_->_vala1__p_index = -1;
#line 87 "../src/contacts-linking.vala"
			while (TRUE) {
#line 87 "../src/contacts-linking.vala"
				_data_->_vala1__p_index = _data_->_vala1__p_index + 1;
#line 87 "../src/contacts-linking.vala"
				if (!(_data_->_vala1__p_index < _data_->_vala1__p_size)) {
#line 87 "../src/contacts-linking.vala"
					break;
#line 1909 "contacts-linking.c"
				}
#line 87 "../src/contacts-linking.vala"
				_data_->_tmp42_ = _data_->_vala1__p_list;
#line 87 "../src/contacts-linking.vala"
				_data_->_tmp43_ = gee_abstract_list_get ((GeeAbstractList*) _data_->_tmp42_, _data_->_vala1__p_index);
#line 87 "../src/contacts-linking.vala"
				_data_->_vala1_p = (FolksPersona*) _data_->_tmp43_;
#line 88 "../src/contacts-linking.vala"
				_data_->_tmp44_ = _data_->_vala1_p;
#line 88 "../src/contacts-linking.vala"
				g_object_set_data_full ((GObject*) _data_->_tmp44_, "contacts-new-contact", (gpointer) ((gintptr) FALSE), NULL);
#line 87 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_vala1_p);
#line 1923 "contacts-linking.c"
			}
#line 87 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_vala1__p_list);
#line 1927 "contacts-linking.c"
		}
	}
#line 62 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 62 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 62 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 62 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 1938 "contacts-linking.c"
		}
	}
#line 62 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 62 "../src/contacts-linking.vala"
	return FALSE;
#line 1945 "contacts-linking.c"
}

ContactsLinkOperationChange*
contacts_link_operation_change_construct (GType object_type)
{
	ContactsLinkOperationChange* self = NULL;
#line 25 "../src/contacts-linking.vala"
	self = (ContactsLinkOperationChange*) g_type_create_instance (object_type);
#line 25 "../src/contacts-linking.vala"
	return self;
#line 1956 "contacts-linking.c"
}

ContactsLinkOperationChange*
contacts_link_operation_change_new (void)
{
#line 25 "../src/contacts-linking.vala"
	return contacts_link_operation_change_construct (CONTACTS_LINK_OPERATION_TYPE_CHANGE);
#line 1964 "contacts-linking.c"
}

static void
contacts_link_operation_value_change_init (GValue* value)
{
#line 25 "../src/contacts-linking.vala"
	value->data[0].v_pointer = NULL;
#line 1972 "contacts-linking.c"
}

static void
contacts_link_operation_value_change_free_value (GValue* value)
{
#line 25 "../src/contacts-linking.vala"
	if (value->data[0].v_pointer) {
#line 25 "../src/contacts-linking.vala"
		contacts_link_operation_change_unref (value->data[0].v_pointer);
#line 1982 "contacts-linking.c"
	}
}

static void
contacts_link_operation_value_change_copy_value (const GValue* src_value,
                                                 GValue* dest_value)
{
#line 25 "../src/contacts-linking.vala"
	if (src_value->data[0].v_pointer) {
#line 25 "../src/contacts-linking.vala"
		dest_value->data[0].v_pointer = contacts_link_operation_change_ref (src_value->data[0].v_pointer);
#line 1994 "contacts-linking.c"
	} else {
#line 25 "../src/contacts-linking.vala"
		dest_value->data[0].v_pointer = NULL;
#line 1998 "contacts-linking.c"
	}
}

static gpointer
contacts_link_operation_value_change_peek_pointer (const GValue* value)
{
#line 25 "../src/contacts-linking.vala"
	return value->data[0].v_pointer;
#line 2007 "contacts-linking.c"
}

static gchar*
contacts_link_operation_value_change_collect_value (GValue* value,
                                                    guint n_collect_values,
                                                    GTypeCValue* collect_values,
                                                    guint collect_flags)
{
#line 25 "../src/contacts-linking.vala"
	if (collect_values[0].v_pointer) {
#line 2018 "contacts-linking.c"
		ContactsLinkOperationChange * object;
		object = collect_values[0].v_pointer;
#line 25 "../src/contacts-linking.vala"
		if (object->parent_instance.g_class == NULL) {
#line 25 "../src/contacts-linking.vala"
			return g_strconcat ("invalid unclassed object pointer for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 2025 "contacts-linking.c"
		} else if (!g_value_type_compatible (G_TYPE_FROM_INSTANCE (object), G_VALUE_TYPE (value))) {
#line 25 "../src/contacts-linking.vala"
			return g_strconcat ("invalid object type `", g_type_name (G_TYPE_FROM_INSTANCE (object)), "' for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 2029 "contacts-linking.c"
		}
#line 25 "../src/contacts-linking.vala"
		value->data[0].v_pointer = contacts_link_operation_change_ref (object);
#line 2033 "contacts-linking.c"
	} else {
#line 25 "../src/contacts-linking.vala"
		value->data[0].v_pointer = NULL;
#line 2037 "contacts-linking.c"
	}
#line 25 "../src/contacts-linking.vala"
	return NULL;
#line 2041 "contacts-linking.c"
}

static gchar*
contacts_link_operation_value_change_lcopy_value (const GValue* value,
                                                  guint n_collect_values,
                                                  GTypeCValue* collect_values,
                                                  guint collect_flags)
{
	ContactsLinkOperationChange ** object_p;
	object_p = collect_values[0].v_pointer;
#line 25 "../src/contacts-linking.vala"
	if (!object_p) {
#line 25 "../src/contacts-linking.vala"
		return g_strdup_printf ("value location for `%s' passed as NULL", G_VALUE_TYPE_NAME (value));
#line 2056 "contacts-linking.c"
	}
#line 25 "../src/contacts-linking.vala"
	if (!value->data[0].v_pointer) {
#line 25 "../src/contacts-linking.vala"
		*object_p = NULL;
#line 2062 "contacts-linking.c"
	} else if (collect_flags & G_VALUE_NOCOPY_CONTENTS) {
#line 25 "../src/contacts-linking.vala"
		*object_p = value->data[0].v_pointer;
#line 2066 "contacts-linking.c"
	} else {
#line 25 "../src/contacts-linking.vala"
		*object_p = contacts_link_operation_change_ref (value->data[0].v_pointer);
#line 2070 "contacts-linking.c"
	}
#line 25 "../src/contacts-linking.vala"
	return NULL;
#line 2074 "contacts-linking.c"
}

GParamSpec*
contacts_link_operation_param_spec_change (const gchar* name,
                                           const gchar* nick,
                                           const gchar* blurb,
                                           GType object_type,
                                           GParamFlags flags)
{
	ContactsLinkOperationParamSpecChange* spec;
#line 25 "../src/contacts-linking.vala"
	g_return_val_if_fail (g_type_is_a (object_type, CONTACTS_LINK_OPERATION_TYPE_CHANGE), NULL);
#line 25 "../src/contacts-linking.vala"
	spec = g_param_spec_internal (G_TYPE_PARAM_OBJECT, name, nick, blurb, flags);
#line 25 "../src/contacts-linking.vala"
	G_PARAM_SPEC (spec)->value_type = object_type;
#line 25 "../src/contacts-linking.vala"
	return G_PARAM_SPEC (spec);
#line 2093 "contacts-linking.c"
}

gpointer
contacts_link_operation_value_get_change (const GValue* value)
{
#line 25 "../src/contacts-linking.vala"
	g_return_val_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, CONTACTS_LINK_OPERATION_TYPE_CHANGE), NULL);
#line 25 "../src/contacts-linking.vala"
	return value->data[0].v_pointer;
#line 2103 "contacts-linking.c"
}

void
contacts_link_operation_value_set_change (GValue* value,
                                          gpointer v_object)
{
	ContactsLinkOperationChange * old;
#line 25 "../src/contacts-linking.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, CONTACTS_LINK_OPERATION_TYPE_CHANGE));
#line 25 "../src/contacts-linking.vala"
	old = value->data[0].v_pointer;
#line 25 "../src/contacts-linking.vala"
	if (v_object) {
#line 25 "../src/contacts-linking.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, CONTACTS_LINK_OPERATION_TYPE_CHANGE));
#line 25 "../src/contacts-linking.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 25 "../src/contacts-linking.vala"
		value->data[0].v_pointer = v_object;
#line 25 "../src/contacts-linking.vala"
		contacts_link_operation_change_ref (value->data[0].v_pointer);
#line 2125 "contacts-linking.c"
	} else {
#line 25 "../src/contacts-linking.vala"
		value->data[0].v_pointer = NULL;
#line 2129 "contacts-linking.c"
	}
#line 25 "../src/contacts-linking.vala"
	if (old) {
#line 25 "../src/contacts-linking.vala"
		contacts_link_operation_change_unref (old);
#line 2135 "contacts-linking.c"
	}
}

void
contacts_link_operation_value_take_change (GValue* value,
                                           gpointer v_object)
{
	ContactsLinkOperationChange * old;
#line 25 "../src/contacts-linking.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, CONTACTS_LINK_OPERATION_TYPE_CHANGE));
#line 25 "../src/contacts-linking.vala"
	old = value->data[0].v_pointer;
#line 25 "../src/contacts-linking.vala"
	if (v_object) {
#line 25 "../src/contacts-linking.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, CONTACTS_LINK_OPERATION_TYPE_CHANGE));
#line 25 "../src/contacts-linking.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 25 "../src/contacts-linking.vala"
		value->data[0].v_pointer = v_object;
#line 2156 "contacts-linking.c"
	} else {
#line 25 "../src/contacts-linking.vala"
		value->data[0].v_pointer = NULL;
#line 2160 "contacts-linking.c"
	}
#line 25 "../src/contacts-linking.vala"
	if (old) {
#line 25 "../src/contacts-linking.vala"
		contacts_link_operation_change_unref (old);
#line 2166 "contacts-linking.c"
	}
}

static void
contacts_link_operation_change_class_init (ContactsLinkOperationChangeClass * klass,
                                           gpointer klass_data)
{
#line 25 "../src/contacts-linking.vala"
	contacts_link_operation_change_parent_class = g_type_class_peek_parent (klass);
#line 25 "../src/contacts-linking.vala"
	((ContactsLinkOperationChangeClass *) klass)->finalize = contacts_link_operation_change_finalize;
#line 2178 "contacts-linking.c"
}

static void
contacts_link_operation_change_instance_init (ContactsLinkOperationChange * self,
                                              gpointer klass)
{
#line 25 "../src/contacts-linking.vala"
	self->ref_count = 1;
#line 2187 "contacts-linking.c"
}

static void
contacts_link_operation_change_finalize (ContactsLinkOperationChange * obj)
{
	ContactsLinkOperationChange * self;
#line 25 "../src/contacts-linking.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_LINK_OPERATION_TYPE_CHANGE, ContactsLinkOperationChange);
#line 25 "../src/contacts-linking.vala"
	g_signal_handlers_destroy (self);
#line 26 "../src/contacts-linking.vala"
	_g_object_unref0 (self->attribute);
#line 27 "../src/contacts-linking.vala"
	_g_object_unref0 (self->persona);
#line 28 "../src/contacts-linking.vala"
	_g_object_unref0 (self->old_value);
#line 2204 "contacts-linking.c"
}

static GType
contacts_link_operation_change_get_type_once (void)
{
	static const GTypeValueTable g_define_type_value_table = { contacts_link_operation_value_change_init, contacts_link_operation_value_change_free_value, contacts_link_operation_value_change_copy_value, contacts_link_operation_value_change_peek_pointer, "p", contacts_link_operation_value_change_collect_value, "p", contacts_link_operation_value_change_lcopy_value };
	static const GTypeInfo g_define_type_info = { sizeof (ContactsLinkOperationChangeClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_link_operation_change_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsLinkOperationChange), 0, (GInstanceInitFunc) contacts_link_operation_change_instance_init, &g_define_type_value_table };
	static const GTypeFundamentalInfo g_define_type_fundamental_info = { (G_TYPE_FLAG_CLASSED | G_TYPE_FLAG_INSTANTIATABLE | G_TYPE_FLAG_DERIVABLE | G_TYPE_FLAG_DEEP_DERIVABLE) };
	GType contacts_link_operation_change_type_id;
	contacts_link_operation_change_type_id = g_type_register_fundamental (g_type_fundamental_next (), "ContactsLinkOperationChange", &g_define_type_info, &g_define_type_fundamental_info, 0);
	return contacts_link_operation_change_type_id;
}

GType
contacts_link_operation_change_get_type (void)
{
	static volatile gsize contacts_link_operation_change_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_link_operation_change_type_id__volatile)) {
		GType contacts_link_operation_change_type_id;
		contacts_link_operation_change_type_id = contacts_link_operation_change_get_type_once ();
		g_once_init_leave (&contacts_link_operation_change_type_id__volatile, contacts_link_operation_change_type_id);
	}
	return contacts_link_operation_change_type_id__volatile;
}

gpointer
contacts_link_operation_change_ref (gpointer instance)
{
	ContactsLinkOperationChange * self;
	self = instance;
#line 25 "../src/contacts-linking.vala"
	g_atomic_int_inc (&self->ref_count);
#line 25 "../src/contacts-linking.vala"
	return instance;
#line 2239 "contacts-linking.c"
}

void
contacts_link_operation_change_unref (gpointer instance)
{
	ContactsLinkOperationChange * self;
	self = instance;
#line 25 "../src/contacts-linking.vala"
	if (g_atomic_int_dec_and_test (&self->ref_count)) {
#line 25 "../src/contacts-linking.vala"
		CONTACTS_LINK_OPERATION_CHANGE_GET_CLASS (self)->finalize (self);
#line 25 "../src/contacts-linking.vala"
		g_type_free_instance ((GTypeInstance *) self);
#line 2253 "contacts-linking.c"
	}
}

static void
contacts_link_operation_class_init (ContactsLinkOperationClass * klass,
                                    gpointer klass_data)
{
#line 24 "../src/contacts-linking.vala"
	contacts_link_operation_parent_class = g_type_class_peek_parent (klass);
#line 24 "../src/contacts-linking.vala"
	g_type_class_adjust_private_offset (klass, &ContactsLinkOperation_private_offset);
#line 24 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_link_operation_finalize;
#line 2267 "contacts-linking.c"
}

static void
contacts_link_operation_instance_init (ContactsLinkOperation * self,
                                       gpointer klass)
{
#line 24 "../src/contacts-linking.vala"
	self->priv = contacts_link_operation_get_instance_private (self);
#line 2276 "contacts-linking.c"
}

static void
contacts_link_operation_finalize (GObject * obj)
{
	ContactsLinkOperation * self;
#line 24 "../src/contacts-linking.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_LINK_OPERATION, ContactsLinkOperation);
#line 30 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->_added_persona);
#line 31 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->main_contact);
#line 32 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->split_out_personas);
#line 33 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->changes);
#line 24 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (contacts_link_operation_parent_class)->finalize (obj);
#line 2295 "contacts-linking.c"
}

static GType
contacts_link_operation_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsLinkOperationClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_link_operation_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsLinkOperation), 0, (GInstanceInitFunc) contacts_link_operation_instance_init, NULL };
	GType contacts_link_operation_type_id;
	contacts_link_operation_type_id = g_type_register_static (G_TYPE_OBJECT, "ContactsLinkOperation", &g_define_type_info, 0);
	ContactsLinkOperation_private_offset = g_type_add_instance_private (contacts_link_operation_type_id, sizeof (ContactsLinkOperationPrivate));
	return contacts_link_operation_type_id;
}

GType
contacts_link_operation_get_type (void)
{
	static volatile gsize contacts_link_operation_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_link_operation_type_id__volatile)) {
		GType contacts_link_operation_type_id;
		contacts_link_operation_type_id = contacts_link_operation_get_type_once ();
		g_once_init_leave (&contacts_link_operation_type_id__volatile, contacts_link_operation_type_id);
	}
	return contacts_link_operation_type_id__volatile;
}

GeeHashSet*
contacts_persona_attribute_create_set (void)
{
	GeeHashSet* _tmp0_;
	GeeHashSet* result = NULL;
#line 97 "../src/contacts-linking.vala"
	_tmp0_ = gee_hash_set_new (CONTACTS_TYPE_PERSONA_ATTRIBUTE, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, (GeeHashDataFunc) contacts_persona_attribute_hash, NULL, NULL, (GeeEqualDataFunc) contacts_persona_attribute_equal, NULL, NULL);
#line 97 "../src/contacts-linking.vala"
	result = _tmp0_;
#line 97 "../src/contacts-linking.vala"
	return result;
#line 2331 "contacts-linking.c"
}

static gboolean
_vala_string_array_contains (gchar* * stack,
                             gint stack_length,
                             const gchar* needle)
{
	gint i;
#line 102 "../src/contacts-linking.vala"
	for (i = 0; i < stack_length; i++) {
#line 102 "../src/contacts-linking.vala"
		if (g_strcmp0 (stack[i], needle) == 0) {
#line 102 "../src/contacts-linking.vala"
			return TRUE;
#line 2346 "contacts-linking.c"
		}
	}
#line 102 "../src/contacts-linking.vala"
	return FALSE;
#line 2351 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_real_is_removable (ContactsPersonaAttribute* self,
                                              FolksPersona* from_persona)
{
	const gchar* _tmp0_;
	gchar** _tmp1_;
	gint _tmp1__length1;
	gchar** _tmp2_;
	gint _tmp2__length1;
	gboolean result = FALSE;
#line 101 "../src/contacts-linking.vala"
	g_return_val_if_fail (from_persona != NULL, FALSE);
#line 102 "../src/contacts-linking.vala"
	_tmp0_ = self->property_name;
#line 102 "../src/contacts-linking.vala"
	_tmp1_ = folks_persona_get_writeable_properties (from_persona, &_tmp1__length1);
#line 102 "../src/contacts-linking.vala"
	_tmp2_ = _tmp1_;
#line 102 "../src/contacts-linking.vala"
	_tmp2__length1 = _tmp1__length1;
#line 102 "../src/contacts-linking.vala"
	result = _vala_string_array_contains (_tmp2_, _tmp2__length1, _tmp0_);
#line 102 "../src/contacts-linking.vala"
	return result;
#line 2378 "contacts-linking.c"
}

gboolean
contacts_persona_attribute_is_removable (ContactsPersonaAttribute* self,
                                         FolksPersona* from_persona)
{
#line 101 "../src/contacts-linking.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 101 "../src/contacts-linking.vala"
	return CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->is_removable (self, from_persona);
#line 2389 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_real_is_referenced_by_persona (ContactsPersonaAttribute* self,
                                                          FolksPersona* persona)
{
	gboolean _tmp0_ = FALSE;
#line 105 "../src/contacts-linking.vala"
	g_critical ("Type `%s' does not implement abstract method `contacts_persona_attribute_is_referenced_by_persona'", g_type_name (G_TYPE_FROM_INSTANCE (self)));
#line 105 "../src/contacts-linking.vala"
	return _tmp0_;
#line 2401 "contacts-linking.c"
}

gboolean
contacts_persona_attribute_is_referenced_by_persona (ContactsPersonaAttribute* self,
                                                     FolksPersona* persona)
{
#line 105 "../src/contacts-linking.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 105 "../src/contacts-linking.vala"
	return CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->is_referenced_by_persona (self, persona);
#line 2412 "contacts-linking.c"
}

static gchar*
contacts_persona_attribute_real_to_string (ContactsPersonaAttribute* self)
{
#line 107 "../src/contacts-linking.vala"
	g_critical ("Type `%s' does not implement abstract method `contacts_persona_attribute_to_string'", g_type_name (G_TYPE_FROM_INSTANCE (self)));
#line 107 "../src/contacts-linking.vala"
	return NULL;
#line 2422 "contacts-linking.c"
}

gchar*
contacts_persona_attribute_to_string (ContactsPersonaAttribute* self)
{
#line 107 "../src/contacts-linking.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 107 "../src/contacts-linking.vala"
	return CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->to_string (self);
#line 2432 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_real_equal (ContactsPersonaAttribute* self,
                                       ContactsPersonaAttribute* that)
{
	const gchar* _tmp0_;
	const gchar* _tmp1_;
	gboolean result = FALSE;
#line 109 "../src/contacts-linking.vala"
	g_return_val_if_fail (that != NULL, FALSE);
#line 110 "../src/contacts-linking.vala"
	_tmp0_ = self->property_name;
#line 110 "../src/contacts-linking.vala"
	_tmp1_ = that->property_name;
#line 110 "../src/contacts-linking.vala"
	result = g_strcmp0 (_tmp0_, _tmp1_) == 0;
#line 110 "../src/contacts-linking.vala"
	return result;
#line 2452 "contacts-linking.c"
}

gboolean
contacts_persona_attribute_equal (ContactsPersonaAttribute* self,
                                  ContactsPersonaAttribute* that)
{
#line 109 "../src/contacts-linking.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 109 "../src/contacts-linking.vala"
	return CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->equal (self, that);
#line 2463 "contacts-linking.c"
}

static guint
contacts_persona_attribute_real_hash (ContactsPersonaAttribute* self)
{
	const gchar* _tmp0_;
	guint result = 0U;
#line 114 "../src/contacts-linking.vala"
	_tmp0_ = self->property_name;
#line 114 "../src/contacts-linking.vala"
	result = g_str_hash (_tmp0_);
#line 114 "../src/contacts-linking.vala"
	return result;
#line 2477 "contacts-linking.c"
}

guint
contacts_persona_attribute_hash (ContactsPersonaAttribute* self)
{
#line 113 "../src/contacts-linking.vala"
	g_return_val_if_fail (self != NULL, 0U);
#line 113 "../src/contacts-linking.vala"
	return CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->hash (self);
#line 2487 "contacts-linking.c"
}

void
contacts_persona_attribute_persona_apply_attributes (ContactsPersonaAttribute* self,
                                                     FolksPersona* persona,
                                                     GeeSet* added_attributes,
                                                     GeeSet* removed_attributes,
                                                     ContactsLinkOperation* operation,
                                                     GAsyncReadyCallback _callback_,
                                                     gpointer _user_data_)
{
#line 93 "../src/contacts-linking.vala"
	CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->persona_apply_attributes (self, persona, added_attributes, removed_attributes, operation, _callback_, _user_data_);
#line 2501 "contacts-linking.c"
}

void
contacts_persona_attribute_persona_apply_attributes_finish (ContactsPersonaAttribute* self,
                                                            GAsyncResult* _res_)
{
#line 93 "../src/contacts-linking.vala"
	CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->persona_apply_attributes_finish (self, _res_);
#line 2510 "contacts-linking.c"
}

void
contacts_persona_attribute_set_value (ContactsPersonaAttribute* self,
                                      FolksPersona* persona,
                                      GObject* value,
                                      GAsyncReadyCallback _callback_,
                                      gpointer _user_data_)
{
#line 93 "../src/contacts-linking.vala"
	CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->set_value (self, persona, value, _callback_, _user_data_);
#line 2522 "contacts-linking.c"
}

void
contacts_persona_attribute_set_value_finish (ContactsPersonaAttribute* self,
                                             GAsyncResult* _res_)
{
#line 93 "../src/contacts-linking.vala"
	CONTACTS_PERSONA_ATTRIBUTE_GET_CLASS (self)->set_value_finish (self, _res_);
#line 2531 "contacts-linking.c"
}

ContactsPersonaAttribute*
contacts_persona_attribute_construct (GType object_type)
{
	ContactsPersonaAttribute * self = NULL;
#line 93 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttribute*) g_object_new (object_type, NULL);
#line 93 "../src/contacts-linking.vala"
	return self;
#line 2542 "contacts-linking.c"
}

static void
contacts_persona_attribute_class_init (ContactsPersonaAttributeClass * klass,
                                       gpointer klass_data)
{
#line 93 "../src/contacts-linking.vala"
	contacts_persona_attribute_parent_class = g_type_class_peek_parent (klass);
#line 93 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->is_removable = (gboolean (*) (ContactsPersonaAttribute*, FolksPersona*)) contacts_persona_attribute_real_is_removable;
#line 93 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->is_referenced_by_persona = (gboolean (*) (ContactsPersonaAttribute*, FolksPersona*)) contacts_persona_attribute_real_is_referenced_by_persona;
#line 93 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->to_string = (gchar* (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_real_to_string;
#line 93 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->equal = (gboolean (*) (ContactsPersonaAttribute*, ContactsPersonaAttribute*)) contacts_persona_attribute_real_equal;
#line 93 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->hash = (guint (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_real_hash;
#line 93 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_persona_attribute_finalize;
#line 2563 "contacts-linking.c"
}

static void
contacts_persona_attribute_instance_init (ContactsPersonaAttribute * self,
                                          gpointer klass)
{
}

static void
contacts_persona_attribute_finalize (GObject * obj)
{
	ContactsPersonaAttribute * self;
#line 93 "../src/contacts-linking.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute);
#line 94 "../src/contacts-linking.vala"
	_g_free0 (self->property_name);
#line 93 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (contacts_persona_attribute_parent_class)->finalize (obj);
#line 2582 "contacts-linking.c"
}

static GType
contacts_persona_attribute_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsPersonaAttributeClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_persona_attribute_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsPersonaAttribute), 0, (GInstanceInitFunc) contacts_persona_attribute_instance_init, NULL };
	GType contacts_persona_attribute_type_id;
	contacts_persona_attribute_type_id = g_type_register_static (G_TYPE_OBJECT, "ContactsPersonaAttribute", &g_define_type_info, G_TYPE_FLAG_ABSTRACT);
	return contacts_persona_attribute_type_id;
}

GType
contacts_persona_attribute_get_type (void)
{
	static volatile gsize contacts_persona_attribute_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_persona_attribute_type_id__volatile)) {
		GType contacts_persona_attribute_type_id;
		contacts_persona_attribute_type_id = contacts_persona_attribute_get_type_once ();
		g_once_init_leave (&contacts_persona_attribute_type_id__volatile, contacts_persona_attribute_type_id);
	}
	return contacts_persona_attribute_type_id__volatile;
}

static inline gpointer
contacts_persona_attribute_local_id_get_instance_private (ContactsPersonaAttributeLocalId* self)
{
	return G_STRUCT_MEMBER_P (self, ContactsPersonaAttributeLocalId_private_offset);
}

ContactsPersonaAttributeLocalId*
contacts_persona_attribute_local_id_construct (GType object_type,
                                               const gchar* value)
{
	ContactsPersonaAttributeLocalId * self = NULL;
	gchar* _tmp0_;
	gchar* _tmp1_;
#line 127 "../src/contacts-linking.vala"
	g_return_val_if_fail (value != NULL, NULL);
#line 127 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) contacts_persona_attribute_construct (object_type);
#line 128 "../src/contacts-linking.vala"
	_tmp0_ = g_strdup ("local-ids");
#line 128 "../src/contacts-linking.vala"
	_g_free0 (((ContactsPersonaAttribute*) self)->property_name);
#line 128 "../src/contacts-linking.vala"
	((ContactsPersonaAttribute*) self)->property_name = _tmp0_;
#line 129 "../src/contacts-linking.vala"
	_tmp1_ = g_strdup (value);
#line 129 "../src/contacts-linking.vala"
	_g_free0 (self->priv->value);
#line 129 "../src/contacts-linking.vala"
	self->priv->value = _tmp1_;
#line 127 "../src/contacts-linking.vala"
	return self;
#line 2637 "contacts-linking.c"
}

ContactsPersonaAttributeLocalId*
contacts_persona_attribute_local_id_new (const gchar* value)
{
#line 127 "../src/contacts-linking.vala"
	return contacts_persona_attribute_local_id_construct (CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID, value);
#line 2645 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_local_id_real_is_removable (ContactsPersonaAttribute* base,
                                                       FolksPersona* from_persona)
{
	ContactsPersonaAttributeLocalId * self;
	gboolean _tmp0_ = FALSE;
	gboolean result = FALSE;
#line 132 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) base;
#line 132 "../src/contacts-linking.vala"
	g_return_val_if_fail (from_persona != NULL, FALSE);
#line 133 "../src/contacts-linking.vala"
	if (CONTACTS_PERSONA_ATTRIBUTE_CLASS (contacts_persona_attribute_local_id_parent_class)->is_removable (G_TYPE_CHECK_INSTANCE_CAST (self, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute), from_persona)) {
#line 2661 "contacts-linking.c"
		const gchar* _tmp1_;
		const gchar* _tmp2_;
		const gchar* _tmp3_;
#line 133 "../src/contacts-linking.vala"
		_tmp1_ = self->priv->value;
#line 133 "../src/contacts-linking.vala"
		_tmp2_ = folks_persona_get_iid (from_persona);
#line 133 "../src/contacts-linking.vala"
		_tmp3_ = _tmp2_;
#line 133 "../src/contacts-linking.vala"
		_tmp0_ = g_strcmp0 (_tmp1_, _tmp3_) != 0;
#line 2673 "contacts-linking.c"
	} else {
#line 133 "../src/contacts-linking.vala"
		_tmp0_ = FALSE;
#line 2677 "contacts-linking.c"
	}
#line 133 "../src/contacts-linking.vala"
	result = _tmp0_;
#line 133 "../src/contacts-linking.vala"
	return result;
#line 2683 "contacts-linking.c"
}

static gchar*
contacts_persona_attribute_local_id_real_to_string (ContactsPersonaAttribute* base)
{
	ContactsPersonaAttributeLocalId * self;
	const gchar* _tmp0_;
	gchar* _tmp1_;
	gchar* result = NULL;
#line 136 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) base;
#line 137 "../src/contacts-linking.vala"
	_tmp0_ = self->priv->value;
#line 137 "../src/contacts-linking.vala"
	_tmp1_ = g_strconcat ("local_id: ", _tmp0_, NULL);
#line 137 "../src/contacts-linking.vala"
	result = _tmp1_;
#line 137 "../src/contacts-linking.vala"
	return result;
#line 2703 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_local_id_real_is_referenced_by_persona (ContactsPersonaAttribute* base,
                                                                   FolksPersona* persona)
{
	ContactsPersonaAttributeLocalId * self;
	FolksLocalIdDetails* details = NULL;
	FolksLocalIdDetails* _tmp0_;
	FolksLocalIdDetails* _tmp1_;
	FolksLocalIdDetails* _tmp2_;
	GeeSet* _tmp3_;
	GeeSet* _tmp4_;
	const gchar* _tmp5_;
	gboolean result = FALSE;
#line 140 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) base;
#line 140 "../src/contacts-linking.vala"
	g_return_val_if_fail (persona != NULL, FALSE);
#line 141 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (persona, FOLKS_TYPE_LOCAL_ID_DETAILS) ? ((FolksLocalIdDetails*) persona) : NULL);
#line 141 "../src/contacts-linking.vala"
	details = _tmp0_;
#line 142 "../src/contacts-linking.vala"
	_tmp1_ = details;
#line 142 "../src/contacts-linking.vala"
	if (_tmp1_ == NULL) {
#line 143 "../src/contacts-linking.vala"
		result = FALSE;
#line 143 "../src/contacts-linking.vala"
		_g_object_unref0 (details);
#line 143 "../src/contacts-linking.vala"
		return result;
#line 2737 "contacts-linking.c"
	}
#line 145 "../src/contacts-linking.vala"
	_tmp2_ = details;
#line 145 "../src/contacts-linking.vala"
	_tmp3_ = folks_local_id_details_get_local_ids (_tmp2_);
#line 145 "../src/contacts-linking.vala"
	_tmp4_ = _tmp3_;
#line 145 "../src/contacts-linking.vala"
	_tmp5_ = self->priv->value;
#line 145 "../src/contacts-linking.vala"
	result = gee_collection_contains ((GeeCollection*) _tmp4_, _tmp5_);
#line 145 "../src/contacts-linking.vala"
	_g_object_unref0 (details);
#line 145 "../src/contacts-linking.vala"
	return result;
#line 2753 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_real_persona_apply_attributes_data_free (gpointer _data)
{
	ContactsPersonaAttributeLocalIdPersonaApplyAttributesData* _data_;
	_data_ = _data;
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_attributes);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_attributes);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->operation);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 124 "../src/contacts-linking.vala"
	g_slice_free (ContactsPersonaAttributeLocalIdPersonaApplyAttributesData, _data_);
#line 2773 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_real_persona_apply_attributes (ContactsPersonaAttribute* base,
                                                                   FolksPersona* persona,
                                                                   GeeSet* added_attributes,
                                                                   GeeSet* removed_attributes,
                                                                   ContactsLinkOperation* operation,
                                                                   GAsyncReadyCallback _callback_,
                                                                   gpointer _user_data_)
{
	ContactsPersonaAttributeLocalId * self;
	ContactsPersonaAttributeLocalIdPersonaApplyAttributesData* _data_;
	ContactsPersonaAttributeLocalId* _tmp0_;
	FolksPersona* _tmp1_;
	GeeSet* _tmp2_;
	GeeSet* _tmp3_;
	ContactsLinkOperation* _tmp4_;
#line 124 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) base;
#line 124 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsPersonaAttributeLocalIdPersonaApplyAttributesData);
#line 124 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 124 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_persona_attribute_local_id_real_persona_apply_attributes_data_free);
#line 124 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 124 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 124 "../src/contacts-linking.vala"
	_tmp1_ = _g_object_ref0 (persona);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 124 "../src/contacts-linking.vala"
	_data_->persona = _tmp1_;
#line 124 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (added_attributes);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_attributes);
#line 124 "../src/contacts-linking.vala"
	_data_->added_attributes = _tmp2_;
#line 124 "../src/contacts-linking.vala"
	_tmp3_ = _g_object_ref0 (removed_attributes);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_attributes);
#line 124 "../src/contacts-linking.vala"
	_data_->removed_attributes = _tmp3_;
#line 124 "../src/contacts-linking.vala"
	_tmp4_ = _g_object_ref0 (operation);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->operation);
#line 124 "../src/contacts-linking.vala"
	_data_->operation = _tmp4_;
#line 124 "../src/contacts-linking.vala"
	contacts_persona_attribute_local_id_real_persona_apply_attributes_co (_data_);
#line 2830 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_persona_apply_attributes_finish (ContactsPersonaAttribute* base,
                                                                     GAsyncResult* _res_)
{
	ContactsPersonaAttributeLocalIdPersonaApplyAttributesData* _data_;
#line 124 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 2840 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_persona_apply_attributes_ready (GObject* source_object,
                                                                    GAsyncResult* _res_,
                                                                    gpointer _user_data_)
{
	ContactsPersonaAttributeLocalIdPersonaApplyAttributesData* _data_;
#line 186 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 186 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 186 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 186 "../src/contacts-linking.vala"
	contacts_persona_attribute_local_id_real_persona_apply_attributes_co (_data_);
#line 2857 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_local_id_real_persona_apply_attributes_co (ContactsPersonaAttributeLocalIdPersonaApplyAttributesData* _data_)
{
#line 148 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 148 "../src/contacts-linking.vala"
		case 0:
#line 2867 "contacts-linking.c"
		goto _state_0;
#line 148 "../src/contacts-linking.vala"
		case 1:
#line 2871 "contacts-linking.c"
		goto _state_1;
		default:
#line 148 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 2876 "contacts-linking.c"
	}
	_state_0:
#line 152 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->persona, FOLKS_TYPE_LOCAL_ID_DETAILS) ? ((FolksLocalIdDetails*) _data_->persona) : NULL);
#line 152 "../src/contacts-linking.vala"
	_data_->details = _data_->_tmp0_;
#line 153 "../src/contacts-linking.vala"
	_data_->_tmp1_ = _data_->details;
#line 153 "../src/contacts-linking.vala"
	if (_data_->_tmp1_ == NULL) {
#line 154 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 154 "../src/contacts-linking.vala"
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 154 "../src/contacts-linking.vala"
		if (_data_->_state_ != 0) {
#line 154 "../src/contacts-linking.vala"
			while (!g_task_get_completed (_data_->_async_result)) {
#line 154 "../src/contacts-linking.vala"
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 2897 "contacts-linking.c"
			}
		}
#line 154 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 154 "../src/contacts-linking.vala"
		return FALSE;
#line 2904 "contacts-linking.c"
	}
#line 156 "../src/contacts-linking.vala"
	_data_->_tmp2_ = gee_hash_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, NULL, NULL, NULL, NULL, NULL, NULL);
#line 156 "../src/contacts-linking.vala"
	_data_->added_values = _data_->_tmp2_;
#line 2910 "contacts-linking.c"
	{
#line 157 "../src/contacts-linking.vala"
		_data_->_tmp3_ = gee_iterable_iterator ((GeeIterable*) _data_->added_attributes);
#line 157 "../src/contacts-linking.vala"
		_data_->_added_it = _data_->_tmp3_;
#line 157 "../src/contacts-linking.vala"
		while (TRUE) {
#line 157 "../src/contacts-linking.vala"
			_data_->_tmp4_ = _data_->_added_it;
#line 157 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp4_)) {
#line 157 "../src/contacts-linking.vala"
				break;
#line 2924 "contacts-linking.c"
			}
#line 157 "../src/contacts-linking.vala"
			_data_->_tmp5_ = _data_->_added_it;
#line 157 "../src/contacts-linking.vala"
			_data_->_tmp6_ = gee_iterator_get (_data_->_tmp5_);
#line 157 "../src/contacts-linking.vala"
			_data_->added = (ContactsPersonaAttribute*) _data_->_tmp6_;
#line 158 "../src/contacts-linking.vala"
			_data_->_tmp7_ = _data_->added_values;
#line 158 "../src/contacts-linking.vala"
			_data_->_tmp8_ = _data_->added;
#line 158 "../src/contacts-linking.vala"
			_data_->_tmp9_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp8_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID, ContactsPersonaAttributeLocalId)->priv->value;
#line 158 "../src/contacts-linking.vala"
			gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp7_, _data_->_tmp9_);
#line 157 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->added);
#line 2942 "contacts-linking.c"
		}
#line 157 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_added_it);
#line 2946 "contacts-linking.c"
	}
#line 161 "../src/contacts-linking.vala"
	_data_->_tmp10_ = gee_hash_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, NULL, NULL, NULL, NULL, NULL, NULL);
#line 161 "../src/contacts-linking.vala"
	_data_->removed_values = _data_->_tmp10_;
#line 2952 "contacts-linking.c"
	{
#line 162 "../src/contacts-linking.vala"
		_data_->_tmp11_ = gee_iterable_iterator ((GeeIterable*) _data_->removed_attributes);
#line 162 "../src/contacts-linking.vala"
		_data_->_removed_it = _data_->_tmp11_;
#line 162 "../src/contacts-linking.vala"
		while (TRUE) {
#line 162 "../src/contacts-linking.vala"
			_data_->_tmp12_ = _data_->_removed_it;
#line 162 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp12_)) {
#line 162 "../src/contacts-linking.vala"
				break;
#line 2966 "contacts-linking.c"
			}
#line 162 "../src/contacts-linking.vala"
			_data_->_tmp13_ = _data_->_removed_it;
#line 162 "../src/contacts-linking.vala"
			_data_->_tmp14_ = gee_iterator_get (_data_->_tmp13_);
#line 162 "../src/contacts-linking.vala"
			_data_->removed = (ContactsPersonaAttribute*) _data_->_tmp14_;
#line 163 "../src/contacts-linking.vala"
			_data_->_tmp15_ = _data_->removed_values;
#line 163 "../src/contacts-linking.vala"
			_data_->_tmp16_ = _data_->removed;
#line 163 "../src/contacts-linking.vala"
			_data_->_tmp17_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp16_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID, ContactsPersonaAttributeLocalId)->priv->value;
#line 163 "../src/contacts-linking.vala"
			gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp15_, _data_->_tmp17_);
#line 162 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->removed);
#line 2984 "contacts-linking.c"
		}
#line 162 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_removed_it);
#line 2988 "contacts-linking.c"
	}
#line 166 "../src/contacts-linking.vala"
	_data_->_tmp18_ = gee_hash_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, NULL, NULL, NULL, NULL, NULL, NULL);
#line 166 "../src/contacts-linking.vala"
	_data_->new_values = _data_->_tmp18_;
#line 167 "../src/contacts-linking.vala"
	_data_->changed = FALSE;
#line 2996 "contacts-linking.c"
	{
#line 168 "../src/contacts-linking.vala"
		_data_->_tmp19_ = _data_->details;
#line 168 "../src/contacts-linking.vala"
		_data_->_tmp20_ = folks_local_id_details_get_local_ids (_data_->_tmp19_);
#line 168 "../src/contacts-linking.vala"
		_data_->_tmp21_ = _data_->_tmp20_;
#line 168 "../src/contacts-linking.vala"
		_data_->_tmp22_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp21_);
#line 168 "../src/contacts-linking.vala"
		_data_->_v_it = _data_->_tmp22_;
#line 168 "../src/contacts-linking.vala"
		while (TRUE) {
#line 168 "../src/contacts-linking.vala"
			_data_->_tmp23_ = _data_->_v_it;
#line 168 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp23_)) {
#line 168 "../src/contacts-linking.vala"
				break;
#line 3016 "contacts-linking.c"
			}
#line 168 "../src/contacts-linking.vala"
			_data_->_tmp24_ = _data_->_v_it;
#line 168 "../src/contacts-linking.vala"
			_data_->_tmp25_ = gee_iterator_get (_data_->_tmp24_);
#line 168 "../src/contacts-linking.vala"
			_data_->v = (gchar*) _data_->_tmp25_;
#line 169 "../src/contacts-linking.vala"
			_data_->_tmp26_ = _data_->removed_values;
#line 169 "../src/contacts-linking.vala"
			_data_->_tmp27_ = _data_->v;
#line 169 "../src/contacts-linking.vala"
			if (gee_abstract_collection_contains ((GeeAbstractCollection*) _data_->_tmp26_, _data_->_tmp27_)) {
#line 170 "../src/contacts-linking.vala"
				_data_->changed = TRUE;
#line 171 "../src/contacts-linking.vala"
				_g_free0 (_data_->v);
#line 171 "../src/contacts-linking.vala"
				continue;
#line 3036 "contacts-linking.c"
			}
#line 173 "../src/contacts-linking.vala"
			_data_->_tmp28_ = _data_->new_values;
#line 173 "../src/contacts-linking.vala"
			_data_->_tmp29_ = _data_->v;
#line 173 "../src/contacts-linking.vala"
			gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp28_, _data_->_tmp29_);
#line 174 "../src/contacts-linking.vala"
			_data_->_tmp30_ = _data_->added_values;
#line 174 "../src/contacts-linking.vala"
			_data_->_tmp31_ = _data_->v;
#line 174 "../src/contacts-linking.vala"
			if (gee_abstract_collection_contains ((GeeAbstractCollection*) _data_->_tmp30_, _data_->_tmp31_)) {
#line 175 "../src/contacts-linking.vala"
				_data_->_tmp32_ = _data_->added_values;
#line 175 "../src/contacts-linking.vala"
				_data_->_tmp33_ = _data_->v;
#line 175 "../src/contacts-linking.vala"
				gee_abstract_collection_remove ((GeeAbstractCollection*) _data_->_tmp32_, _data_->_tmp33_);
#line 3056 "contacts-linking.c"
			}
#line 168 "../src/contacts-linking.vala"
			_g_free0 (_data_->v);
#line 3060 "contacts-linking.c"
		}
#line 168 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_v_it);
#line 3064 "contacts-linking.c"
	}
	{
#line 177 "../src/contacts-linking.vala"
		_data_->_tmp34_ = _data_->added_values;
#line 177 "../src/contacts-linking.vala"
		_data_->_tmp35_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _data_->_tmp34_);
#line 177 "../src/contacts-linking.vala"
		_data_->_v2_it = _data_->_tmp35_;
#line 177 "../src/contacts-linking.vala"
		while (TRUE) {
#line 177 "../src/contacts-linking.vala"
			_data_->_tmp36_ = _data_->_v2_it;
#line 177 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp36_)) {
#line 177 "../src/contacts-linking.vala"
				break;
#line 3081 "contacts-linking.c"
			}
#line 177 "../src/contacts-linking.vala"
			_data_->_tmp37_ = _data_->_v2_it;
#line 177 "../src/contacts-linking.vala"
			_data_->_tmp38_ = gee_iterator_get (_data_->_tmp37_);
#line 177 "../src/contacts-linking.vala"
			_data_->v2 = (gchar*) _data_->_tmp38_;
#line 178 "../src/contacts-linking.vala"
			_data_->changed = TRUE;
#line 179 "../src/contacts-linking.vala"
			_data_->_tmp39_ = _data_->new_values;
#line 179 "../src/contacts-linking.vala"
			_data_->_tmp40_ = _data_->v2;
#line 179 "../src/contacts-linking.vala"
			gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp39_, _data_->_tmp40_);
#line 177 "../src/contacts-linking.vala"
			_g_free0 (_data_->v2);
#line 3099 "contacts-linking.c"
		}
#line 177 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_v2_it);
#line 3103 "contacts-linking.c"
	}
#line 182 "../src/contacts-linking.vala"
	if (_data_->changed) {
#line 3107 "contacts-linking.c"
		{
#line 184 "../src/contacts-linking.vala"
			_data_->_tmp41_ = gee_hash_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, NULL, NULL, NULL, NULL, NULL, NULL);
#line 184 "../src/contacts-linking.vala"
			_data_->old_value = _data_->_tmp41_;
#line 185 "../src/contacts-linking.vala"
			_data_->_tmp42_ = _data_->old_value;
#line 185 "../src/contacts-linking.vala"
			_data_->_tmp43_ = _data_->details;
#line 185 "../src/contacts-linking.vala"
			_data_->_tmp44_ = folks_local_id_details_get_local_ids (_data_->_tmp43_);
#line 185 "../src/contacts-linking.vala"
			_data_->_tmp45_ = _data_->_tmp44_;
#line 185 "../src/contacts-linking.vala"
			gee_collection_add_all ((GeeCollection*) _data_->_tmp42_, (GeeCollection*) _data_->_tmp45_);
#line 186 "../src/contacts-linking.vala"
			_data_->_tmp46_ = _data_->details;
#line 186 "../src/contacts-linking.vala"
			_data_->_tmp47_ = _data_->new_values;
#line 186 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 186 "../src/contacts-linking.vala"
			folks_local_id_details_change_local_ids (_data_->_tmp46_, (GeeSet*) _data_->_tmp47_, contacts_persona_attribute_local_id_persona_apply_attributes_ready, _data_);
#line 186 "../src/contacts-linking.vala"
			return FALSE;
#line 3133 "contacts-linking.c"
			_state_1:
#line 186 "../src/contacts-linking.vala"
			folks_local_id_details_change_local_ids_finish (_data_->_tmp46_, _data_->_res_, &_data_->_inner_error0_);
#line 186 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 186 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->old_value);
#line 3141 "contacts-linking.c"
				goto __catch15_g_error;
			}
#line 187 "../src/contacts-linking.vala"
			_data_->_tmp48_ = _data_->old_value;
#line 187 "../src/contacts-linking.vala"
			contacts_link_operation_add_change (_data_->operation, (ContactsPersonaAttribute*) _data_->self, _data_->persona, (GObject*) _data_->_tmp48_);
#line 183 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->old_value);
#line 3150 "contacts-linking.c"
		}
		goto __finally15;
		__catch15_g_error:
		{
#line 183 "../src/contacts-linking.vala"
			_data_->e = _data_->_inner_error0_;
#line 183 "../src/contacts-linking.vala"
			_data_->_inner_error0_ = NULL;
#line 189 "../src/contacts-linking.vala"
			_data_->_tmp49_ = _data_->e;
#line 189 "../src/contacts-linking.vala"
			_data_->_tmp50_ = _data_->_tmp49_->message;
#line 189 "../src/contacts-linking.vala"
			g_warning ("contacts-linking.vala:189: Unable to set local ids when linking: %s\n", _data_->_tmp50_);
#line 183 "../src/contacts-linking.vala"
			_g_error_free0 (_data_->e);
#line 3167 "contacts-linking.c"
		}
		__finally15:
#line 183 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 183 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->new_values);
#line 183 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->removed_values);
#line 183 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->added_values);
#line 183 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->details);
#line 183 "../src/contacts-linking.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 183 "../src/contacts-linking.vala"
			g_clear_error (&_data_->_inner_error0_);
#line 183 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 183 "../src/contacts-linking.vala"
			return FALSE;
#line 3188 "contacts-linking.c"
		}
	}
#line 148 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->new_values);
#line 148 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_values);
#line 148 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_values);
#line 148 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->details);
#line 148 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 148 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 148 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 148 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 3207 "contacts-linking.c"
		}
	}
#line 148 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 148 "../src/contacts-linking.vala"
	return FALSE;
#line 3214 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_real_set_value_data_free (gpointer _data)
{
	ContactsPersonaAttributeLocalIdSetValueData* _data_;
	_data_ = _data;
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->value);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 124 "../src/contacts-linking.vala"
	g_slice_free (ContactsPersonaAttributeLocalIdSetValueData, _data_);
#line 3230 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_real_set_value (ContactsPersonaAttribute* base,
                                                    FolksPersona* persona,
                                                    GObject* value,
                                                    GAsyncReadyCallback _callback_,
                                                    gpointer _user_data_)
{
	ContactsPersonaAttributeLocalId * self;
	ContactsPersonaAttributeLocalIdSetValueData* _data_;
	ContactsPersonaAttributeLocalId* _tmp0_;
	FolksPersona* _tmp1_;
	GObject* _tmp2_;
#line 124 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) base;
#line 124 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsPersonaAttributeLocalIdSetValueData);
#line 124 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 124 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_persona_attribute_local_id_real_set_value_data_free);
#line 124 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 124 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 124 "../src/contacts-linking.vala"
	_tmp1_ = _g_object_ref0 (persona);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 124 "../src/contacts-linking.vala"
	_data_->persona = _tmp1_;
#line 124 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (value);
#line 124 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->value);
#line 124 "../src/contacts-linking.vala"
	_data_->value = _tmp2_;
#line 124 "../src/contacts-linking.vala"
	contacts_persona_attribute_local_id_real_set_value_co (_data_);
#line 3271 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_set_value_finish (ContactsPersonaAttribute* base,
                                                      GAsyncResult* _res_)
{
	ContactsPersonaAttributeLocalIdSetValueData* _data_;
#line 124 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 3281 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_set_value_ready (GObject* source_object,
                                                     GAsyncResult* _res_,
                                                     gpointer _user_data_)
{
	ContactsPersonaAttributeLocalIdSetValueData* _data_;
#line 201 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 201 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 201 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 201 "../src/contacts-linking.vala"
	contacts_persona_attribute_local_id_real_set_value_co (_data_);
#line 3298 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_local_id_real_set_value_co (ContactsPersonaAttributeLocalIdSetValueData* _data_)
{
#line 194 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 194 "../src/contacts-linking.vala"
		case 0:
#line 3308 "contacts-linking.c"
		goto _state_0;
#line 194 "../src/contacts-linking.vala"
		case 1:
#line 3312 "contacts-linking.c"
		goto _state_1;
		default:
#line 194 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 3317 "contacts-linking.c"
	}
	_state_0:
#line 195 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->persona, FOLKS_TYPE_LOCAL_ID_DETAILS) ? ((FolksLocalIdDetails*) _data_->persona) : NULL);
#line 195 "../src/contacts-linking.vala"
	_data_->details = _data_->_tmp0_;
#line 196 "../src/contacts-linking.vala"
	_data_->_tmp1_ = _data_->details;
#line 196 "../src/contacts-linking.vala"
	if (_data_->_tmp1_ == NULL) {
#line 197 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 197 "../src/contacts-linking.vala"
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 197 "../src/contacts-linking.vala"
		if (_data_->_state_ != 0) {
#line 197 "../src/contacts-linking.vala"
			while (!g_task_get_completed (_data_->_async_result)) {
#line 197 "../src/contacts-linking.vala"
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 3338 "contacts-linking.c"
			}
		}
#line 197 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 197 "../src/contacts-linking.vala"
		return FALSE;
#line 3345 "contacts-linking.c"
	}
	{
#line 200 "../src/contacts-linking.vala"
		_data_->_tmp2_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->value, GEE_TYPE_HASH_SET) ? ((GeeHashSet*) _data_->value) : NULL);
#line 200 "../src/contacts-linking.vala"
		_data_->v = _data_->_tmp2_;
#line 201 "../src/contacts-linking.vala"
		_data_->_tmp3_ = _data_->details;
#line 201 "../src/contacts-linking.vala"
		_data_->_tmp4_ = _data_->v;
#line 201 "../src/contacts-linking.vala"
		_data_->_state_ = 1;
#line 201 "../src/contacts-linking.vala"
		folks_local_id_details_change_local_ids (_data_->_tmp3_, (GeeSet*) _data_->_tmp4_, contacts_persona_attribute_local_id_set_value_ready, _data_);
#line 201 "../src/contacts-linking.vala"
		return FALSE;
#line 3362 "contacts-linking.c"
		_state_1:
#line 201 "../src/contacts-linking.vala"
		folks_local_id_details_change_local_ids_finish (_data_->_tmp3_, _data_->_res_, &_data_->_inner_error0_);
#line 201 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 201 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->v);
#line 3370 "contacts-linking.c"
			goto __catch16_g_error;
		}
#line 199 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->v);
#line 3375 "contacts-linking.c"
	}
	goto __finally16;
	__catch16_g_error:
	{
#line 199 "../src/contacts-linking.vala"
		_data_->e = _data_->_inner_error0_;
#line 199 "../src/contacts-linking.vala"
		_data_->_inner_error0_ = NULL;
#line 203 "../src/contacts-linking.vala"
		_data_->_tmp5_ = _data_->e;
#line 203 "../src/contacts-linking.vala"
		_data_->_tmp6_ = _data_->_tmp5_->message;
#line 203 "../src/contacts-linking.vala"
		g_warning ("contacts-linking.vala:203: Unable to set local ids when undoing link: " \
"%s\n", _data_->_tmp6_);
#line 199 "../src/contacts-linking.vala"
		_g_error_free0 (_data_->e);
#line 3392 "contacts-linking.c"
	}
	__finally16:
#line 199 "../src/contacts-linking.vala"
	if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 199 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 199 "../src/contacts-linking.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 199 "../src/contacts-linking.vala"
		g_clear_error (&_data_->_inner_error0_);
#line 199 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 199 "../src/contacts-linking.vala"
		return FALSE;
#line 3407 "contacts-linking.c"
	}
#line 194 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->details);
#line 194 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 194 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 194 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 194 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 3419 "contacts-linking.c"
		}
	}
#line 194 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 194 "../src/contacts-linking.vala"
	return FALSE;
#line 3426 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_local_id_real_equal (ContactsPersonaAttribute* base,
                                                ContactsPersonaAttribute* _that)
{
	ContactsPersonaAttributeLocalId * self;
	ContactsPersonaAttributeLocalId* that = NULL;
	ContactsPersonaAttributeLocalId* _tmp0_;
	gboolean _tmp1_ = FALSE;
	gboolean _tmp2_ = FALSE;
	ContactsPersonaAttributeLocalId* _tmp3_;
	gboolean result = FALSE;
#line 207 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) base;
#line 207 "../src/contacts-linking.vala"
	g_return_val_if_fail (_that != NULL, FALSE);
#line 208 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (CONTACTS_IS_PERSONA_ATTRIBUTE_LOCAL_ID (_that) ? ((ContactsPersonaAttributeLocalId*) _that) : NULL);
#line 208 "../src/contacts-linking.vala"
	that = _tmp0_;
#line 210 "../src/contacts-linking.vala"
	_tmp3_ = that;
#line 210 "../src/contacts-linking.vala"
	if (_tmp3_ != NULL) {
#line 3452 "contacts-linking.c"
		ContactsPersonaAttributeLocalId* _tmp4_;
#line 211 "../src/contacts-linking.vala"
		_tmp4_ = that;
#line 211 "../src/contacts-linking.vala"
		_tmp2_ = CONTACTS_PERSONA_ATTRIBUTE_CLASS (contacts_persona_attribute_local_id_parent_class)->equal (G_TYPE_CHECK_INSTANCE_CAST (self, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute), (ContactsPersonaAttribute*) _tmp4_);
#line 3458 "contacts-linking.c"
	} else {
#line 210 "../src/contacts-linking.vala"
		_tmp2_ = FALSE;
#line 3462 "contacts-linking.c"
	}
#line 210 "../src/contacts-linking.vala"
	if (_tmp2_) {
#line 3466 "contacts-linking.c"
		const gchar* _tmp5_;
		ContactsPersonaAttributeLocalId* _tmp6_;
		const gchar* _tmp7_;
#line 212 "../src/contacts-linking.vala"
		_tmp5_ = self->priv->value;
#line 212 "../src/contacts-linking.vala"
		_tmp6_ = that;
#line 212 "../src/contacts-linking.vala"
		_tmp7_ = _tmp6_->priv->value;
#line 212 "../src/contacts-linking.vala"
		_tmp1_ = g_strcmp0 (_tmp5_, _tmp7_) == 0;
#line 3478 "contacts-linking.c"
	} else {
#line 210 "../src/contacts-linking.vala"
		_tmp1_ = FALSE;
#line 3482 "contacts-linking.c"
	}
#line 209 "../src/contacts-linking.vala"
	result = _tmp1_;
#line 209 "../src/contacts-linking.vala"
	_g_object_unref0 (that);
#line 209 "../src/contacts-linking.vala"
	return result;
#line 3490 "contacts-linking.c"
}

static guint
contacts_persona_attribute_local_id_real_hash (ContactsPersonaAttribute* base)
{
	ContactsPersonaAttributeLocalId * self;
	const gchar* _tmp0_;
	guint result = 0U;
#line 215 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeLocalId*) base;
#line 216 "../src/contacts-linking.vala"
	_tmp0_ = self->priv->value;
#line 216 "../src/contacts-linking.vala"
	result = g_str_hash (_tmp0_) ^ CONTACTS_PERSONA_ATTRIBUTE_CLASS (contacts_persona_attribute_local_id_parent_class)->hash (G_TYPE_CHECK_INSTANCE_CAST (self, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute));
#line 216 "../src/contacts-linking.vala"
	return result;
#line 3507 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_class_init (ContactsPersonaAttributeLocalIdClass * klass,
                                                gpointer klass_data)
{
#line 124 "../src/contacts-linking.vala"
	contacts_persona_attribute_local_id_parent_class = g_type_class_peek_parent (klass);
#line 124 "../src/contacts-linking.vala"
	g_type_class_adjust_private_offset (klass, &ContactsPersonaAttributeLocalId_private_offset);
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->is_removable = (gboolean (*) (ContactsPersonaAttribute*, FolksPersona*)) contacts_persona_attribute_local_id_real_is_removable;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->to_string = (gchar* (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_local_id_real_to_string;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->is_referenced_by_persona = (gboolean (*) (ContactsPersonaAttribute*, FolksPersona*)) contacts_persona_attribute_local_id_real_is_referenced_by_persona;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->persona_apply_attributes = (void (*) (ContactsPersonaAttribute*, FolksPersona*, GeeSet*, GeeSet*, ContactsLinkOperation*, GAsyncReadyCallback, gpointer)) contacts_persona_attribute_local_id_real_persona_apply_attributes;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->persona_apply_attributes_finish = (void (*) (ContactsPersonaAttribute*, GAsyncResult*)) contacts_persona_attribute_local_id_persona_apply_attributes_finish;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->set_value = (void (*) (ContactsPersonaAttribute*, FolksPersona*, GObject*, GAsyncReadyCallback, gpointer)) contacts_persona_attribute_local_id_real_set_value;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->set_value_finish = (void (*) (ContactsPersonaAttribute*, GAsyncResult*)) contacts_persona_attribute_local_id_set_value_finish;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->equal = (gboolean (*) (ContactsPersonaAttribute*, ContactsPersonaAttribute*)) contacts_persona_attribute_local_id_real_equal;
#line 124 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->hash = (guint (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_local_id_real_hash;
#line 124 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_persona_attribute_local_id_finalize;
#line 3538 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_instance_init (ContactsPersonaAttributeLocalId * self,
                                                   gpointer klass)
{
#line 124 "../src/contacts-linking.vala"
	self->priv = contacts_persona_attribute_local_id_get_instance_private (self);
#line 3547 "contacts-linking.c"
}

static void
contacts_persona_attribute_local_id_finalize (GObject * obj)
{
	ContactsPersonaAttributeLocalId * self;
#line 124 "../src/contacts-linking.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_PERSONA_ATTRIBUTE_LOCAL_ID, ContactsPersonaAttributeLocalId);
#line 125 "../src/contacts-linking.vala"
	_g_free0 (self->priv->value);
#line 124 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (contacts_persona_attribute_local_id_parent_class)->finalize (obj);
#line 3560 "contacts-linking.c"
}

static GType
contacts_persona_attribute_local_id_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsPersonaAttributeLocalIdClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_persona_attribute_local_id_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsPersonaAttributeLocalId), 0, (GInstanceInitFunc) contacts_persona_attribute_local_id_instance_init, NULL };
	GType contacts_persona_attribute_local_id_type_id;
	contacts_persona_attribute_local_id_type_id = g_type_register_static (CONTACTS_TYPE_PERSONA_ATTRIBUTE, "ContactsPersonaAttributeLocalId", &g_define_type_info, 0);
	ContactsPersonaAttributeLocalId_private_offset = g_type_add_instance_private (contacts_persona_attribute_local_id_type_id, sizeof (ContactsPersonaAttributeLocalIdPrivate));
	return contacts_persona_attribute_local_id_type_id;
}

GType
contacts_persona_attribute_local_id_get_type (void)
{
	static volatile gsize contacts_persona_attribute_local_id_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_persona_attribute_local_id_type_id__volatile)) {
		GType contacts_persona_attribute_local_id_type_id;
		contacts_persona_attribute_local_id_type_id = contacts_persona_attribute_local_id_get_type_once ();
		g_once_init_leave (&contacts_persona_attribute_local_id_type_id__volatile, contacts_persona_attribute_local_id_type_id);
	}
	return contacts_persona_attribute_local_id_type_id__volatile;
}

static inline gpointer
contacts_persona_attribute_im_address_get_instance_private (ContactsPersonaAttributeImAddress* self)
{
	return G_STRUCT_MEMBER_P (self, ContactsPersonaAttributeImAddress_private_offset);
}

ContactsPersonaAttributeImAddress*
contacts_persona_attribute_im_address_construct (GType object_type,
                                                 const gchar* protocol,
                                                 FolksImFieldDetails* detail)
{
	ContactsPersonaAttributeImAddress * self = NULL;
	gchar* _tmp0_;
	gchar* _tmp1_;
	FolksImFieldDetails* _tmp2_;
#line 224 "../src/contacts-linking.vala"
	g_return_val_if_fail (protocol != NULL, NULL);
#line 224 "../src/contacts-linking.vala"
	g_return_val_if_fail (detail != NULL, NULL);
#line 224 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeImAddress*) contacts_persona_attribute_construct (object_type);
#line 225 "../src/contacts-linking.vala"
	_tmp0_ = g_strdup ("im-addresses");
#line 225 "../src/contacts-linking.vala"
	_g_free0 (((ContactsPersonaAttribute*) self)->property_name);
#line 225 "../src/contacts-linking.vala"
	((ContactsPersonaAttribute*) self)->property_name = _tmp0_;
#line 226 "../src/contacts-linking.vala"
	_tmp1_ = g_strdup (protocol);
#line 226 "../src/contacts-linking.vala"
	_g_free0 (self->priv->protocol);
#line 226 "../src/contacts-linking.vala"
	self->priv->protocol = _tmp1_;
#line 227 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (detail);
#line 227 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->detail);
#line 227 "../src/contacts-linking.vala"
	self->priv->detail = _tmp2_;
#line 224 "../src/contacts-linking.vala"
	return self;
#line 3626 "contacts-linking.c"
}

ContactsPersonaAttributeImAddress*
contacts_persona_attribute_im_address_new (const gchar* protocol,
                                           FolksImFieldDetails* detail)
{
#line 224 "../src/contacts-linking.vala"
	return contacts_persona_attribute_im_address_construct (CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, protocol, detail);
#line 3635 "contacts-linking.c"
}

static gchar*
contacts_persona_attribute_im_address_real_to_string (ContactsPersonaAttribute* base)
{
	ContactsPersonaAttributeImAddress * self;
	const gchar* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	FolksImFieldDetails* _tmp5_;
	gconstpointer _tmp6_;
	const gchar* _tmp7_;
	gchar* _tmp8_;
	gchar* _tmp9_;
	gchar* result = NULL;
#line 230 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeImAddress*) base;
#line 231 "../src/contacts-linking.vala"
	_tmp0_ = self->priv->protocol;
#line 231 "../src/contacts-linking.vala"
	_tmp1_ = g_strconcat ("im_addresses: ", _tmp0_, NULL);
#line 231 "../src/contacts-linking.vala"
	_tmp2_ = _tmp1_;
#line 231 "../src/contacts-linking.vala"
	_tmp3_ = g_strconcat (_tmp2_, ":", NULL);
#line 231 "../src/contacts-linking.vala"
	_tmp4_ = _tmp3_;
#line 231 "../src/contacts-linking.vala"
	_tmp5_ = self->priv->detail;
#line 231 "../src/contacts-linking.vala"
	_tmp6_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp5_);
#line 231 "../src/contacts-linking.vala"
	_tmp7_ = _tmp6_;
#line 231 "../src/contacts-linking.vala"
	_tmp8_ = g_strconcat (_tmp4_, (const gchar*) _tmp7_, NULL);
#line 231 "../src/contacts-linking.vala"
	_tmp9_ = _tmp8_;
#line 231 "../src/contacts-linking.vala"
	_g_free0 (_tmp4_);
#line 231 "../src/contacts-linking.vala"
	_g_free0 (_tmp2_);
#line 231 "../src/contacts-linking.vala"
	result = _tmp9_;
#line 231 "../src/contacts-linking.vala"
	return result;
#line 3683 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_im_address_real_is_referenced_by_persona (ContactsPersonaAttribute* base,
                                                                     FolksPersona* persona)
{
	ContactsPersonaAttributeImAddress * self;
	FolksImDetails* details = NULL;
	FolksImDetails* _tmp0_;
	FolksImDetails* _tmp1_;
	FolksImDetails* _tmp2_;
	GeeMultiMap* _tmp3_;
	GeeMultiMap* _tmp4_;
	const gchar* _tmp5_;
	GeeCollection* _tmp6_;
	GeeCollection* _tmp7_;
	FolksImFieldDetails* _tmp8_;
	gboolean _tmp9_;
	gboolean result = FALSE;
#line 234 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeImAddress*) base;
#line 234 "../src/contacts-linking.vala"
	g_return_val_if_fail (persona != NULL, FALSE);
#line 235 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (persona, FOLKS_TYPE_IM_DETAILS) ? ((FolksImDetails*) persona) : NULL);
#line 235 "../src/contacts-linking.vala"
	details = _tmp0_;
#line 236 "../src/contacts-linking.vala"
	_tmp1_ = details;
#line 236 "../src/contacts-linking.vala"
	if (_tmp1_ == NULL) {
#line 237 "../src/contacts-linking.vala"
		result = FALSE;
#line 237 "../src/contacts-linking.vala"
		_g_object_unref0 (details);
#line 237 "../src/contacts-linking.vala"
		return result;
#line 3721 "contacts-linking.c"
	}
#line 239 "../src/contacts-linking.vala"
	_tmp2_ = details;
#line 239 "../src/contacts-linking.vala"
	_tmp3_ = folks_im_details_get_im_addresses (_tmp2_);
#line 239 "../src/contacts-linking.vala"
	_tmp4_ = _tmp3_;
#line 239 "../src/contacts-linking.vala"
	_tmp5_ = self->priv->protocol;
#line 239 "../src/contacts-linking.vala"
	_tmp6_ = gee_multi_map_get (_tmp4_, _tmp5_);
#line 239 "../src/contacts-linking.vala"
	_tmp7_ = _tmp6_;
#line 239 "../src/contacts-linking.vala"
	_tmp8_ = self->priv->detail;
#line 239 "../src/contacts-linking.vala"
	_tmp9_ = gee_collection_contains (_tmp7_, _tmp8_);
#line 239 "../src/contacts-linking.vala"
	_g_object_unref0 (_tmp7_);
#line 239 "../src/contacts-linking.vala"
	result = _tmp9_;
#line 239 "../src/contacts-linking.vala"
	_g_object_unref0 (details);
#line 239 "../src/contacts-linking.vala"
	return result;
#line 3747 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_real_persona_apply_attributes_data_free (gpointer _data)
{
	ContactsPersonaAttributeImAddressPersonaApplyAttributesData* _data_;
	_data_ = _data;
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_attributes);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_attributes);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->operation);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 220 "../src/contacts-linking.vala"
	g_slice_free (ContactsPersonaAttributeImAddressPersonaApplyAttributesData, _data_);
#line 3767 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_real_persona_apply_attributes (ContactsPersonaAttribute* base,
                                                                     FolksPersona* persona,
                                                                     GeeSet* added_attributes,
                                                                     GeeSet* removed_attributes,
                                                                     ContactsLinkOperation* operation,
                                                                     GAsyncReadyCallback _callback_,
                                                                     gpointer _user_data_)
{
	ContactsPersonaAttributeImAddress * self;
	ContactsPersonaAttributeImAddressPersonaApplyAttributesData* _data_;
	ContactsPersonaAttributeImAddress* _tmp0_;
	FolksPersona* _tmp1_;
	GeeSet* _tmp2_;
	GeeSet* _tmp3_;
	ContactsLinkOperation* _tmp4_;
#line 220 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeImAddress*) base;
#line 220 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsPersonaAttributeImAddressPersonaApplyAttributesData);
#line 220 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 220 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_persona_attribute_im_address_real_persona_apply_attributes_data_free);
#line 220 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 220 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 220 "../src/contacts-linking.vala"
	_tmp1_ = _g_object_ref0 (persona);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 220 "../src/contacts-linking.vala"
	_data_->persona = _tmp1_;
#line 220 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (added_attributes);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_attributes);
#line 220 "../src/contacts-linking.vala"
	_data_->added_attributes = _tmp2_;
#line 220 "../src/contacts-linking.vala"
	_tmp3_ = _g_object_ref0 (removed_attributes);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_attributes);
#line 220 "../src/contacts-linking.vala"
	_data_->removed_attributes = _tmp3_;
#line 220 "../src/contacts-linking.vala"
	_tmp4_ = _g_object_ref0 (operation);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->operation);
#line 220 "../src/contacts-linking.vala"
	_data_->operation = _tmp4_;
#line 220 "../src/contacts-linking.vala"
	contacts_persona_attribute_im_address_real_persona_apply_attributes_co (_data_);
#line 3824 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_persona_apply_attributes_finish (ContactsPersonaAttribute* base,
                                                                       GAsyncResult* _res_)
{
	ContactsPersonaAttributeImAddressPersonaApplyAttributesData* _data_;
#line 220 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 3834 "contacts-linking.c"
}

static guint
_folks_abstract_field_details_hash_static_gee_hash_data_func (gconstpointer v,
                                                              gpointer self)
{
	guint result;
	result = folks_abstract_field_details_hash_static ((FolksAbstractFieldDetails*) v);
#line 250 "../src/contacts-linking.vala"
	return result;
#line 3845 "contacts-linking.c"
}

static gboolean
_folks_abstract_field_details_equal_static_gee_equal_data_func (gconstpointer a,
                                                                gconstpointer b,
                                                                gpointer self)
{
	gboolean result;
	result = folks_abstract_field_details_equal_static ((FolksAbstractFieldDetails*) a, (FolksAbstractFieldDetails*) b);
#line 250 "../src/contacts-linking.vala"
	return result;
#line 3857 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_persona_apply_attributes_ready (GObject* source_object,
                                                                      GAsyncResult* _res_,
                                                                      gpointer _user_data_)
{
	ContactsPersonaAttributeImAddressPersonaApplyAttributesData* _data_;
#line 292 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 292 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 292 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 292 "../src/contacts-linking.vala"
	contacts_persona_attribute_im_address_real_persona_apply_attributes_co (_data_);
#line 3874 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_im_address_real_persona_apply_attributes_co (ContactsPersonaAttributeImAddressPersonaApplyAttributesData* _data_)
{
#line 242 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 242 "../src/contacts-linking.vala"
		case 0:
#line 3884 "contacts-linking.c"
		goto _state_0;
#line 242 "../src/contacts-linking.vala"
		case 1:
#line 3888 "contacts-linking.c"
		goto _state_1;
		default:
#line 242 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 3893 "contacts-linking.c"
	}
	_state_0:
#line 246 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->persona, FOLKS_TYPE_IM_DETAILS) ? ((FolksImDetails*) _data_->persona) : NULL);
#line 246 "../src/contacts-linking.vala"
	_data_->details = _data_->_tmp0_;
#line 247 "../src/contacts-linking.vala"
	_data_->_tmp1_ = _data_->details;
#line 247 "../src/contacts-linking.vala"
	if (_data_->_tmp1_ == NULL) {
#line 248 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 248 "../src/contacts-linking.vala"
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 248 "../src/contacts-linking.vala"
		if (_data_->_state_ != 0) {
#line 248 "../src/contacts-linking.vala"
			while (!g_task_get_completed (_data_->_async_result)) {
#line 248 "../src/contacts-linking.vala"
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 3914 "contacts-linking.c"
			}
		}
#line 248 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 248 "../src/contacts-linking.vala"
		return FALSE;
#line 3921 "contacts-linking.c"
	}
#line 250 "../src/contacts-linking.vala"
	_data_->_tmp2_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, FOLKS_TYPE_IM_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
#line 250 "../src/contacts-linking.vala"
	_data_->added_values = _data_->_tmp2_;
#line 3927 "contacts-linking.c"
	{
#line 253 "../src/contacts-linking.vala"
		_data_->_tmp3_ = gee_iterable_iterator ((GeeIterable*) _data_->added_attributes);
#line 253 "../src/contacts-linking.vala"
		_data_->_added_it = _data_->_tmp3_;
#line 253 "../src/contacts-linking.vala"
		while (TRUE) {
#line 253 "../src/contacts-linking.vala"
			_data_->_tmp4_ = _data_->_added_it;
#line 253 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp4_)) {
#line 253 "../src/contacts-linking.vala"
				break;
#line 3941 "contacts-linking.c"
			}
#line 253 "../src/contacts-linking.vala"
			_data_->_tmp5_ = _data_->_added_it;
#line 253 "../src/contacts-linking.vala"
			_data_->_tmp6_ = gee_iterator_get (_data_->_tmp5_);
#line 253 "../src/contacts-linking.vala"
			_data_->added = (ContactsPersonaAttribute*) _data_->_tmp6_;
#line 254 "../src/contacts-linking.vala"
			_data_->_tmp7_ = _data_->added_values;
#line 254 "../src/contacts-linking.vala"
			_data_->_tmp8_ = _data_->added;
#line 254 "../src/contacts-linking.vala"
			_data_->_tmp9_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp8_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddress)->priv->protocol;
#line 254 "../src/contacts-linking.vala"
			_data_->_tmp10_ = _data_->added;
#line 254 "../src/contacts-linking.vala"
			_data_->_tmp11_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp10_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddress)->priv->detail;
#line 254 "../src/contacts-linking.vala"
			gee_multi_map_set ((GeeMultiMap*) _data_->_tmp7_, _data_->_tmp9_, _data_->_tmp11_);
#line 253 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->added);
#line 3963 "contacts-linking.c"
		}
#line 253 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_added_it);
#line 3967 "contacts-linking.c"
	}
#line 257 "../src/contacts-linking.vala"
	_data_->_tmp12_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, FOLKS_TYPE_IM_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
#line 257 "../src/contacts-linking.vala"
	_data_->removed_values = _data_->_tmp12_;
#line 3973 "contacts-linking.c"
	{
#line 261 "../src/contacts-linking.vala"
		_data_->_tmp13_ = gee_iterable_iterator ((GeeIterable*) _data_->removed_attributes);
#line 261 "../src/contacts-linking.vala"
		_data_->_removed_it = _data_->_tmp13_;
#line 261 "../src/contacts-linking.vala"
		while (TRUE) {
#line 261 "../src/contacts-linking.vala"
			_data_->_tmp14_ = _data_->_removed_it;
#line 261 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp14_)) {
#line 261 "../src/contacts-linking.vala"
				break;
#line 3987 "contacts-linking.c"
			}
#line 261 "../src/contacts-linking.vala"
			_data_->_tmp15_ = _data_->_removed_it;
#line 261 "../src/contacts-linking.vala"
			_data_->_tmp16_ = gee_iterator_get (_data_->_tmp15_);
#line 261 "../src/contacts-linking.vala"
			_data_->removed = (ContactsPersonaAttribute*) _data_->_tmp16_;
#line 262 "../src/contacts-linking.vala"
			_data_->_tmp17_ = _data_->removed_values;
#line 262 "../src/contacts-linking.vala"
			_data_->_tmp18_ = _data_->removed;
#line 262 "../src/contacts-linking.vala"
			_data_->_tmp19_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp18_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddress)->priv->protocol;
#line 262 "../src/contacts-linking.vala"
			_data_->_tmp20_ = _data_->removed;
#line 262 "../src/contacts-linking.vala"
			_data_->_tmp21_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp20_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddress)->priv->detail;
#line 262 "../src/contacts-linking.vala"
			gee_multi_map_set ((GeeMultiMap*) _data_->_tmp17_, _data_->_tmp19_, _data_->_tmp21_);
#line 261 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->removed);
#line 4009 "contacts-linking.c"
		}
#line 261 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_removed_it);
#line 4013 "contacts-linking.c"
	}
#line 265 "../src/contacts-linking.vala"
	_data_->_tmp22_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, FOLKS_TYPE_IM_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
#line 265 "../src/contacts-linking.vala"
	_data_->new_values = _data_->_tmp22_;
#line 269 "../src/contacts-linking.vala"
	_data_->changed = FALSE;
#line 4021 "contacts-linking.c"
	{
#line 270 "../src/contacts-linking.vala"
		_data_->_tmp23_ = _data_->details;
#line 270 "../src/contacts-linking.vala"
		_data_->_tmp24_ = folks_im_details_get_im_addresses (_data_->_tmp23_);
#line 270 "../src/contacts-linking.vala"
		_data_->_tmp25_ = _data_->_tmp24_;
#line 270 "../src/contacts-linking.vala"
		_data_->_tmp26_ = gee_multi_map_get_keys (_data_->_tmp25_);
#line 270 "../src/contacts-linking.vala"
		_data_->_tmp27_ = _data_->_tmp26_;
#line 270 "../src/contacts-linking.vala"
		_data_->_tmp28_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp27_);
#line 270 "../src/contacts-linking.vala"
		_data_->_tmp29_ = _data_->_tmp28_;
#line 270 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_tmp27_);
#line 270 "../src/contacts-linking.vala"
		_data_->_proto1_it = _data_->_tmp29_;
#line 270 "../src/contacts-linking.vala"
		while (TRUE) {
#line 270 "../src/contacts-linking.vala"
			_data_->_tmp30_ = _data_->_proto1_it;
#line 270 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp30_)) {
#line 270 "../src/contacts-linking.vala"
				break;
#line 4049 "contacts-linking.c"
			}
#line 270 "../src/contacts-linking.vala"
			_data_->_tmp31_ = _data_->_proto1_it;
#line 270 "../src/contacts-linking.vala"
			_data_->_tmp32_ = gee_iterator_get (_data_->_tmp31_);
#line 270 "../src/contacts-linking.vala"
			_data_->proto1 = (gchar*) _data_->_tmp32_;
#line 4057 "contacts-linking.c"
			{
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp33_ = _data_->details;
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp34_ = folks_im_details_get_im_addresses (_data_->_tmp33_);
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp35_ = _data_->_tmp34_;
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp36_ = _data_->proto1;
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp37_ = gee_multi_map_get (_data_->_tmp35_, _data_->_tmp36_);
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp38_ = _data_->_tmp37_;
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp39_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp38_);
#line 271 "../src/contacts-linking.vala"
				_data_->_tmp40_ = _data_->_tmp39_;
#line 271 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_tmp38_);
#line 271 "../src/contacts-linking.vala"
				_data_->_detail1_it = _data_->_tmp40_;
#line 271 "../src/contacts-linking.vala"
				while (TRUE) {
#line 271 "../src/contacts-linking.vala"
					_data_->_tmp41_ = _data_->_detail1_it;
#line 271 "../src/contacts-linking.vala"
					if (!gee_iterator_next (_data_->_tmp41_)) {
#line 271 "../src/contacts-linking.vala"
						break;
#line 4087 "contacts-linking.c"
					}
#line 271 "../src/contacts-linking.vala"
					_data_->_tmp42_ = _data_->_detail1_it;
#line 271 "../src/contacts-linking.vala"
					_data_->_tmp43_ = gee_iterator_get (_data_->_tmp42_);
#line 271 "../src/contacts-linking.vala"
					_data_->detail1 = (FolksImFieldDetails*) _data_->_tmp43_;
#line 272 "../src/contacts-linking.vala"
					_data_->_tmp44_ = _data_->removed_values;
#line 272 "../src/contacts-linking.vala"
					_data_->_tmp45_ = _data_->proto1;
#line 272 "../src/contacts-linking.vala"
					_data_->_tmp46_ = gee_multi_map_get ((GeeMultiMap*) _data_->_tmp44_, _data_->_tmp45_);
#line 272 "../src/contacts-linking.vala"
					_data_->_tmp47_ = _data_->_tmp46_;
#line 272 "../src/contacts-linking.vala"
					_data_->_tmp48_ = _data_->detail1;
#line 272 "../src/contacts-linking.vala"
					_data_->_tmp49_ = gee_collection_contains (_data_->_tmp47_, _data_->_tmp48_);
#line 272 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->_tmp47_);
#line 272 "../src/contacts-linking.vala"
					if (_data_->_tmp49_) {
#line 273 "../src/contacts-linking.vala"
						_data_->changed = TRUE;
#line 274 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->detail1);
#line 274 "../src/contacts-linking.vala"
						continue;
#line 4117 "contacts-linking.c"
					}
#line 276 "../src/contacts-linking.vala"
					_data_->_tmp50_ = _data_->new_values;
#line 276 "../src/contacts-linking.vala"
					_data_->_tmp51_ = _data_->proto1;
#line 276 "../src/contacts-linking.vala"
					_data_->_tmp52_ = _data_->detail1;
#line 276 "../src/contacts-linking.vala"
					gee_multi_map_set ((GeeMultiMap*) _data_->_tmp50_, _data_->_tmp51_, _data_->_tmp52_);
#line 277 "../src/contacts-linking.vala"
					_data_->_tmp53_ = _data_->added_values;
#line 277 "../src/contacts-linking.vala"
					_data_->_tmp54_ = _data_->proto1;
#line 277 "../src/contacts-linking.vala"
					_data_->_tmp55_ = gee_multi_map_get ((GeeMultiMap*) _data_->_tmp53_, _data_->_tmp54_);
#line 277 "../src/contacts-linking.vala"
					_data_->_tmp56_ = _data_->_tmp55_;
#line 277 "../src/contacts-linking.vala"
					_data_->_tmp57_ = _data_->detail1;
#line 277 "../src/contacts-linking.vala"
					_data_->_tmp58_ = gee_collection_contains (_data_->_tmp56_, _data_->_tmp57_);
#line 277 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->_tmp56_);
#line 277 "../src/contacts-linking.vala"
					if (_data_->_tmp58_) {
#line 278 "../src/contacts-linking.vala"
						_data_->_tmp59_ = _data_->added_values;
#line 278 "../src/contacts-linking.vala"
						_data_->_tmp60_ = _data_->proto1;
#line 278 "../src/contacts-linking.vala"
						_data_->_tmp61_ = _data_->detail1;
#line 278 "../src/contacts-linking.vala"
						gee_multi_map_remove ((GeeMultiMap*) _data_->_tmp59_, _data_->_tmp60_, _data_->_tmp61_);
#line 4151 "contacts-linking.c"
					}
#line 271 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->detail1);
#line 4155 "contacts-linking.c"
				}
#line 271 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_detail1_it);
#line 4159 "contacts-linking.c"
			}
#line 270 "../src/contacts-linking.vala"
			_g_free0 (_data_->proto1);
#line 4163 "contacts-linking.c"
		}
#line 270 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_proto1_it);
#line 4167 "contacts-linking.c"
	}
	{
#line 282 "../src/contacts-linking.vala"
		_data_->_tmp62_ = _data_->added_values;
#line 282 "../src/contacts-linking.vala"
		_data_->_tmp63_ = gee_multi_map_get_keys ((GeeMultiMap*) _data_->_tmp62_);
#line 282 "../src/contacts-linking.vala"
		_data_->_tmp64_ = _data_->_tmp63_;
#line 282 "../src/contacts-linking.vala"
		_data_->_tmp65_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp64_);
#line 282 "../src/contacts-linking.vala"
		_data_->_tmp66_ = _data_->_tmp65_;
#line 282 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_tmp64_);
#line 282 "../src/contacts-linking.vala"
		_data_->_proto2_it = _data_->_tmp66_;
#line 282 "../src/contacts-linking.vala"
		while (TRUE) {
#line 282 "../src/contacts-linking.vala"
			_data_->_tmp67_ = _data_->_proto2_it;
#line 282 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp67_)) {
#line 282 "../src/contacts-linking.vala"
				break;
#line 4192 "contacts-linking.c"
			}
#line 282 "../src/contacts-linking.vala"
			_data_->_tmp68_ = _data_->_proto2_it;
#line 282 "../src/contacts-linking.vala"
			_data_->_tmp69_ = gee_iterator_get (_data_->_tmp68_);
#line 282 "../src/contacts-linking.vala"
			_data_->proto2 = (gchar*) _data_->_tmp69_;
#line 4200 "contacts-linking.c"
			{
#line 283 "../src/contacts-linking.vala"
				_data_->_tmp70_ = _data_->added_values;
#line 283 "../src/contacts-linking.vala"
				_data_->_tmp71_ = _data_->proto2;
#line 283 "../src/contacts-linking.vala"
				_data_->_tmp72_ = gee_multi_map_get ((GeeMultiMap*) _data_->_tmp70_, _data_->_tmp71_);
#line 283 "../src/contacts-linking.vala"
				_data_->_tmp73_ = _data_->_tmp72_;
#line 283 "../src/contacts-linking.vala"
				_data_->_tmp74_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp73_);
#line 283 "../src/contacts-linking.vala"
				_data_->_tmp75_ = _data_->_tmp74_;
#line 283 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_tmp73_);
#line 283 "../src/contacts-linking.vala"
				_data_->_detail2_it = _data_->_tmp75_;
#line 283 "../src/contacts-linking.vala"
				while (TRUE) {
#line 283 "../src/contacts-linking.vala"
					_data_->_tmp76_ = _data_->_detail2_it;
#line 283 "../src/contacts-linking.vala"
					if (!gee_iterator_next (_data_->_tmp76_)) {
#line 283 "../src/contacts-linking.vala"
						break;
#line 4226 "contacts-linking.c"
					}
#line 283 "../src/contacts-linking.vala"
					_data_->_tmp77_ = _data_->_detail2_it;
#line 283 "../src/contacts-linking.vala"
					_data_->_tmp78_ = gee_iterator_get (_data_->_tmp77_);
#line 283 "../src/contacts-linking.vala"
					_data_->detail2 = (FolksImFieldDetails*) _data_->_tmp78_;
#line 284 "../src/contacts-linking.vala"
					_data_->changed = TRUE;
#line 285 "../src/contacts-linking.vala"
					_data_->_tmp79_ = _data_->new_values;
#line 285 "../src/contacts-linking.vala"
					_data_->_tmp80_ = _data_->proto2;
#line 285 "../src/contacts-linking.vala"
					_data_->_tmp81_ = _data_->detail2;
#line 285 "../src/contacts-linking.vala"
					gee_multi_map_set ((GeeMultiMap*) _data_->_tmp79_, _data_->_tmp80_, _data_->_tmp81_);
#line 283 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->detail2);
#line 4246 "contacts-linking.c"
				}
#line 283 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_detail2_it);
#line 4250 "contacts-linking.c"
			}
#line 282 "../src/contacts-linking.vala"
			_g_free0 (_data_->proto2);
#line 4254 "contacts-linking.c"
		}
#line 282 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_proto2_it);
#line 4258 "contacts-linking.c"
	}
#line 289 "../src/contacts-linking.vala"
	if (_data_->changed) {
#line 4262 "contacts-linking.c"
		{
#line 291 "../src/contacts-linking.vala"
			_data_->_tmp82_ = _data_->details;
#line 291 "../src/contacts-linking.vala"
			_data_->_tmp83_ = folks_im_details_get_im_addresses (_data_->_tmp82_);
#line 291 "../src/contacts-linking.vala"
			_data_->_tmp84_ = _data_->_tmp83_;
#line 291 "../src/contacts-linking.vala"
			_data_->_tmp85_ = _g_object_ref0 (_data_->_tmp84_);
#line 291 "../src/contacts-linking.vala"
			_data_->old_value = _data_->_tmp85_;
#line 292 "../src/contacts-linking.vala"
			_data_->_tmp86_ = _data_->details;
#line 292 "../src/contacts-linking.vala"
			_data_->_tmp87_ = _data_->new_values;
#line 292 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 292 "../src/contacts-linking.vala"
			folks_im_details_change_im_addresses (_data_->_tmp86_, (GeeMultiMap*) _data_->_tmp87_, contacts_persona_attribute_im_address_persona_apply_attributes_ready, _data_);
#line 292 "../src/contacts-linking.vala"
			return FALSE;
#line 4284 "contacts-linking.c"
			_state_1:
#line 292 "../src/contacts-linking.vala"
			folks_im_details_change_im_addresses_finish (_data_->_tmp86_, _data_->_res_, &_data_->_inner_error0_);
#line 292 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 292 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->old_value);
#line 4292 "contacts-linking.c"
				goto __catch17_g_error;
			}
#line 293 "../src/contacts-linking.vala"
			_data_->_tmp88_ = _data_->old_value;
#line 293 "../src/contacts-linking.vala"
			contacts_link_operation_add_change (_data_->operation, (ContactsPersonaAttribute*) _data_->self, _data_->persona, (GObject*) _data_->_tmp88_);
#line 290 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->old_value);
#line 4301 "contacts-linking.c"
		}
		goto __finally17;
		__catch17_g_error:
		{
#line 290 "../src/contacts-linking.vala"
			_data_->e = _data_->_inner_error0_;
#line 290 "../src/contacts-linking.vala"
			_data_->_inner_error0_ = NULL;
#line 295 "../src/contacts-linking.vala"
			_data_->_tmp89_ = _data_->e;
#line 295 "../src/contacts-linking.vala"
			_data_->_tmp90_ = _data_->_tmp89_->message;
#line 295 "../src/contacts-linking.vala"
			g_warning ("contacts-linking.vala:295: Unable to set im address when linking: %s\n", _data_->_tmp90_);
#line 290 "../src/contacts-linking.vala"
			_g_error_free0 (_data_->e);
#line 4318 "contacts-linking.c"
		}
		__finally17:
#line 290 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 290 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->new_values);
#line 290 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->removed_values);
#line 290 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->added_values);
#line 290 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->details);
#line 290 "../src/contacts-linking.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 290 "../src/contacts-linking.vala"
			g_clear_error (&_data_->_inner_error0_);
#line 290 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 290 "../src/contacts-linking.vala"
			return FALSE;
#line 4339 "contacts-linking.c"
		}
	}
#line 242 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->new_values);
#line 242 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_values);
#line 242 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_values);
#line 242 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->details);
#line 242 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 242 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 242 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 242 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 4358 "contacts-linking.c"
		}
	}
#line 242 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 242 "../src/contacts-linking.vala"
	return FALSE;
#line 4365 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_real_set_value_data_free (gpointer _data)
{
	ContactsPersonaAttributeImAddressSetValueData* _data_;
	_data_ = _data;
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->value);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 220 "../src/contacts-linking.vala"
	g_slice_free (ContactsPersonaAttributeImAddressSetValueData, _data_);
#line 4381 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_real_set_value (ContactsPersonaAttribute* base,
                                                      FolksPersona* persona,
                                                      GObject* value,
                                                      GAsyncReadyCallback _callback_,
                                                      gpointer _user_data_)
{
	ContactsPersonaAttributeImAddress * self;
	ContactsPersonaAttributeImAddressSetValueData* _data_;
	ContactsPersonaAttributeImAddress* _tmp0_;
	FolksPersona* _tmp1_;
	GObject* _tmp2_;
#line 220 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeImAddress*) base;
#line 220 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsPersonaAttributeImAddressSetValueData);
#line 220 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 220 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_persona_attribute_im_address_real_set_value_data_free);
#line 220 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 220 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 220 "../src/contacts-linking.vala"
	_tmp1_ = _g_object_ref0 (persona);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 220 "../src/contacts-linking.vala"
	_data_->persona = _tmp1_;
#line 220 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (value);
#line 220 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->value);
#line 220 "../src/contacts-linking.vala"
	_data_->value = _tmp2_;
#line 220 "../src/contacts-linking.vala"
	contacts_persona_attribute_im_address_real_set_value_co (_data_);
#line 4422 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_set_value_finish (ContactsPersonaAttribute* base,
                                                        GAsyncResult* _res_)
{
	ContactsPersonaAttributeImAddressSetValueData* _data_;
#line 220 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 4432 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_set_value_ready (GObject* source_object,
                                                       GAsyncResult* _res_,
                                                       gpointer _user_data_)
{
	ContactsPersonaAttributeImAddressSetValueData* _data_;
#line 307 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 307 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 307 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 307 "../src/contacts-linking.vala"
	contacts_persona_attribute_im_address_real_set_value_co (_data_);
#line 4449 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_im_address_real_set_value_co (ContactsPersonaAttributeImAddressSetValueData* _data_)
{
#line 300 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 300 "../src/contacts-linking.vala"
		case 0:
#line 4459 "contacts-linking.c"
		goto _state_0;
#line 300 "../src/contacts-linking.vala"
		case 1:
#line 4463 "contacts-linking.c"
		goto _state_1;
		default:
#line 300 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 4468 "contacts-linking.c"
	}
	_state_0:
#line 301 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->persona, FOLKS_TYPE_IM_DETAILS) ? ((FolksImDetails*) _data_->persona) : NULL);
#line 301 "../src/contacts-linking.vala"
	_data_->details = _data_->_tmp0_;
#line 302 "../src/contacts-linking.vala"
	_data_->_tmp1_ = _data_->details;
#line 302 "../src/contacts-linking.vala"
	if (_data_->_tmp1_ == NULL) {
#line 303 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 303 "../src/contacts-linking.vala"
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 303 "../src/contacts-linking.vala"
		if (_data_->_state_ != 0) {
#line 303 "../src/contacts-linking.vala"
			while (!g_task_get_completed (_data_->_async_result)) {
#line 303 "../src/contacts-linking.vala"
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 4489 "contacts-linking.c"
			}
		}
#line 303 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 303 "../src/contacts-linking.vala"
		return FALSE;
#line 4496 "contacts-linking.c"
	}
	{
#line 306 "../src/contacts-linking.vala"
		_data_->_tmp2_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->value, GEE_TYPE_HASH_MULTI_MAP) ? ((GeeHashMultiMap*) _data_->value) : NULL);
#line 306 "../src/contacts-linking.vala"
		_data_->v = _data_->_tmp2_;
#line 307 "../src/contacts-linking.vala"
		_data_->_tmp3_ = _data_->details;
#line 307 "../src/contacts-linking.vala"
		_data_->_tmp4_ = _data_->v;
#line 307 "../src/contacts-linking.vala"
		_data_->_state_ = 1;
#line 307 "../src/contacts-linking.vala"
		folks_im_details_change_im_addresses (_data_->_tmp3_, (GeeMultiMap*) _data_->_tmp4_, contacts_persona_attribute_im_address_set_value_ready, _data_);
#line 307 "../src/contacts-linking.vala"
		return FALSE;
#line 4513 "contacts-linking.c"
		_state_1:
#line 307 "../src/contacts-linking.vala"
		folks_im_details_change_im_addresses_finish (_data_->_tmp3_, _data_->_res_, &_data_->_inner_error0_);
#line 307 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 307 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->v);
#line 4521 "contacts-linking.c"
			goto __catch18_g_error;
		}
#line 305 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->v);
#line 4526 "contacts-linking.c"
	}
	goto __finally18;
	__catch18_g_error:
	{
#line 305 "../src/contacts-linking.vala"
		_data_->e = _data_->_inner_error0_;
#line 305 "../src/contacts-linking.vala"
		_data_->_inner_error0_ = NULL;
#line 309 "../src/contacts-linking.vala"
		_data_->_tmp5_ = _data_->e;
#line 309 "../src/contacts-linking.vala"
		_data_->_tmp6_ = _data_->_tmp5_->message;
#line 309 "../src/contacts-linking.vala"
		g_warning ("contacts-linking.vala:309: Unable to set local ids when undoing link: " \
"%s\n", _data_->_tmp6_);
#line 305 "../src/contacts-linking.vala"
		_g_error_free0 (_data_->e);
#line 4543 "contacts-linking.c"
	}
	__finally18:
#line 305 "../src/contacts-linking.vala"
	if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 305 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 305 "../src/contacts-linking.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 305 "../src/contacts-linking.vala"
		g_clear_error (&_data_->_inner_error0_);
#line 305 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 305 "../src/contacts-linking.vala"
		return FALSE;
#line 4558 "contacts-linking.c"
	}
#line 300 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->details);
#line 300 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 300 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 300 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 300 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 4570 "contacts-linking.c"
		}
	}
#line 300 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 300 "../src/contacts-linking.vala"
	return FALSE;
#line 4577 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_im_address_real_equal (ContactsPersonaAttribute* base,
                                                  ContactsPersonaAttribute* _that)
{
	ContactsPersonaAttributeImAddress * self;
	ContactsPersonaAttributeImAddress* that = NULL;
	ContactsPersonaAttributeImAddress* _tmp0_;
	gboolean _tmp1_ = FALSE;
	gboolean _tmp2_ = FALSE;
	gboolean _tmp3_ = FALSE;
	ContactsPersonaAttributeImAddress* _tmp4_;
	gboolean result = FALSE;
#line 313 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeImAddress*) base;
#line 313 "../src/contacts-linking.vala"
	g_return_val_if_fail (_that != NULL, FALSE);
#line 314 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (CONTACTS_IS_PERSONA_ATTRIBUTE_IM_ADDRESS (_that) ? ((ContactsPersonaAttributeImAddress*) _that) : NULL);
#line 314 "../src/contacts-linking.vala"
	that = _tmp0_;
#line 316 "../src/contacts-linking.vala"
	_tmp4_ = that;
#line 316 "../src/contacts-linking.vala"
	if (_tmp4_ != NULL) {
#line 4604 "contacts-linking.c"
		ContactsPersonaAttributeImAddress* _tmp5_;
#line 317 "../src/contacts-linking.vala"
		_tmp5_ = that;
#line 317 "../src/contacts-linking.vala"
		_tmp3_ = CONTACTS_PERSONA_ATTRIBUTE_CLASS (contacts_persona_attribute_im_address_parent_class)->equal (G_TYPE_CHECK_INSTANCE_CAST (self, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute), (ContactsPersonaAttribute*) _tmp5_);
#line 4610 "contacts-linking.c"
	} else {
#line 316 "../src/contacts-linking.vala"
		_tmp3_ = FALSE;
#line 4614 "contacts-linking.c"
	}
#line 316 "../src/contacts-linking.vala"
	if (_tmp3_) {
#line 4618 "contacts-linking.c"
		const gchar* _tmp6_;
		ContactsPersonaAttributeImAddress* _tmp7_;
		const gchar* _tmp8_;
#line 318 "../src/contacts-linking.vala"
		_tmp6_ = self->priv->protocol;
#line 318 "../src/contacts-linking.vala"
		_tmp7_ = that;
#line 318 "../src/contacts-linking.vala"
		_tmp8_ = _tmp7_->priv->protocol;
#line 318 "../src/contacts-linking.vala"
		_tmp2_ = g_strcmp0 (_tmp6_, _tmp8_) == 0;
#line 4630 "contacts-linking.c"
	} else {
#line 316 "../src/contacts-linking.vala"
		_tmp2_ = FALSE;
#line 4634 "contacts-linking.c"
	}
#line 316 "../src/contacts-linking.vala"
	if (_tmp2_) {
#line 4638 "contacts-linking.c"
		FolksImFieldDetails* _tmp9_;
		ContactsPersonaAttributeImAddress* _tmp10_;
		FolksImFieldDetails* _tmp11_;
#line 319 "../src/contacts-linking.vala"
		_tmp9_ = self->priv->detail;
#line 319 "../src/contacts-linking.vala"
		_tmp10_ = that;
#line 319 "../src/contacts-linking.vala"
		_tmp11_ = _tmp10_->priv->detail;
#line 319 "../src/contacts-linking.vala"
		_tmp1_ = folks_abstract_field_details_equal ((FolksAbstractFieldDetails*) _tmp9_, (FolksAbstractFieldDetails*) _tmp11_);
#line 4650 "contacts-linking.c"
	} else {
#line 316 "../src/contacts-linking.vala"
		_tmp1_ = FALSE;
#line 4654 "contacts-linking.c"
	}
#line 315 "../src/contacts-linking.vala"
	result = _tmp1_;
#line 315 "../src/contacts-linking.vala"
	_g_object_unref0 (that);
#line 315 "../src/contacts-linking.vala"
	return result;
#line 4662 "contacts-linking.c"
}

static guint
contacts_persona_attribute_im_address_real_hash (ContactsPersonaAttribute* base)
{
	ContactsPersonaAttributeImAddress * self;
	const gchar* _tmp0_;
	FolksImFieldDetails* _tmp1_;
	guint result = 0U;
#line 322 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeImAddress*) base;
#line 323 "../src/contacts-linking.vala"
	_tmp0_ = self->priv->protocol;
#line 323 "../src/contacts-linking.vala"
	_tmp1_ = self->priv->detail;
#line 323 "../src/contacts-linking.vala"
	result = (g_str_hash (_tmp0_) ^ folks_abstract_field_details_hash ((FolksAbstractFieldDetails*) _tmp1_)) ^ CONTACTS_PERSONA_ATTRIBUTE_CLASS (contacts_persona_attribute_im_address_parent_class)->hash (G_TYPE_CHECK_INSTANCE_CAST (self, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute));
#line 323 "../src/contacts-linking.vala"
	return result;
#line 4682 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_class_init (ContactsPersonaAttributeImAddressClass * klass,
                                                  gpointer klass_data)
{
#line 220 "../src/contacts-linking.vala"
	contacts_persona_attribute_im_address_parent_class = g_type_class_peek_parent (klass);
#line 220 "../src/contacts-linking.vala"
	g_type_class_adjust_private_offset (klass, &ContactsPersonaAttributeImAddress_private_offset);
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->to_string = (gchar* (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_im_address_real_to_string;
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->is_referenced_by_persona = (gboolean (*) (ContactsPersonaAttribute*, FolksPersona*)) contacts_persona_attribute_im_address_real_is_referenced_by_persona;
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->persona_apply_attributes = (void (*) (ContactsPersonaAttribute*, FolksPersona*, GeeSet*, GeeSet*, ContactsLinkOperation*, GAsyncReadyCallback, gpointer)) contacts_persona_attribute_im_address_real_persona_apply_attributes;
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->persona_apply_attributes_finish = (void (*) (ContactsPersonaAttribute*, GAsyncResult*)) contacts_persona_attribute_im_address_persona_apply_attributes_finish;
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->set_value = (void (*) (ContactsPersonaAttribute*, FolksPersona*, GObject*, GAsyncReadyCallback, gpointer)) contacts_persona_attribute_im_address_real_set_value;
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->set_value_finish = (void (*) (ContactsPersonaAttribute*, GAsyncResult*)) contacts_persona_attribute_im_address_set_value_finish;
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->equal = (gboolean (*) (ContactsPersonaAttribute*, ContactsPersonaAttribute*)) contacts_persona_attribute_im_address_real_equal;
#line 220 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->hash = (guint (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_im_address_real_hash;
#line 220 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_persona_attribute_im_address_finalize;
#line 4711 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_instance_init (ContactsPersonaAttributeImAddress * self,
                                                     gpointer klass)
{
#line 220 "../src/contacts-linking.vala"
	self->priv = contacts_persona_attribute_im_address_get_instance_private (self);
#line 4720 "contacts-linking.c"
}

static void
contacts_persona_attribute_im_address_finalize (GObject * obj)
{
	ContactsPersonaAttributeImAddress * self;
#line 220 "../src/contacts-linking.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_PERSONA_ATTRIBUTE_IM_ADDRESS, ContactsPersonaAttributeImAddress);
#line 221 "../src/contacts-linking.vala"
	_g_free0 (self->priv->protocol);
#line 222 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->detail);
#line 220 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (contacts_persona_attribute_im_address_parent_class)->finalize (obj);
#line 4735 "contacts-linking.c"
}

static GType
contacts_persona_attribute_im_address_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsPersonaAttributeImAddressClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_persona_attribute_im_address_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsPersonaAttributeImAddress), 0, (GInstanceInitFunc) contacts_persona_attribute_im_address_instance_init, NULL };
	GType contacts_persona_attribute_im_address_type_id;
	contacts_persona_attribute_im_address_type_id = g_type_register_static (CONTACTS_TYPE_PERSONA_ATTRIBUTE, "ContactsPersonaAttributeImAddress", &g_define_type_info, 0);
	ContactsPersonaAttributeImAddress_private_offset = g_type_add_instance_private (contacts_persona_attribute_im_address_type_id, sizeof (ContactsPersonaAttributeImAddressPrivate));
	return contacts_persona_attribute_im_address_type_id;
}

GType
contacts_persona_attribute_im_address_get_type (void)
{
	static volatile gsize contacts_persona_attribute_im_address_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_persona_attribute_im_address_type_id__volatile)) {
		GType contacts_persona_attribute_im_address_type_id;
		contacts_persona_attribute_im_address_type_id = contacts_persona_attribute_im_address_get_type_once ();
		g_once_init_leave (&contacts_persona_attribute_im_address_type_id__volatile, contacts_persona_attribute_im_address_type_id);
	}
	return contacts_persona_attribute_im_address_type_id__volatile;
}

static inline gpointer
contacts_persona_attribute_web_service_get_instance_private (ContactsPersonaAttributeWebService* self)
{
	return G_STRUCT_MEMBER_P (self, ContactsPersonaAttributeWebService_private_offset);
}

ContactsPersonaAttributeWebService*
contacts_persona_attribute_web_service_construct (GType object_type,
                                                  const gchar* service,
                                                  FolksWebServiceFieldDetails* detail)
{
	ContactsPersonaAttributeWebService * self = NULL;
	gchar* _tmp0_;
	gchar* _tmp1_;
	FolksWebServiceFieldDetails* _tmp2_;
#line 331 "../src/contacts-linking.vala"
	g_return_val_if_fail (service != NULL, NULL);
#line 331 "../src/contacts-linking.vala"
	g_return_val_if_fail (detail != NULL, NULL);
#line 331 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeWebService*) contacts_persona_attribute_construct (object_type);
#line 332 "../src/contacts-linking.vala"
	_tmp0_ = g_strdup ("web-service-addresses");
#line 332 "../src/contacts-linking.vala"
	_g_free0 (((ContactsPersonaAttribute*) self)->property_name);
#line 332 "../src/contacts-linking.vala"
	((ContactsPersonaAttribute*) self)->property_name = _tmp0_;
#line 333 "../src/contacts-linking.vala"
	_tmp1_ = g_strdup (service);
#line 333 "../src/contacts-linking.vala"
	_g_free0 (self->priv->service);
#line 333 "../src/contacts-linking.vala"
	self->priv->service = _tmp1_;
#line 334 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (detail);
#line 334 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->detail);
#line 334 "../src/contacts-linking.vala"
	self->priv->detail = _tmp2_;
#line 331 "../src/contacts-linking.vala"
	return self;
#line 4801 "contacts-linking.c"
}

ContactsPersonaAttributeWebService*
contacts_persona_attribute_web_service_new (const gchar* service,
                                            FolksWebServiceFieldDetails* detail)
{
#line 331 "../src/contacts-linking.vala"
	return contacts_persona_attribute_web_service_construct (CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, service, detail);
#line 4810 "contacts-linking.c"
}

static gchar*
contacts_persona_attribute_web_service_real_to_string (ContactsPersonaAttribute* base)
{
	ContactsPersonaAttributeWebService * self;
	const gchar* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	FolksWebServiceFieldDetails* _tmp5_;
	gconstpointer _tmp6_;
	const gchar* _tmp7_;
	gchar* _tmp8_;
	gchar* _tmp9_;
	gchar* result = NULL;
#line 337 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeWebService*) base;
#line 338 "../src/contacts-linking.vala"
	_tmp0_ = self->priv->service;
#line 338 "../src/contacts-linking.vala"
	_tmp1_ = g_strconcat ("web_service_addresses: ", _tmp0_, NULL);
#line 338 "../src/contacts-linking.vala"
	_tmp2_ = _tmp1_;
#line 338 "../src/contacts-linking.vala"
	_tmp3_ = g_strconcat (_tmp2_, ":", NULL);
#line 338 "../src/contacts-linking.vala"
	_tmp4_ = _tmp3_;
#line 338 "../src/contacts-linking.vala"
	_tmp5_ = self->priv->detail;
#line 338 "../src/contacts-linking.vala"
	_tmp6_ = folks_abstract_field_details_get_value ((FolksAbstractFieldDetails*) _tmp5_);
#line 338 "../src/contacts-linking.vala"
	_tmp7_ = _tmp6_;
#line 338 "../src/contacts-linking.vala"
	_tmp8_ = g_strconcat (_tmp4_, (const gchar*) _tmp7_, NULL);
#line 338 "../src/contacts-linking.vala"
	_tmp9_ = _tmp8_;
#line 338 "../src/contacts-linking.vala"
	_g_free0 (_tmp4_);
#line 338 "../src/contacts-linking.vala"
	_g_free0 (_tmp2_);
#line 338 "../src/contacts-linking.vala"
	result = _tmp9_;
#line 338 "../src/contacts-linking.vala"
	return result;
#line 4858 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_web_service_real_is_referenced_by_persona (ContactsPersonaAttribute* base,
                                                                      FolksPersona* persona)
{
	ContactsPersonaAttributeWebService * self;
	FolksWebServiceDetails* details = NULL;
	FolksWebServiceDetails* _tmp0_;
	FolksWebServiceDetails* _tmp1_;
	FolksWebServiceDetails* _tmp2_;
	GeeMultiMap* _tmp3_;
	GeeMultiMap* _tmp4_;
	const gchar* _tmp5_;
	GeeCollection* _tmp6_;
	GeeCollection* _tmp7_;
	FolksWebServiceFieldDetails* _tmp8_;
	gboolean _tmp9_;
	gboolean result = FALSE;
#line 341 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeWebService*) base;
#line 341 "../src/contacts-linking.vala"
	g_return_val_if_fail (persona != NULL, FALSE);
#line 342 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (persona, FOLKS_TYPE_WEB_SERVICE_DETAILS) ? ((FolksWebServiceDetails*) persona) : NULL);
#line 342 "../src/contacts-linking.vala"
	details = _tmp0_;
#line 343 "../src/contacts-linking.vala"
	_tmp1_ = details;
#line 343 "../src/contacts-linking.vala"
	if (_tmp1_ == NULL) {
#line 344 "../src/contacts-linking.vala"
		result = FALSE;
#line 344 "../src/contacts-linking.vala"
		_g_object_unref0 (details);
#line 344 "../src/contacts-linking.vala"
		return result;
#line 4896 "contacts-linking.c"
	}
#line 346 "../src/contacts-linking.vala"
	_tmp2_ = details;
#line 346 "../src/contacts-linking.vala"
	_tmp3_ = folks_web_service_details_get_web_service_addresses (_tmp2_);
#line 346 "../src/contacts-linking.vala"
	_tmp4_ = _tmp3_;
#line 346 "../src/contacts-linking.vala"
	_tmp5_ = self->priv->service;
#line 346 "../src/contacts-linking.vala"
	_tmp6_ = gee_multi_map_get (_tmp4_, _tmp5_);
#line 346 "../src/contacts-linking.vala"
	_tmp7_ = _tmp6_;
#line 346 "../src/contacts-linking.vala"
	_tmp8_ = self->priv->detail;
#line 346 "../src/contacts-linking.vala"
	_tmp9_ = gee_collection_contains (_tmp7_, _tmp8_);
#line 346 "../src/contacts-linking.vala"
	_g_object_unref0 (_tmp7_);
#line 346 "../src/contacts-linking.vala"
	result = _tmp9_;
#line 346 "../src/contacts-linking.vala"
	_g_object_unref0 (details);
#line 346 "../src/contacts-linking.vala"
	return result;
#line 4922 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_real_persona_apply_attributes_data_free (gpointer _data)
{
	ContactsPersonaAttributeWebServicePersonaApplyAttributesData* _data_;
	_data_ = _data;
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_attributes);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_attributes);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->operation);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 327 "../src/contacts-linking.vala"
	g_slice_free (ContactsPersonaAttributeWebServicePersonaApplyAttributesData, _data_);
#line 4942 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_real_persona_apply_attributes (ContactsPersonaAttribute* base,
                                                                      FolksPersona* persona,
                                                                      GeeSet* added_attributes,
                                                                      GeeSet* removed_attributes,
                                                                      ContactsLinkOperation* operation,
                                                                      GAsyncReadyCallback _callback_,
                                                                      gpointer _user_data_)
{
	ContactsPersonaAttributeWebService * self;
	ContactsPersonaAttributeWebServicePersonaApplyAttributesData* _data_;
	ContactsPersonaAttributeWebService* _tmp0_;
	FolksPersona* _tmp1_;
	GeeSet* _tmp2_;
	GeeSet* _tmp3_;
	ContactsLinkOperation* _tmp4_;
#line 327 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeWebService*) base;
#line 327 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsPersonaAttributeWebServicePersonaApplyAttributesData);
#line 327 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 327 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_persona_attribute_web_service_real_persona_apply_attributes_data_free);
#line 327 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 327 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 327 "../src/contacts-linking.vala"
	_tmp1_ = _g_object_ref0 (persona);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 327 "../src/contacts-linking.vala"
	_data_->persona = _tmp1_;
#line 327 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (added_attributes);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_attributes);
#line 327 "../src/contacts-linking.vala"
	_data_->added_attributes = _tmp2_;
#line 327 "../src/contacts-linking.vala"
	_tmp3_ = _g_object_ref0 (removed_attributes);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_attributes);
#line 327 "../src/contacts-linking.vala"
	_data_->removed_attributes = _tmp3_;
#line 327 "../src/contacts-linking.vala"
	_tmp4_ = _g_object_ref0 (operation);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->operation);
#line 327 "../src/contacts-linking.vala"
	_data_->operation = _tmp4_;
#line 327 "../src/contacts-linking.vala"
	contacts_persona_attribute_web_service_real_persona_apply_attributes_co (_data_);
#line 4999 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_persona_apply_attributes_finish (ContactsPersonaAttribute* base,
                                                                        GAsyncResult* _res_)
{
	ContactsPersonaAttributeWebServicePersonaApplyAttributesData* _data_;
#line 327 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 5009 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_persona_apply_attributes_ready (GObject* source_object,
                                                                       GAsyncResult* _res_,
                                                                       gpointer _user_data_)
{
	ContactsPersonaAttributeWebServicePersonaApplyAttributesData* _data_;
#line 398 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 398 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 398 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 398 "../src/contacts-linking.vala"
	contacts_persona_attribute_web_service_real_persona_apply_attributes_co (_data_);
#line 5026 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_web_service_real_persona_apply_attributes_co (ContactsPersonaAttributeWebServicePersonaApplyAttributesData* _data_)
{
#line 349 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 349 "../src/contacts-linking.vala"
		case 0:
#line 5036 "contacts-linking.c"
		goto _state_0;
#line 349 "../src/contacts-linking.vala"
		case 1:
#line 5040 "contacts-linking.c"
		goto _state_1;
		default:
#line 349 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 5045 "contacts-linking.c"
	}
	_state_0:
#line 353 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->persona, FOLKS_TYPE_WEB_SERVICE_DETAILS) ? ((FolksWebServiceDetails*) _data_->persona) : NULL);
#line 353 "../src/contacts-linking.vala"
	_data_->details = _data_->_tmp0_;
#line 354 "../src/contacts-linking.vala"
	_data_->_tmp1_ = _data_->details;
#line 354 "../src/contacts-linking.vala"
	if (_data_->_tmp1_ == NULL) {
#line 355 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 355 "../src/contacts-linking.vala"
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 355 "../src/contacts-linking.vala"
		if (_data_->_state_ != 0) {
#line 355 "../src/contacts-linking.vala"
			while (!g_task_get_completed (_data_->_async_result)) {
#line 355 "../src/contacts-linking.vala"
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 5066 "contacts-linking.c"
			}
		}
#line 355 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 355 "../src/contacts-linking.vala"
		return FALSE;
#line 5073 "contacts-linking.c"
	}
#line 357 "../src/contacts-linking.vala"
	_data_->_tmp2_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, FOLKS_TYPE_WEB_SERVICE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
#line 357 "../src/contacts-linking.vala"
	_data_->added_values = _data_->_tmp2_;
#line 5079 "contacts-linking.c"
	{
#line 360 "../src/contacts-linking.vala"
		_data_->_tmp3_ = gee_iterable_iterator ((GeeIterable*) _data_->added_attributes);
#line 360 "../src/contacts-linking.vala"
		_data_->_added_it = _data_->_tmp3_;
#line 360 "../src/contacts-linking.vala"
		while (TRUE) {
#line 360 "../src/contacts-linking.vala"
			_data_->_tmp4_ = _data_->_added_it;
#line 360 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp4_)) {
#line 360 "../src/contacts-linking.vala"
				break;
#line 5093 "contacts-linking.c"
			}
#line 360 "../src/contacts-linking.vala"
			_data_->_tmp5_ = _data_->_added_it;
#line 360 "../src/contacts-linking.vala"
			_data_->_tmp6_ = gee_iterator_get (_data_->_tmp5_);
#line 360 "../src/contacts-linking.vala"
			_data_->added = (ContactsPersonaAttribute*) _data_->_tmp6_;
#line 361 "../src/contacts-linking.vala"
			_data_->_tmp7_ = _data_->added_values;
#line 361 "../src/contacts-linking.vala"
			_data_->_tmp8_ = _data_->added;
#line 361 "../src/contacts-linking.vala"
			_data_->_tmp9_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp8_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebService)->priv->service;
#line 361 "../src/contacts-linking.vala"
			_data_->_tmp10_ = _data_->added;
#line 361 "../src/contacts-linking.vala"
			_data_->_tmp11_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp10_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebService)->priv->detail;
#line 361 "../src/contacts-linking.vala"
			gee_multi_map_set ((GeeMultiMap*) _data_->_tmp7_, _data_->_tmp9_, _data_->_tmp11_);
#line 360 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->added);
#line 5115 "contacts-linking.c"
		}
#line 360 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_added_it);
#line 5119 "contacts-linking.c"
	}
#line 364 "../src/contacts-linking.vala"
	_data_->_tmp12_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, FOLKS_TYPE_WEB_SERVICE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
#line 364 "../src/contacts-linking.vala"
	_data_->removed_values = _data_->_tmp12_;
#line 5125 "contacts-linking.c"
	{
#line 367 "../src/contacts-linking.vala"
		_data_->_tmp13_ = gee_iterable_iterator ((GeeIterable*) _data_->removed_attributes);
#line 367 "../src/contacts-linking.vala"
		_data_->_removed_it = _data_->_tmp13_;
#line 367 "../src/contacts-linking.vala"
		while (TRUE) {
#line 367 "../src/contacts-linking.vala"
			_data_->_tmp14_ = _data_->_removed_it;
#line 367 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp14_)) {
#line 367 "../src/contacts-linking.vala"
				break;
#line 5139 "contacts-linking.c"
			}
#line 367 "../src/contacts-linking.vala"
			_data_->_tmp15_ = _data_->_removed_it;
#line 367 "../src/contacts-linking.vala"
			_data_->_tmp16_ = gee_iterator_get (_data_->_tmp15_);
#line 367 "../src/contacts-linking.vala"
			_data_->removed = (ContactsPersonaAttribute*) _data_->_tmp16_;
#line 368 "../src/contacts-linking.vala"
			_data_->_tmp17_ = _data_->removed_values;
#line 368 "../src/contacts-linking.vala"
			_data_->_tmp18_ = _data_->removed;
#line 368 "../src/contacts-linking.vala"
			_data_->_tmp19_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp18_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebService)->priv->service;
#line 368 "../src/contacts-linking.vala"
			_data_->_tmp20_ = _data_->removed;
#line 368 "../src/contacts-linking.vala"
			_data_->_tmp21_ = G_TYPE_CHECK_INSTANCE_CAST (_data_->_tmp20_, CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebService)->priv->detail;
#line 368 "../src/contacts-linking.vala"
			gee_multi_map_set ((GeeMultiMap*) _data_->_tmp17_, _data_->_tmp19_, _data_->_tmp21_);
#line 367 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->removed);
#line 5161 "contacts-linking.c"
		}
#line 367 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_removed_it);
#line 5165 "contacts-linking.c"
	}
#line 371 "../src/contacts-linking.vala"
	_data_->_tmp22_ = gee_hash_multi_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, FOLKS_TYPE_WEB_SERVICE_FIELD_DETAILS, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, _folks_abstract_field_details_hash_static_gee_hash_data_func, NULL, NULL, _folks_abstract_field_details_equal_static_gee_equal_data_func, NULL, NULL);
#line 371 "../src/contacts-linking.vala"
	_data_->new_values = _data_->_tmp22_;
#line 375 "../src/contacts-linking.vala"
	_data_->changed = FALSE;
#line 5173 "contacts-linking.c"
	{
#line 376 "../src/contacts-linking.vala"
		_data_->_tmp23_ = _data_->details;
#line 376 "../src/contacts-linking.vala"
		_data_->_tmp24_ = folks_web_service_details_get_web_service_addresses (_data_->_tmp23_);
#line 376 "../src/contacts-linking.vala"
		_data_->_tmp25_ = _data_->_tmp24_;
#line 376 "../src/contacts-linking.vala"
		_data_->_tmp26_ = gee_multi_map_get_keys (_data_->_tmp25_);
#line 376 "../src/contacts-linking.vala"
		_data_->_tmp27_ = _data_->_tmp26_;
#line 376 "../src/contacts-linking.vala"
		_data_->_tmp28_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp27_);
#line 376 "../src/contacts-linking.vala"
		_data_->_tmp29_ = _data_->_tmp28_;
#line 376 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_tmp27_);
#line 376 "../src/contacts-linking.vala"
		_data_->_srv1_it = _data_->_tmp29_;
#line 376 "../src/contacts-linking.vala"
		while (TRUE) {
#line 376 "../src/contacts-linking.vala"
			_data_->_tmp30_ = _data_->_srv1_it;
#line 376 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp30_)) {
#line 376 "../src/contacts-linking.vala"
				break;
#line 5201 "contacts-linking.c"
			}
#line 376 "../src/contacts-linking.vala"
			_data_->_tmp31_ = _data_->_srv1_it;
#line 376 "../src/contacts-linking.vala"
			_data_->_tmp32_ = gee_iterator_get (_data_->_tmp31_);
#line 376 "../src/contacts-linking.vala"
			_data_->srv1 = (gchar*) _data_->_tmp32_;
#line 5209 "contacts-linking.c"
			{
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp33_ = _data_->details;
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp34_ = folks_web_service_details_get_web_service_addresses (_data_->_tmp33_);
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp35_ = _data_->_tmp34_;
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp36_ = _data_->srv1;
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp37_ = gee_multi_map_get (_data_->_tmp35_, _data_->_tmp36_);
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp38_ = _data_->_tmp37_;
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp39_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp38_);
#line 377 "../src/contacts-linking.vala"
				_data_->_tmp40_ = _data_->_tmp39_;
#line 377 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_tmp38_);
#line 377 "../src/contacts-linking.vala"
				_data_->_detail1_it = _data_->_tmp40_;
#line 377 "../src/contacts-linking.vala"
				while (TRUE) {
#line 377 "../src/contacts-linking.vala"
					_data_->_tmp41_ = _data_->_detail1_it;
#line 377 "../src/contacts-linking.vala"
					if (!gee_iterator_next (_data_->_tmp41_)) {
#line 377 "../src/contacts-linking.vala"
						break;
#line 5239 "contacts-linking.c"
					}
#line 377 "../src/contacts-linking.vala"
					_data_->_tmp42_ = _data_->_detail1_it;
#line 377 "../src/contacts-linking.vala"
					_data_->_tmp43_ = gee_iterator_get (_data_->_tmp42_);
#line 377 "../src/contacts-linking.vala"
					_data_->detail1 = (FolksWebServiceFieldDetails*) _data_->_tmp43_;
#line 378 "../src/contacts-linking.vala"
					_data_->_tmp44_ = _data_->removed_values;
#line 378 "../src/contacts-linking.vala"
					_data_->_tmp45_ = _data_->srv1;
#line 378 "../src/contacts-linking.vala"
					_data_->_tmp46_ = gee_multi_map_get ((GeeMultiMap*) _data_->_tmp44_, _data_->_tmp45_);
#line 378 "../src/contacts-linking.vala"
					_data_->_tmp47_ = _data_->_tmp46_;
#line 378 "../src/contacts-linking.vala"
					_data_->_tmp48_ = _data_->detail1;
#line 378 "../src/contacts-linking.vala"
					_data_->_tmp49_ = gee_collection_contains (_data_->_tmp47_, _data_->_tmp48_);
#line 378 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->_tmp47_);
#line 378 "../src/contacts-linking.vala"
					if (_data_->_tmp49_) {
#line 379 "../src/contacts-linking.vala"
						_data_->changed = TRUE;
#line 380 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->detail1);
#line 380 "../src/contacts-linking.vala"
						continue;
#line 5269 "contacts-linking.c"
					}
#line 382 "../src/contacts-linking.vala"
					_data_->_tmp50_ = _data_->new_values;
#line 382 "../src/contacts-linking.vala"
					_data_->_tmp51_ = _data_->srv1;
#line 382 "../src/contacts-linking.vala"
					_data_->_tmp52_ = _data_->detail1;
#line 382 "../src/contacts-linking.vala"
					gee_multi_map_set ((GeeMultiMap*) _data_->_tmp50_, _data_->_tmp51_, _data_->_tmp52_);
#line 383 "../src/contacts-linking.vala"
					_data_->_tmp53_ = _data_->added_values;
#line 383 "../src/contacts-linking.vala"
					_data_->_tmp54_ = _data_->srv1;
#line 383 "../src/contacts-linking.vala"
					_data_->_tmp55_ = gee_multi_map_get ((GeeMultiMap*) _data_->_tmp53_, _data_->_tmp54_);
#line 383 "../src/contacts-linking.vala"
					_data_->_tmp56_ = _data_->_tmp55_;
#line 383 "../src/contacts-linking.vala"
					_data_->_tmp57_ = _data_->detail1;
#line 383 "../src/contacts-linking.vala"
					_data_->_tmp58_ = gee_collection_contains (_data_->_tmp56_, _data_->_tmp57_);
#line 383 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->_tmp56_);
#line 383 "../src/contacts-linking.vala"
					if (_data_->_tmp58_) {
#line 384 "../src/contacts-linking.vala"
						_data_->_tmp59_ = _data_->added_values;
#line 384 "../src/contacts-linking.vala"
						_data_->_tmp60_ = _data_->srv1;
#line 384 "../src/contacts-linking.vala"
						_data_->_tmp61_ = _data_->detail1;
#line 384 "../src/contacts-linking.vala"
						gee_multi_map_remove ((GeeMultiMap*) _data_->_tmp59_, _data_->_tmp60_, _data_->_tmp61_);
#line 5303 "contacts-linking.c"
					}
#line 377 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->detail1);
#line 5307 "contacts-linking.c"
				}
#line 377 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_detail1_it);
#line 5311 "contacts-linking.c"
			}
#line 376 "../src/contacts-linking.vala"
			_g_free0 (_data_->srv1);
#line 5315 "contacts-linking.c"
		}
#line 376 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_srv1_it);
#line 5319 "contacts-linking.c"
	}
	{
#line 388 "../src/contacts-linking.vala"
		_data_->_tmp62_ = _data_->added_values;
#line 388 "../src/contacts-linking.vala"
		_data_->_tmp63_ = gee_multi_map_get_keys ((GeeMultiMap*) _data_->_tmp62_);
#line 388 "../src/contacts-linking.vala"
		_data_->_tmp64_ = _data_->_tmp63_;
#line 388 "../src/contacts-linking.vala"
		_data_->_tmp65_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp64_);
#line 388 "../src/contacts-linking.vala"
		_data_->_tmp66_ = _data_->_tmp65_;
#line 388 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_tmp64_);
#line 388 "../src/contacts-linking.vala"
		_data_->_srv2_it = _data_->_tmp66_;
#line 388 "../src/contacts-linking.vala"
		while (TRUE) {
#line 388 "../src/contacts-linking.vala"
			_data_->_tmp67_ = _data_->_srv2_it;
#line 388 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp67_)) {
#line 388 "../src/contacts-linking.vala"
				break;
#line 5344 "contacts-linking.c"
			}
#line 388 "../src/contacts-linking.vala"
			_data_->_tmp68_ = _data_->_srv2_it;
#line 388 "../src/contacts-linking.vala"
			_data_->_tmp69_ = gee_iterator_get (_data_->_tmp68_);
#line 388 "../src/contacts-linking.vala"
			_data_->srv2 = (gchar*) _data_->_tmp69_;
#line 5352 "contacts-linking.c"
			{
#line 389 "../src/contacts-linking.vala"
				_data_->_tmp70_ = _data_->added_values;
#line 389 "../src/contacts-linking.vala"
				_data_->_tmp71_ = _data_->srv2;
#line 389 "../src/contacts-linking.vala"
				_data_->_tmp72_ = gee_multi_map_get ((GeeMultiMap*) _data_->_tmp70_, _data_->_tmp71_);
#line 389 "../src/contacts-linking.vala"
				_data_->_tmp73_ = _data_->_tmp72_;
#line 389 "../src/contacts-linking.vala"
				_data_->_tmp74_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp73_);
#line 389 "../src/contacts-linking.vala"
				_data_->_tmp75_ = _data_->_tmp74_;
#line 389 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_tmp73_);
#line 389 "../src/contacts-linking.vala"
				_data_->_detail2_it = _data_->_tmp75_;
#line 389 "../src/contacts-linking.vala"
				while (TRUE) {
#line 389 "../src/contacts-linking.vala"
					_data_->_tmp76_ = _data_->_detail2_it;
#line 389 "../src/contacts-linking.vala"
					if (!gee_iterator_next (_data_->_tmp76_)) {
#line 389 "../src/contacts-linking.vala"
						break;
#line 5378 "contacts-linking.c"
					}
#line 389 "../src/contacts-linking.vala"
					_data_->_tmp77_ = _data_->_detail2_it;
#line 389 "../src/contacts-linking.vala"
					_data_->_tmp78_ = gee_iterator_get (_data_->_tmp77_);
#line 389 "../src/contacts-linking.vala"
					_data_->detail2 = (FolksWebServiceFieldDetails*) _data_->_tmp78_;
#line 390 "../src/contacts-linking.vala"
					_data_->changed = TRUE;
#line 391 "../src/contacts-linking.vala"
					_data_->_tmp79_ = _data_->new_values;
#line 391 "../src/contacts-linking.vala"
					_data_->_tmp80_ = _data_->srv2;
#line 391 "../src/contacts-linking.vala"
					_data_->_tmp81_ = _data_->detail2;
#line 391 "../src/contacts-linking.vala"
					gee_multi_map_set ((GeeMultiMap*) _data_->_tmp79_, _data_->_tmp80_, _data_->_tmp81_);
#line 389 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->detail2);
#line 5398 "contacts-linking.c"
				}
#line 389 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_detail2_it);
#line 5402 "contacts-linking.c"
			}
#line 388 "../src/contacts-linking.vala"
			_g_free0 (_data_->srv2);
#line 5406 "contacts-linking.c"
		}
#line 388 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_srv2_it);
#line 5410 "contacts-linking.c"
	}
#line 395 "../src/contacts-linking.vala"
	if (_data_->changed) {
#line 5414 "contacts-linking.c"
		{
#line 397 "../src/contacts-linking.vala"
			_data_->_tmp82_ = _data_->details;
#line 397 "../src/contacts-linking.vala"
			_data_->_tmp83_ = folks_web_service_details_get_web_service_addresses (_data_->_tmp82_);
#line 397 "../src/contacts-linking.vala"
			_data_->_tmp84_ = _data_->_tmp83_;
#line 397 "../src/contacts-linking.vala"
			_data_->_tmp85_ = _g_object_ref0 (_data_->_tmp84_);
#line 397 "../src/contacts-linking.vala"
			_data_->old_value = _data_->_tmp85_;
#line 398 "../src/contacts-linking.vala"
			_data_->_tmp86_ = _data_->details;
#line 398 "../src/contacts-linking.vala"
			_data_->_tmp87_ = _data_->new_values;
#line 398 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 398 "../src/contacts-linking.vala"
			folks_web_service_details_change_web_service_addresses (_data_->_tmp86_, (GeeMultiMap*) _data_->_tmp87_, contacts_persona_attribute_web_service_persona_apply_attributes_ready, _data_);
#line 398 "../src/contacts-linking.vala"
			return FALSE;
#line 5436 "contacts-linking.c"
			_state_1:
#line 398 "../src/contacts-linking.vala"
			folks_web_service_details_change_web_service_addresses_finish (_data_->_tmp86_, _data_->_res_, &_data_->_inner_error0_);
#line 398 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 398 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->old_value);
#line 5444 "contacts-linking.c"
				goto __catch19_g_error;
			}
#line 399 "../src/contacts-linking.vala"
			_data_->_tmp88_ = _data_->old_value;
#line 399 "../src/contacts-linking.vala"
			contacts_link_operation_add_change (_data_->operation, (ContactsPersonaAttribute*) _data_->self, _data_->persona, (GObject*) _data_->_tmp88_);
#line 396 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->old_value);
#line 5453 "contacts-linking.c"
		}
		goto __finally19;
		__catch19_g_error:
		{
#line 396 "../src/contacts-linking.vala"
			_data_->e = _data_->_inner_error0_;
#line 396 "../src/contacts-linking.vala"
			_data_->_inner_error0_ = NULL;
#line 401 "../src/contacts-linking.vala"
			_data_->_tmp89_ = _data_->e;
#line 401 "../src/contacts-linking.vala"
			_data_->_tmp90_ = _data_->_tmp89_->message;
#line 401 "../src/contacts-linking.vala"
			g_warning ("contacts-linking.vala:401: Unable to set web service when linking: %s\n", _data_->_tmp90_);
#line 396 "../src/contacts-linking.vala"
			_g_error_free0 (_data_->e);
#line 5470 "contacts-linking.c"
		}
		__finally19:
#line 396 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 396 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->new_values);
#line 396 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->removed_values);
#line 396 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->added_values);
#line 396 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->details);
#line 396 "../src/contacts-linking.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 396 "../src/contacts-linking.vala"
			g_clear_error (&_data_->_inner_error0_);
#line 396 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 396 "../src/contacts-linking.vala"
			return FALSE;
#line 5491 "contacts-linking.c"
		}
	}
#line 349 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->new_values);
#line 349 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->removed_values);
#line 349 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->added_values);
#line 349 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->details);
#line 349 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 349 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 349 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 349 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 5510 "contacts-linking.c"
		}
	}
#line 349 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 349 "../src/contacts-linking.vala"
	return FALSE;
#line 5517 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_real_set_value_data_free (gpointer _data)
{
	ContactsPersonaAttributeWebServiceSetValueData* _data_;
	_data_ = _data;
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->value);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 327 "../src/contacts-linking.vala"
	g_slice_free (ContactsPersonaAttributeWebServiceSetValueData, _data_);
#line 5533 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_real_set_value (ContactsPersonaAttribute* base,
                                                       FolksPersona* persona,
                                                       GObject* value,
                                                       GAsyncReadyCallback _callback_,
                                                       gpointer _user_data_)
{
	ContactsPersonaAttributeWebService * self;
	ContactsPersonaAttributeWebServiceSetValueData* _data_;
	ContactsPersonaAttributeWebService* _tmp0_;
	FolksPersona* _tmp1_;
	GObject* _tmp2_;
#line 327 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeWebService*) base;
#line 327 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsPersonaAttributeWebServiceSetValueData);
#line 327 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 327 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_persona_attribute_web_service_real_set_value_data_free);
#line 327 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 327 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 327 "../src/contacts-linking.vala"
	_tmp1_ = _g_object_ref0 (persona);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona);
#line 327 "../src/contacts-linking.vala"
	_data_->persona = _tmp1_;
#line 327 "../src/contacts-linking.vala"
	_tmp2_ = _g_object_ref0 (value);
#line 327 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->value);
#line 327 "../src/contacts-linking.vala"
	_data_->value = _tmp2_;
#line 327 "../src/contacts-linking.vala"
	contacts_persona_attribute_web_service_real_set_value_co (_data_);
#line 5574 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_set_value_finish (ContactsPersonaAttribute* base,
                                                         GAsyncResult* _res_)
{
	ContactsPersonaAttributeWebServiceSetValueData* _data_;
#line 327 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 5584 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_set_value_ready (GObject* source_object,
                                                        GAsyncResult* _res_,
                                                        gpointer _user_data_)
{
	ContactsPersonaAttributeWebServiceSetValueData* _data_;
#line 413 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 413 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 413 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 413 "../src/contacts-linking.vala"
	contacts_persona_attribute_web_service_real_set_value_co (_data_);
#line 5601 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_web_service_real_set_value_co (ContactsPersonaAttributeWebServiceSetValueData* _data_)
{
#line 406 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 406 "../src/contacts-linking.vala"
		case 0:
#line 5611 "contacts-linking.c"
		goto _state_0;
#line 406 "../src/contacts-linking.vala"
		case 1:
#line 5615 "contacts-linking.c"
		goto _state_1;
		default:
#line 406 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 5620 "contacts-linking.c"
	}
	_state_0:
#line 407 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->persona, FOLKS_TYPE_WEB_SERVICE_DETAILS) ? ((FolksWebServiceDetails*) _data_->persona) : NULL);
#line 407 "../src/contacts-linking.vala"
	_data_->details = _data_->_tmp0_;
#line 408 "../src/contacts-linking.vala"
	_data_->_tmp1_ = _data_->details;
#line 408 "../src/contacts-linking.vala"
	if (_data_->_tmp1_ == NULL) {
#line 409 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 409 "../src/contacts-linking.vala"
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 409 "../src/contacts-linking.vala"
		if (_data_->_state_ != 0) {
#line 409 "../src/contacts-linking.vala"
			while (!g_task_get_completed (_data_->_async_result)) {
#line 409 "../src/contacts-linking.vala"
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 5641 "contacts-linking.c"
			}
		}
#line 409 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 409 "../src/contacts-linking.vala"
		return FALSE;
#line 5648 "contacts-linking.c"
	}
	{
#line 412 "../src/contacts-linking.vala"
		_data_->_tmp2_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->value, GEE_TYPE_HASH_MULTI_MAP) ? ((GeeHashMultiMap*) _data_->value) : NULL);
#line 412 "../src/contacts-linking.vala"
		_data_->v = _data_->_tmp2_;
#line 413 "../src/contacts-linking.vala"
		_data_->_tmp3_ = _data_->details;
#line 413 "../src/contacts-linking.vala"
		_data_->_tmp4_ = _data_->v;
#line 413 "../src/contacts-linking.vala"
		_data_->_state_ = 1;
#line 413 "../src/contacts-linking.vala"
		folks_web_service_details_change_web_service_addresses (_data_->_tmp3_, (GeeMultiMap*) _data_->_tmp4_, contacts_persona_attribute_web_service_set_value_ready, _data_);
#line 413 "../src/contacts-linking.vala"
		return FALSE;
#line 5665 "contacts-linking.c"
		_state_1:
#line 413 "../src/contacts-linking.vala"
		folks_web_service_details_change_web_service_addresses_finish (_data_->_tmp3_, _data_->_res_, &_data_->_inner_error0_);
#line 413 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 413 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->v);
#line 5673 "contacts-linking.c"
			goto __catch20_g_error;
		}
#line 411 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->v);
#line 5678 "contacts-linking.c"
	}
	goto __finally20;
	__catch20_g_error:
	{
#line 411 "../src/contacts-linking.vala"
		_data_->e = _data_->_inner_error0_;
#line 411 "../src/contacts-linking.vala"
		_data_->_inner_error0_ = NULL;
#line 415 "../src/contacts-linking.vala"
		_data_->_tmp5_ = _data_->e;
#line 415 "../src/contacts-linking.vala"
		_data_->_tmp6_ = _data_->_tmp5_->message;
#line 415 "../src/contacts-linking.vala"
		g_warning ("contacts-linking.vala:415: Unable to set local ids when undoing link: " \
"%s\n", _data_->_tmp6_);
#line 411 "../src/contacts-linking.vala"
		_g_error_free0 (_data_->e);
#line 5695 "contacts-linking.c"
	}
	__finally20:
#line 411 "../src/contacts-linking.vala"
	if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 411 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->details);
#line 411 "../src/contacts-linking.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 411 "../src/contacts-linking.vala"
		g_clear_error (&_data_->_inner_error0_);
#line 411 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 411 "../src/contacts-linking.vala"
		return FALSE;
#line 5710 "contacts-linking.c"
	}
#line 406 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->details);
#line 406 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 406 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 406 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 406 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 5722 "contacts-linking.c"
		}
	}
#line 406 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 406 "../src/contacts-linking.vala"
	return FALSE;
#line 5729 "contacts-linking.c"
}

static gboolean
contacts_persona_attribute_web_service_real_equal (ContactsPersonaAttribute* base,
                                                   ContactsPersonaAttribute* _that)
{
	ContactsPersonaAttributeWebService * self;
	ContactsPersonaAttributeWebService* that = NULL;
	ContactsPersonaAttributeWebService* _tmp0_;
	gboolean _tmp1_ = FALSE;
	gboolean _tmp2_ = FALSE;
	gboolean _tmp3_ = FALSE;
	ContactsPersonaAttributeWebService* _tmp4_;
	gboolean result = FALSE;
#line 419 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeWebService*) base;
#line 419 "../src/contacts-linking.vala"
	g_return_val_if_fail (_that != NULL, FALSE);
#line 420 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (CONTACTS_IS_PERSONA_ATTRIBUTE_WEB_SERVICE (_that) ? ((ContactsPersonaAttributeWebService*) _that) : NULL);
#line 420 "../src/contacts-linking.vala"
	that = _tmp0_;
#line 422 "../src/contacts-linking.vala"
	_tmp4_ = that;
#line 422 "../src/contacts-linking.vala"
	if (_tmp4_ != NULL) {
#line 5756 "contacts-linking.c"
		ContactsPersonaAttributeWebService* _tmp5_;
#line 423 "../src/contacts-linking.vala"
		_tmp5_ = that;
#line 423 "../src/contacts-linking.vala"
		_tmp3_ = CONTACTS_PERSONA_ATTRIBUTE_CLASS (contacts_persona_attribute_web_service_parent_class)->equal (G_TYPE_CHECK_INSTANCE_CAST (self, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute), (ContactsPersonaAttribute*) _tmp5_);
#line 5762 "contacts-linking.c"
	} else {
#line 422 "../src/contacts-linking.vala"
		_tmp3_ = FALSE;
#line 5766 "contacts-linking.c"
	}
#line 422 "../src/contacts-linking.vala"
	if (_tmp3_) {
#line 5770 "contacts-linking.c"
		const gchar* _tmp6_;
		ContactsPersonaAttributeWebService* _tmp7_;
		const gchar* _tmp8_;
#line 424 "../src/contacts-linking.vala"
		_tmp6_ = self->priv->service;
#line 424 "../src/contacts-linking.vala"
		_tmp7_ = that;
#line 424 "../src/contacts-linking.vala"
		_tmp8_ = _tmp7_->priv->service;
#line 424 "../src/contacts-linking.vala"
		_tmp2_ = g_strcmp0 (_tmp6_, _tmp8_) == 0;
#line 5782 "contacts-linking.c"
	} else {
#line 422 "../src/contacts-linking.vala"
		_tmp2_ = FALSE;
#line 5786 "contacts-linking.c"
	}
#line 422 "../src/contacts-linking.vala"
	if (_tmp2_) {
#line 5790 "contacts-linking.c"
		FolksWebServiceFieldDetails* _tmp9_;
		ContactsPersonaAttributeWebService* _tmp10_;
		FolksWebServiceFieldDetails* _tmp11_;
#line 425 "../src/contacts-linking.vala"
		_tmp9_ = self->priv->detail;
#line 425 "../src/contacts-linking.vala"
		_tmp10_ = that;
#line 425 "../src/contacts-linking.vala"
		_tmp11_ = _tmp10_->priv->detail;
#line 425 "../src/contacts-linking.vala"
		_tmp1_ = folks_abstract_field_details_equal ((FolksAbstractFieldDetails*) _tmp9_, (FolksAbstractFieldDetails*) _tmp11_);
#line 5802 "contacts-linking.c"
	} else {
#line 422 "../src/contacts-linking.vala"
		_tmp1_ = FALSE;
#line 5806 "contacts-linking.c"
	}
#line 421 "../src/contacts-linking.vala"
	result = _tmp1_;
#line 421 "../src/contacts-linking.vala"
	_g_object_unref0 (that);
#line 421 "../src/contacts-linking.vala"
	return result;
#line 5814 "contacts-linking.c"
}

static guint
contacts_persona_attribute_web_service_real_hash (ContactsPersonaAttribute* base)
{
	ContactsPersonaAttributeWebService * self;
	const gchar* _tmp0_;
	FolksWebServiceFieldDetails* _tmp1_;
	guint result = 0U;
#line 428 "../src/contacts-linking.vala"
	self = (ContactsPersonaAttributeWebService*) base;
#line 429 "../src/contacts-linking.vala"
	_tmp0_ = self->priv->service;
#line 429 "../src/contacts-linking.vala"
	_tmp1_ = self->priv->detail;
#line 429 "../src/contacts-linking.vala"
	result = (g_str_hash (_tmp0_) ^ folks_abstract_field_details_hash ((FolksAbstractFieldDetails*) _tmp1_)) ^ CONTACTS_PERSONA_ATTRIBUTE_CLASS (contacts_persona_attribute_web_service_parent_class)->hash (G_TYPE_CHECK_INSTANCE_CAST (self, CONTACTS_TYPE_PERSONA_ATTRIBUTE, ContactsPersonaAttribute));
#line 429 "../src/contacts-linking.vala"
	return result;
#line 5834 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_class_init (ContactsPersonaAttributeWebServiceClass * klass,
                                                   gpointer klass_data)
{
#line 327 "../src/contacts-linking.vala"
	contacts_persona_attribute_web_service_parent_class = g_type_class_peek_parent (klass);
#line 327 "../src/contacts-linking.vala"
	g_type_class_adjust_private_offset (klass, &ContactsPersonaAttributeWebService_private_offset);
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->to_string = (gchar* (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_web_service_real_to_string;
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->is_referenced_by_persona = (gboolean (*) (ContactsPersonaAttribute*, FolksPersona*)) contacts_persona_attribute_web_service_real_is_referenced_by_persona;
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->persona_apply_attributes = (void (*) (ContactsPersonaAttribute*, FolksPersona*, GeeSet*, GeeSet*, ContactsLinkOperation*, GAsyncReadyCallback, gpointer)) contacts_persona_attribute_web_service_real_persona_apply_attributes;
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->persona_apply_attributes_finish = (void (*) (ContactsPersonaAttribute*, GAsyncResult*)) contacts_persona_attribute_web_service_persona_apply_attributes_finish;
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->set_value = (void (*) (ContactsPersonaAttribute*, FolksPersona*, GObject*, GAsyncReadyCallback, gpointer)) contacts_persona_attribute_web_service_real_set_value;
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->set_value_finish = (void (*) (ContactsPersonaAttribute*, GAsyncResult*)) contacts_persona_attribute_web_service_set_value_finish;
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->equal = (gboolean (*) (ContactsPersonaAttribute*, ContactsPersonaAttribute*)) contacts_persona_attribute_web_service_real_equal;
#line 327 "../src/contacts-linking.vala"
	((ContactsPersonaAttributeClass *) klass)->hash = (guint (*) (ContactsPersonaAttribute*)) contacts_persona_attribute_web_service_real_hash;
#line 327 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_persona_attribute_web_service_finalize;
#line 5863 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_instance_init (ContactsPersonaAttributeWebService * self,
                                                      gpointer klass)
{
#line 327 "../src/contacts-linking.vala"
	self->priv = contacts_persona_attribute_web_service_get_instance_private (self);
#line 5872 "contacts-linking.c"
}

static void
contacts_persona_attribute_web_service_finalize (GObject * obj)
{
	ContactsPersonaAttributeWebService * self;
#line 327 "../src/contacts-linking.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_PERSONA_ATTRIBUTE_WEB_SERVICE, ContactsPersonaAttributeWebService);
#line 328 "../src/contacts-linking.vala"
	_g_free0 (self->priv->service);
#line 329 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->detail);
#line 327 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (contacts_persona_attribute_web_service_parent_class)->finalize (obj);
#line 5887 "contacts-linking.c"
}

static GType
contacts_persona_attribute_web_service_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsPersonaAttributeWebServiceClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_persona_attribute_web_service_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsPersonaAttributeWebService), 0, (GInstanceInitFunc) contacts_persona_attribute_web_service_instance_init, NULL };
	GType contacts_persona_attribute_web_service_type_id;
	contacts_persona_attribute_web_service_type_id = g_type_register_static (CONTACTS_TYPE_PERSONA_ATTRIBUTE, "ContactsPersonaAttributeWebService", &g_define_type_info, 0);
	ContactsPersonaAttributeWebService_private_offset = g_type_add_instance_private (contacts_persona_attribute_web_service_type_id, sizeof (ContactsPersonaAttributeWebServicePrivate));
	return contacts_persona_attribute_web_service_type_id;
}

GType
contacts_persona_attribute_web_service_get_type (void)
{
	static volatile gsize contacts_persona_attribute_web_service_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_persona_attribute_web_service_type_id__volatile)) {
		GType contacts_persona_attribute_web_service_type_id;
		contacts_persona_attribute_web_service_type_id = contacts_persona_attribute_web_service_get_type_once ();
		g_once_init_leave (&contacts_persona_attribute_web_service_type_id__volatile, contacts_persona_attribute_web_service_type_id);
	}
	return contacts_persona_attribute_web_service_type_id__volatile;
}

void
contacts_add_linkable_attributes (GeeHashSet* set,
                                  FolksPersona* persona)
{
#line 433 "../src/contacts-linking.vala"
	g_return_if_fail (set != NULL);
#line 433 "../src/contacts-linking.vala"
	g_return_if_fail (persona != NULL);
#line 434 "../src/contacts-linking.vala"
	if (G_TYPE_CHECK_INSTANCE_TYPE (persona, FOLKS_TYPE_LOCAL_ID_DETAILS)) {
#line 5922 "contacts-linking.c"
		{
			GeeIterator* _id_it = NULL;
			GeeSet* _tmp0_;
			GeeSet* _tmp1_;
			GeeIterator* _tmp2_;
#line 435 "../src/contacts-linking.vala"
			_tmp0_ = folks_local_id_details_get_local_ids (G_TYPE_CHECK_INSTANCE_CAST (persona, FOLKS_TYPE_LOCAL_ID_DETAILS, FolksLocalIdDetails));
#line 435 "../src/contacts-linking.vala"
			_tmp1_ = _tmp0_;
#line 435 "../src/contacts-linking.vala"
			_tmp2_ = gee_iterable_iterator ((GeeIterable*) _tmp1_);
#line 435 "../src/contacts-linking.vala"
			_id_it = _tmp2_;
#line 435 "../src/contacts-linking.vala"
			while (TRUE) {
#line 5938 "contacts-linking.c"
				GeeIterator* _tmp3_;
				gchar* id = NULL;
				GeeIterator* _tmp4_;
				gpointer _tmp5_;
				const gchar* _tmp6_;
				ContactsPersonaAttributeLocalId* _tmp7_;
				ContactsPersonaAttributeLocalId* _tmp8_;
#line 435 "../src/contacts-linking.vala"
				_tmp3_ = _id_it;
#line 435 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_tmp3_)) {
#line 435 "../src/contacts-linking.vala"
					break;
#line 5952 "contacts-linking.c"
				}
#line 435 "../src/contacts-linking.vala"
				_tmp4_ = _id_it;
#line 435 "../src/contacts-linking.vala"
				_tmp5_ = gee_iterator_get (_tmp4_);
#line 435 "../src/contacts-linking.vala"
				id = (gchar*) _tmp5_;
#line 436 "../src/contacts-linking.vala"
				_tmp6_ = id;
#line 436 "../src/contacts-linking.vala"
				_tmp7_ = contacts_persona_attribute_local_id_new (_tmp6_);
#line 436 "../src/contacts-linking.vala"
				_tmp8_ = _tmp7_;
#line 436 "../src/contacts-linking.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) set, (ContactsPersonaAttribute*) _tmp8_);
#line 436 "../src/contacts-linking.vala"
				_g_object_unref0 (_tmp8_);
#line 435 "../src/contacts-linking.vala"
				_g_free0 (id);
#line 5972 "contacts-linking.c"
			}
#line 435 "../src/contacts-linking.vala"
			_g_object_unref0 (_id_it);
#line 5976 "contacts-linking.c"
		}
	}
#line 440 "../src/contacts-linking.vala"
	if (G_TYPE_CHECK_INSTANCE_TYPE (persona, FOLKS_TYPE_IM_DETAILS)) {
#line 5981 "contacts-linking.c"
		{
			GeeIterator* _proto_it = NULL;
			GeeMultiMap* _tmp9_;
			GeeMultiMap* _tmp10_;
			GeeSet* _tmp11_;
			GeeSet* _tmp12_;
			GeeIterator* _tmp13_;
			GeeIterator* _tmp14_;
#line 441 "../src/contacts-linking.vala"
			_tmp9_ = folks_im_details_get_im_addresses (G_TYPE_CHECK_INSTANCE_CAST (persona, FOLKS_TYPE_IM_DETAILS, FolksImDetails));
#line 441 "../src/contacts-linking.vala"
			_tmp10_ = _tmp9_;
#line 441 "../src/contacts-linking.vala"
			_tmp11_ = gee_multi_map_get_keys (_tmp10_);
#line 441 "../src/contacts-linking.vala"
			_tmp12_ = _tmp11_;
#line 441 "../src/contacts-linking.vala"
			_tmp13_ = gee_iterable_iterator ((GeeIterable*) _tmp12_);
#line 441 "../src/contacts-linking.vala"
			_tmp14_ = _tmp13_;
#line 441 "../src/contacts-linking.vala"
			_g_object_unref0 (_tmp12_);
#line 441 "../src/contacts-linking.vala"
			_proto_it = _tmp14_;
#line 441 "../src/contacts-linking.vala"
			while (TRUE) {
#line 6008 "contacts-linking.c"
				GeeIterator* _tmp15_;
				gchar* proto = NULL;
				GeeIterator* _tmp16_;
				gpointer _tmp17_;
#line 441 "../src/contacts-linking.vala"
				_tmp15_ = _proto_it;
#line 441 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_tmp15_)) {
#line 441 "../src/contacts-linking.vala"
					break;
#line 6019 "contacts-linking.c"
				}
#line 441 "../src/contacts-linking.vala"
				_tmp16_ = _proto_it;
#line 441 "../src/contacts-linking.vala"
				_tmp17_ = gee_iterator_get (_tmp16_);
#line 441 "../src/contacts-linking.vala"
				proto = (gchar*) _tmp17_;
#line 6027 "contacts-linking.c"
				{
					GeeIterator* _im_it = NULL;
					GeeMultiMap* _tmp18_;
					GeeMultiMap* _tmp19_;
					const gchar* _tmp20_;
					GeeCollection* _tmp21_;
					GeeCollection* _tmp22_;
					GeeIterator* _tmp23_;
					GeeIterator* _tmp24_;
#line 442 "../src/contacts-linking.vala"
					_tmp18_ = folks_im_details_get_im_addresses (G_TYPE_CHECK_INSTANCE_CAST (persona, FOLKS_TYPE_IM_DETAILS, FolksImDetails));
#line 442 "../src/contacts-linking.vala"
					_tmp19_ = _tmp18_;
#line 442 "../src/contacts-linking.vala"
					_tmp20_ = proto;
#line 442 "../src/contacts-linking.vala"
					_tmp21_ = gee_multi_map_get (_tmp19_, _tmp20_);
#line 442 "../src/contacts-linking.vala"
					_tmp22_ = _tmp21_;
#line 442 "../src/contacts-linking.vala"
					_tmp23_ = gee_iterable_iterator ((GeeIterable*) _tmp22_);
#line 442 "../src/contacts-linking.vala"
					_tmp24_ = _tmp23_;
#line 442 "../src/contacts-linking.vala"
					_g_object_unref0 (_tmp22_);
#line 442 "../src/contacts-linking.vala"
					_im_it = _tmp24_;
#line 442 "../src/contacts-linking.vala"
					while (TRUE) {
#line 6057 "contacts-linking.c"
						GeeIterator* _tmp25_;
						FolksImFieldDetails* im = NULL;
						GeeIterator* _tmp26_;
						gpointer _tmp27_;
						const gchar* _tmp28_;
						FolksImFieldDetails* _tmp29_;
						ContactsPersonaAttributeImAddress* _tmp30_;
						ContactsPersonaAttributeImAddress* _tmp31_;
#line 442 "../src/contacts-linking.vala"
						_tmp25_ = _im_it;
#line 442 "../src/contacts-linking.vala"
						if (!gee_iterator_next (_tmp25_)) {
#line 442 "../src/contacts-linking.vala"
							break;
#line 6072 "contacts-linking.c"
						}
#line 442 "../src/contacts-linking.vala"
						_tmp26_ = _im_it;
#line 442 "../src/contacts-linking.vala"
						_tmp27_ = gee_iterator_get (_tmp26_);
#line 442 "../src/contacts-linking.vala"
						im = (FolksImFieldDetails*) _tmp27_;
#line 443 "../src/contacts-linking.vala"
						_tmp28_ = proto;
#line 443 "../src/contacts-linking.vala"
						_tmp29_ = im;
#line 443 "../src/contacts-linking.vala"
						_tmp30_ = contacts_persona_attribute_im_address_new (_tmp28_, _tmp29_);
#line 443 "../src/contacts-linking.vala"
						_tmp31_ = _tmp30_;
#line 443 "../src/contacts-linking.vala"
						gee_abstract_collection_add ((GeeAbstractCollection*) set, (ContactsPersonaAttribute*) _tmp31_);
#line 443 "../src/contacts-linking.vala"
						_g_object_unref0 (_tmp31_);
#line 442 "../src/contacts-linking.vala"
						_g_object_unref0 (im);
#line 6094 "contacts-linking.c"
					}
#line 442 "../src/contacts-linking.vala"
					_g_object_unref0 (_im_it);
#line 6098 "contacts-linking.c"
				}
#line 441 "../src/contacts-linking.vala"
				_g_free0 (proto);
#line 6102 "contacts-linking.c"
			}
#line 441 "../src/contacts-linking.vala"
			_g_object_unref0 (_proto_it);
#line 6106 "contacts-linking.c"
		}
	}
#line 448 "../src/contacts-linking.vala"
	if (G_TYPE_CHECK_INSTANCE_TYPE (persona, FOLKS_TYPE_WEB_SERVICE_DETAILS)) {
#line 6111 "contacts-linking.c"
		{
			GeeIterator* _srv_it = NULL;
			GeeMultiMap* _tmp32_;
			GeeMultiMap* _tmp33_;
			GeeSet* _tmp34_;
			GeeSet* _tmp35_;
			GeeIterator* _tmp36_;
			GeeIterator* _tmp37_;
#line 449 "../src/contacts-linking.vala"
			_tmp32_ = folks_web_service_details_get_web_service_addresses (G_TYPE_CHECK_INSTANCE_CAST (persona, FOLKS_TYPE_WEB_SERVICE_DETAILS, FolksWebServiceDetails));
#line 449 "../src/contacts-linking.vala"
			_tmp33_ = _tmp32_;
#line 449 "../src/contacts-linking.vala"
			_tmp34_ = gee_multi_map_get_keys (_tmp33_);
#line 449 "../src/contacts-linking.vala"
			_tmp35_ = _tmp34_;
#line 449 "../src/contacts-linking.vala"
			_tmp36_ = gee_iterable_iterator ((GeeIterable*) _tmp35_);
#line 449 "../src/contacts-linking.vala"
			_tmp37_ = _tmp36_;
#line 449 "../src/contacts-linking.vala"
			_g_object_unref0 (_tmp35_);
#line 449 "../src/contacts-linking.vala"
			_srv_it = _tmp37_;
#line 449 "../src/contacts-linking.vala"
			while (TRUE) {
#line 6138 "contacts-linking.c"
				GeeIterator* _tmp38_;
				gchar* srv = NULL;
				GeeIterator* _tmp39_;
				gpointer _tmp40_;
#line 449 "../src/contacts-linking.vala"
				_tmp38_ = _srv_it;
#line 449 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_tmp38_)) {
#line 449 "../src/contacts-linking.vala"
					break;
#line 6149 "contacts-linking.c"
				}
#line 449 "../src/contacts-linking.vala"
				_tmp39_ = _srv_it;
#line 449 "../src/contacts-linking.vala"
				_tmp40_ = gee_iterator_get (_tmp39_);
#line 449 "../src/contacts-linking.vala"
				srv = (gchar*) _tmp40_;
#line 6157 "contacts-linking.c"
				{
					GeeIterator* _web_it = NULL;
					GeeMultiMap* _tmp41_;
					GeeMultiMap* _tmp42_;
					const gchar* _tmp43_;
					GeeCollection* _tmp44_;
					GeeCollection* _tmp45_;
					GeeIterator* _tmp46_;
					GeeIterator* _tmp47_;
#line 450 "../src/contacts-linking.vala"
					_tmp41_ = folks_web_service_details_get_web_service_addresses (G_TYPE_CHECK_INSTANCE_CAST (persona, FOLKS_TYPE_WEB_SERVICE_DETAILS, FolksWebServiceDetails));
#line 450 "../src/contacts-linking.vala"
					_tmp42_ = _tmp41_;
#line 450 "../src/contacts-linking.vala"
					_tmp43_ = srv;
#line 450 "../src/contacts-linking.vala"
					_tmp44_ = gee_multi_map_get (_tmp42_, _tmp43_);
#line 450 "../src/contacts-linking.vala"
					_tmp45_ = _tmp44_;
#line 450 "../src/contacts-linking.vala"
					_tmp46_ = gee_iterable_iterator ((GeeIterable*) _tmp45_);
#line 450 "../src/contacts-linking.vala"
					_tmp47_ = _tmp46_;
#line 450 "../src/contacts-linking.vala"
					_g_object_unref0 (_tmp45_);
#line 450 "../src/contacts-linking.vala"
					_web_it = _tmp47_;
#line 450 "../src/contacts-linking.vala"
					while (TRUE) {
#line 6187 "contacts-linking.c"
						GeeIterator* _tmp48_;
						FolksWebServiceFieldDetails* web = NULL;
						GeeIterator* _tmp49_;
						gpointer _tmp50_;
						const gchar* _tmp51_;
						FolksWebServiceFieldDetails* _tmp52_;
						ContactsPersonaAttributeWebService* _tmp53_;
						ContactsPersonaAttributeWebService* _tmp54_;
#line 450 "../src/contacts-linking.vala"
						_tmp48_ = _web_it;
#line 450 "../src/contacts-linking.vala"
						if (!gee_iterator_next (_tmp48_)) {
#line 450 "../src/contacts-linking.vala"
							break;
#line 6202 "contacts-linking.c"
						}
#line 450 "../src/contacts-linking.vala"
						_tmp49_ = _web_it;
#line 450 "../src/contacts-linking.vala"
						_tmp50_ = gee_iterator_get (_tmp49_);
#line 450 "../src/contacts-linking.vala"
						web = (FolksWebServiceFieldDetails*) _tmp50_;
#line 451 "../src/contacts-linking.vala"
						_tmp51_ = srv;
#line 451 "../src/contacts-linking.vala"
						_tmp52_ = web;
#line 451 "../src/contacts-linking.vala"
						_tmp53_ = contacts_persona_attribute_web_service_new (_tmp51_, _tmp52_);
#line 451 "../src/contacts-linking.vala"
						_tmp54_ = _tmp53_;
#line 451 "../src/contacts-linking.vala"
						gee_abstract_collection_add ((GeeAbstractCollection*) set, (ContactsPersonaAttribute*) _tmp54_);
#line 451 "../src/contacts-linking.vala"
						_g_object_unref0 (_tmp54_);
#line 450 "../src/contacts-linking.vala"
						_g_object_unref0 (web);
#line 6224 "contacts-linking.c"
					}
#line 450 "../src/contacts-linking.vala"
					_g_object_unref0 (_web_it);
#line 6228 "contacts-linking.c"
				}
#line 449 "../src/contacts-linking.vala"
				_g_free0 (srv);
#line 6232 "contacts-linking.c"
			}
#line 449 "../src/contacts-linking.vala"
			_g_object_unref0 (_srv_it);
#line 6236 "contacts-linking.c"
		}
	}
}

GeeSet*
contacts_get_linkable_attributes (FolksPersona* persona)
{
	GeeHashSet* res = NULL;
	GeeHashSet* _tmp0_;
	GeeSet* result = NULL;
#line 457 "../src/contacts-linking.vala"
	g_return_val_if_fail (persona != NULL, NULL);
#line 458 "../src/contacts-linking.vala"
	_tmp0_ = contacts_persona_attribute_create_set ();
#line 458 "../src/contacts-linking.vala"
	res = _tmp0_;
#line 459 "../src/contacts-linking.vala"
	contacts_add_linkable_attributes (res, persona);
#line 460 "../src/contacts-linking.vala"
	result = (GeeSet*) res;
#line 460 "../src/contacts-linking.vala"
	return result;
#line 6259 "contacts-linking.c"
}

GeeSet*
contacts_get_linkable_attributes_for_individual (FolksIndividual* individual)
{
	GeeHashSet* res = NULL;
	GeeHashSet* _tmp0_;
	GeeSet* result = NULL;
#line 463 "../src/contacts-linking.vala"
	g_return_val_if_fail (individual != NULL, NULL);
#line 464 "../src/contacts-linking.vala"
	_tmp0_ = contacts_persona_attribute_create_set ();
#line 464 "../src/contacts-linking.vala"
	res = _tmp0_;
#line 6274 "contacts-linking.c"
	{
		GeeIterator* _persona_it = NULL;
		GeeSet* _tmp1_;
		GeeSet* _tmp2_;
		GeeIterator* _tmp3_;
#line 465 "../src/contacts-linking.vala"
		_tmp1_ = folks_individual_get_personas (individual);
#line 465 "../src/contacts-linking.vala"
		_tmp2_ = _tmp1_;
#line 465 "../src/contacts-linking.vala"
		_tmp3_ = gee_iterable_iterator ((GeeIterable*) _tmp2_);
#line 465 "../src/contacts-linking.vala"
		_persona_it = _tmp3_;
#line 465 "../src/contacts-linking.vala"
		while (TRUE) {
#line 6290 "contacts-linking.c"
			GeeIterator* _tmp4_;
			FolksPersona* persona = NULL;
			GeeIterator* _tmp5_;
			gpointer _tmp6_;
			GeeHashSet* _tmp7_;
			FolksPersona* _tmp8_;
#line 465 "../src/contacts-linking.vala"
			_tmp4_ = _persona_it;
#line 465 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_tmp4_)) {
#line 465 "../src/contacts-linking.vala"
				break;
#line 6303 "contacts-linking.c"
			}
#line 465 "../src/contacts-linking.vala"
			_tmp5_ = _persona_it;
#line 465 "../src/contacts-linking.vala"
			_tmp6_ = gee_iterator_get (_tmp5_);
#line 465 "../src/contacts-linking.vala"
			persona = (FolksPersona*) _tmp6_;
#line 466 "../src/contacts-linking.vala"
			_tmp7_ = res;
#line 466 "../src/contacts-linking.vala"
			_tmp8_ = persona;
#line 466 "../src/contacts-linking.vala"
			contacts_add_linkable_attributes (_tmp7_, _tmp8_);
#line 465 "../src/contacts-linking.vala"
			_g_object_unref0 (persona);
#line 6319 "contacts-linking.c"
		}
#line 465 "../src/contacts-linking.vala"
		_g_object_unref0 (_persona_it);
#line 6323 "contacts-linking.c"
	}
#line 467 "../src/contacts-linking.vala"
	result = (GeeSet*) res;
#line 467 "../src/contacts-linking.vala"
	return result;
#line 6329 "contacts-linking.c"
}

gboolean
contacts_persona_can_link_to (FolksPersona* persona,
                              GeeSet* attributes)
{
	GeeHashSet* property_names = NULL;
	GeeHashSet* _tmp0_;
	gboolean result = FALSE;
#line 470 "../src/contacts-linking.vala"
	g_return_val_if_fail (persona != NULL, FALSE);
#line 470 "../src/contacts-linking.vala"
	g_return_val_if_fail (attributes != NULL, FALSE);
#line 471 "../src/contacts-linking.vala"
	_tmp0_ = gee_hash_set_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, NULL, NULL, NULL, NULL, NULL, NULL);
#line 471 "../src/contacts-linking.vala"
	property_names = _tmp0_;
#line 6347 "contacts-linking.c"
	{
		GeeIterator* _a_it = NULL;
		GeeIterator* _tmp1_;
#line 472 "../src/contacts-linking.vala"
		_tmp1_ = gee_iterable_iterator ((GeeIterable*) attributes);
#line 472 "../src/contacts-linking.vala"
		_a_it = _tmp1_;
#line 472 "../src/contacts-linking.vala"
		while (TRUE) {
#line 6357 "contacts-linking.c"
			GeeIterator* _tmp2_;
			ContactsPersonaAttribute* a = NULL;
			GeeIterator* _tmp3_;
			gpointer _tmp4_;
			GeeHashSet* _tmp5_;
			ContactsPersonaAttribute* _tmp6_;
			const gchar* _tmp7_;
#line 472 "../src/contacts-linking.vala"
			_tmp2_ = _a_it;
#line 472 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_tmp2_)) {
#line 472 "../src/contacts-linking.vala"
				break;
#line 6371 "contacts-linking.c"
			}
#line 472 "../src/contacts-linking.vala"
			_tmp3_ = _a_it;
#line 472 "../src/contacts-linking.vala"
			_tmp4_ = gee_iterator_get (_tmp3_);
#line 472 "../src/contacts-linking.vala"
			a = (ContactsPersonaAttribute*) _tmp4_;
#line 473 "../src/contacts-linking.vala"
			_tmp5_ = property_names;
#line 473 "../src/contacts-linking.vala"
			_tmp6_ = a;
#line 473 "../src/contacts-linking.vala"
			_tmp7_ = _tmp6_->property_name;
#line 473 "../src/contacts-linking.vala"
			gee_abstract_collection_add ((GeeAbstractCollection*) _tmp5_, _tmp7_);
#line 472 "../src/contacts-linking.vala"
			_g_object_unref0 (a);
#line 6389 "contacts-linking.c"
		}
#line 472 "../src/contacts-linking.vala"
		_g_object_unref0 (_a_it);
#line 6393 "contacts-linking.c"
	}
	{
		GeeIterator* _p_it = NULL;
		GeeHashSet* _tmp8_;
		GeeIterator* _tmp9_;
#line 475 "../src/contacts-linking.vala"
		_tmp8_ = property_names;
#line 475 "../src/contacts-linking.vala"
		_tmp9_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _tmp8_);
#line 475 "../src/contacts-linking.vala"
		_p_it = _tmp9_;
#line 475 "../src/contacts-linking.vala"
		while (TRUE) {
#line 6407 "contacts-linking.c"
			GeeIterator* _tmp10_;
			gchar* p = NULL;
			GeeIterator* _tmp11_;
			gpointer _tmp12_;
			const gchar* _tmp13_;
			gchar** _tmp14_;
			gint _tmp14__length1;
			gchar** _tmp15_;
			gint _tmp15__length1;
#line 475 "../src/contacts-linking.vala"
			_tmp10_ = _p_it;
#line 475 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_tmp10_)) {
#line 475 "../src/contacts-linking.vala"
				break;
#line 6423 "contacts-linking.c"
			}
#line 475 "../src/contacts-linking.vala"
			_tmp11_ = _p_it;
#line 475 "../src/contacts-linking.vala"
			_tmp12_ = gee_iterator_get (_tmp11_);
#line 475 "../src/contacts-linking.vala"
			p = (gchar*) _tmp12_;
#line 476 "../src/contacts-linking.vala"
			_tmp13_ = p;
#line 476 "../src/contacts-linking.vala"
			_tmp14_ = folks_persona_get_writeable_properties (persona, &_tmp14__length1);
#line 476 "../src/contacts-linking.vala"
			_tmp15_ = _tmp14_;
#line 476 "../src/contacts-linking.vala"
			_tmp15__length1 = _tmp14__length1;
#line 476 "../src/contacts-linking.vala"
			if (!_vala_string_array_contains (_tmp15_, _tmp15__length1, _tmp13_)) {
#line 477 "../src/contacts-linking.vala"
				result = FALSE;
#line 477 "../src/contacts-linking.vala"
				_g_free0 (p);
#line 477 "../src/contacts-linking.vala"
				_g_object_unref0 (_p_it);
#line 477 "../src/contacts-linking.vala"
				_g_object_unref0 (property_names);
#line 477 "../src/contacts-linking.vala"
				return result;
#line 6451 "contacts-linking.c"
			}
#line 475 "../src/contacts-linking.vala"
			_g_free0 (p);
#line 6455 "contacts-linking.c"
		}
#line 475 "../src/contacts-linking.vala"
		_g_object_unref0 (_p_it);
#line 6459 "contacts-linking.c"
	}
#line 479 "../src/contacts-linking.vala"
	result = TRUE;
#line 479 "../src/contacts-linking.vala"
	_g_object_unref0 (property_names);
#line 479 "../src/contacts-linking.vala"
	return result;
#line 6467 "contacts-linking.c"
}

gboolean
contacts_attr_type_equal (ContactsPersonaAttribute* a,
                          ContactsPersonaAttribute* b)
{
	gboolean _tmp0_ = FALSE;
	gboolean result = FALSE;
#line 482 "../src/contacts-linking.vala"
	g_return_val_if_fail (a != NULL, FALSE);
#line 482 "../src/contacts-linking.vala"
	g_return_val_if_fail (b != NULL, FALSE);
#line 484 "../src/contacts-linking.vala"
	if (G_TYPE_FROM_INSTANCE ((GObject*) a) == G_TYPE_FROM_INSTANCE ((GObject*) b)) {
#line 6482 "contacts-linking.c"
		const gchar* _tmp1_;
		const gchar* _tmp2_;
#line 485 "../src/contacts-linking.vala"
		_tmp1_ = a->property_name;
#line 485 "../src/contacts-linking.vala"
		_tmp2_ = b->property_name;
#line 485 "../src/contacts-linking.vala"
		_tmp0_ = g_strcmp0 (_tmp1_, _tmp2_) == 0;
#line 6491 "contacts-linking.c"
	} else {
#line 484 "../src/contacts-linking.vala"
		_tmp0_ = FALSE;
#line 6495 "contacts-linking.c"
	}
#line 483 "../src/contacts-linking.vala"
	result = _tmp0_;
#line 483 "../src/contacts-linking.vala"
	return result;
#line 6501 "contacts-linking.c"
}

static void
contacts_persona_apply_attributes_data_free (gpointer _data)
{
	ContactsPersonaApplyAttributesData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->persona);
	_g_object_unref0 (_data_->added_attributes);
	_g_object_unref0 (_data_->removed_attributes);
	_g_object_unref0 (_data_->operation);
	g_slice_free (ContactsPersonaApplyAttributesData, _data_);
}

void
contacts_persona_apply_attributes (FolksPersona* persona,
                                   GeeSet* added_attributes,
                                   GeeSet* removed_attributes,
                                   ContactsLinkOperation* operation,
                                   GAsyncReadyCallback _callback_,
                                   gpointer _user_data_)
{
	ContactsPersonaApplyAttributesData* _data_;
	FolksPersona* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	ContactsLinkOperation* _tmp3_;
	_data_ = g_slice_new0 (ContactsPersonaApplyAttributesData);
	_data_->_async_result = g_task_new (NULL, NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, contacts_persona_apply_attributes_data_free);
	_tmp0_ = _g_object_ref0 (persona);
	_g_object_unref0 (_data_->persona);
	_data_->persona = _tmp0_;
	_tmp1_ = _g_object_ref0 (added_attributes);
	_g_object_unref0 (_data_->added_attributes);
	_data_->added_attributes = _tmp1_;
	_tmp2_ = _g_object_ref0 (removed_attributes);
	_g_object_unref0 (_data_->removed_attributes);
	_data_->removed_attributes = _tmp2_;
	_tmp3_ = _g_object_ref0 (operation);
	_g_object_unref0 (_data_->operation);
	_data_->operation = _tmp3_;
	contacts_persona_apply_attributes_co (_data_);
}

void
contacts_persona_apply_attributes_finish (GAsyncResult* _res_)
{
	ContactsPersonaApplyAttributesData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
}

static void
contacts_persona_apply_attributes_ready (GObject* source_object,
                                         GAsyncResult* _res_,
                                         gpointer _user_data_)
{
	ContactsPersonaApplyAttributesData* _data_;
#line 520 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 520 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 520 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 520 "../src/contacts-linking.vala"
	contacts_persona_apply_attributes_co (_data_);
#line 6568 "contacts-linking.c"
}

static gboolean
contacts_persona_apply_attributes_co (ContactsPersonaApplyAttributesData* _data_)
{
#line 488 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 488 "../src/contacts-linking.vala"
		case 0:
#line 6578 "contacts-linking.c"
		goto _state_0;
#line 488 "../src/contacts-linking.vala"
		case 1:
#line 6582 "contacts-linking.c"
		goto _state_1;
		default:
#line 488 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 6587 "contacts-linking.c"
	}
	_state_0:
#line 492 "../src/contacts-linking.vala"
	_data_->_tmp0_ = gee_hash_set_new (CONTACTS_TYPE_PERSONA_ATTRIBUTE, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL);
#line 492 "../src/contacts-linking.vala"
	_data_->properties = _data_->_tmp0_;
#line 494 "../src/contacts-linking.vala"
	if (_data_->added_attributes != NULL) {
#line 6596 "contacts-linking.c"
		{
#line 495 "../src/contacts-linking.vala"
			_data_->_tmp1_ = gee_iterable_iterator ((GeeIterable*) _data_->added_attributes);
#line 495 "../src/contacts-linking.vala"
			_data_->_a1_it = _data_->_tmp1_;
#line 495 "../src/contacts-linking.vala"
			while (TRUE) {
#line 495 "../src/contacts-linking.vala"
				_data_->_tmp2_ = _data_->_a1_it;
#line 495 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_data_->_tmp2_)) {
#line 495 "../src/contacts-linking.vala"
					break;
#line 6610 "contacts-linking.c"
				}
#line 495 "../src/contacts-linking.vala"
				_data_->_tmp3_ = _data_->_a1_it;
#line 495 "../src/contacts-linking.vala"
				_data_->_tmp4_ = gee_iterator_get (_data_->_tmp3_);
#line 495 "../src/contacts-linking.vala"
				_data_->a1 = (ContactsPersonaAttribute*) _data_->_tmp4_;
#line 496 "../src/contacts-linking.vala"
				_data_->_tmp5_ = _data_->properties;
#line 496 "../src/contacts-linking.vala"
				_data_->_tmp6_ = _data_->a1;
#line 496 "../src/contacts-linking.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp5_, _data_->_tmp6_);
#line 495 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->a1);
#line 6626 "contacts-linking.c"
			}
#line 495 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_a1_it);
#line 6630 "contacts-linking.c"
		}
	}
#line 499 "../src/contacts-linking.vala"
	if (_data_->removed_attributes != NULL) {
#line 6635 "contacts-linking.c"
		{
#line 500 "../src/contacts-linking.vala"
			_data_->_tmp7_ = gee_iterable_iterator ((GeeIterable*) _data_->removed_attributes);
#line 500 "../src/contacts-linking.vala"
			_data_->_a2_it = _data_->_tmp7_;
#line 500 "../src/contacts-linking.vala"
			while (TRUE) {
#line 500 "../src/contacts-linking.vala"
				_data_->_tmp8_ = _data_->_a2_it;
#line 500 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_data_->_tmp8_)) {
#line 500 "../src/contacts-linking.vala"
					break;
#line 6649 "contacts-linking.c"
				}
#line 500 "../src/contacts-linking.vala"
				_data_->_tmp9_ = _data_->_a2_it;
#line 500 "../src/contacts-linking.vala"
				_data_->_tmp10_ = gee_iterator_get (_data_->_tmp9_);
#line 500 "../src/contacts-linking.vala"
				_data_->a2 = (ContactsPersonaAttribute*) _data_->_tmp10_;
#line 501 "../src/contacts-linking.vala"
				_data_->_tmp11_ = _data_->properties;
#line 501 "../src/contacts-linking.vala"
				_data_->_tmp12_ = _data_->a2;
#line 501 "../src/contacts-linking.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp11_, _data_->_tmp12_);
#line 500 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->a2);
#line 6665 "contacts-linking.c"
			}
#line 500 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_a2_it);
#line 6669 "contacts-linking.c"
		}
	}
	{
#line 505 "../src/contacts-linking.vala"
		_data_->_tmp13_ = _data_->properties;
#line 505 "../src/contacts-linking.vala"
		_data_->_tmp14_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _data_->_tmp13_);
#line 505 "../src/contacts-linking.vala"
		_data_->_property_it = _data_->_tmp14_;
#line 505 "../src/contacts-linking.vala"
		while (TRUE) {
#line 505 "../src/contacts-linking.vala"
			_data_->_tmp15_ = _data_->_property_it;
#line 505 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp15_)) {
#line 505 "../src/contacts-linking.vala"
				break;
#line 6687 "contacts-linking.c"
			}
#line 505 "../src/contacts-linking.vala"
			_data_->_tmp16_ = _data_->_property_it;
#line 505 "../src/contacts-linking.vala"
			_data_->_tmp17_ = gee_iterator_get (_data_->_tmp16_);
#line 505 "../src/contacts-linking.vala"
			_data_->property = (ContactsPersonaAttribute*) _data_->_tmp17_;
#line 506 "../src/contacts-linking.vala"
			_data_->_tmp18_ = contacts_persona_attribute_create_set ();
#line 506 "../src/contacts-linking.vala"
			_data_->added = _data_->_tmp18_;
#line 507 "../src/contacts-linking.vala"
			_data_->_tmp19_ = contacts_persona_attribute_create_set ();
#line 507 "../src/contacts-linking.vala"
			_data_->removed = _data_->_tmp19_;
#line 508 "../src/contacts-linking.vala"
			if (_data_->added_attributes != NULL) {
#line 6705 "contacts-linking.c"
				{
#line 509 "../src/contacts-linking.vala"
					_data_->_tmp20_ = gee_iterable_iterator ((GeeIterable*) _data_->added_attributes);
#line 509 "../src/contacts-linking.vala"
					_data_->_a3_it = _data_->_tmp20_;
#line 509 "../src/contacts-linking.vala"
					while (TRUE) {
#line 509 "../src/contacts-linking.vala"
						_data_->_tmp21_ = _data_->_a3_it;
#line 509 "../src/contacts-linking.vala"
						if (!gee_iterator_next (_data_->_tmp21_)) {
#line 509 "../src/contacts-linking.vala"
							break;
#line 6719 "contacts-linking.c"
						}
#line 509 "../src/contacts-linking.vala"
						_data_->_tmp22_ = _data_->_a3_it;
#line 509 "../src/contacts-linking.vala"
						_data_->_tmp23_ = gee_iterator_get (_data_->_tmp22_);
#line 509 "../src/contacts-linking.vala"
						_data_->a3 = (ContactsPersonaAttribute*) _data_->_tmp23_;
#line 510 "../src/contacts-linking.vala"
						_data_->_tmp24_ = _data_->a3;
#line 510 "../src/contacts-linking.vala"
						_data_->_tmp25_ = _data_->property;
#line 510 "../src/contacts-linking.vala"
						if (contacts_attr_type_equal (_data_->_tmp24_, _data_->_tmp25_)) {
#line 511 "../src/contacts-linking.vala"
							_data_->_tmp26_ = _data_->added;
#line 511 "../src/contacts-linking.vala"
							_data_->_tmp27_ = _data_->a3;
#line 511 "../src/contacts-linking.vala"
							gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp26_, _data_->_tmp27_);
#line 6739 "contacts-linking.c"
						}
#line 509 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->a3);
#line 6743 "contacts-linking.c"
					}
#line 509 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->_a3_it);
#line 6747 "contacts-linking.c"
				}
			}
#line 514 "../src/contacts-linking.vala"
			if (_data_->removed_attributes != NULL) {
#line 6752 "contacts-linking.c"
				{
#line 515 "../src/contacts-linking.vala"
					_data_->_tmp28_ = gee_iterable_iterator ((GeeIterable*) _data_->removed_attributes);
#line 515 "../src/contacts-linking.vala"
					_data_->_a4_it = _data_->_tmp28_;
#line 515 "../src/contacts-linking.vala"
					while (TRUE) {
#line 515 "../src/contacts-linking.vala"
						_data_->_tmp29_ = _data_->_a4_it;
#line 515 "../src/contacts-linking.vala"
						if (!gee_iterator_next (_data_->_tmp29_)) {
#line 515 "../src/contacts-linking.vala"
							break;
#line 6766 "contacts-linking.c"
						}
#line 515 "../src/contacts-linking.vala"
						_data_->_tmp30_ = _data_->_a4_it;
#line 515 "../src/contacts-linking.vala"
						_data_->_tmp31_ = gee_iterator_get (_data_->_tmp30_);
#line 515 "../src/contacts-linking.vala"
						_data_->a4 = (ContactsPersonaAttribute*) _data_->_tmp31_;
#line 516 "../src/contacts-linking.vala"
						_data_->_tmp32_ = _data_->a4;
#line 516 "../src/contacts-linking.vala"
						_data_->_tmp33_ = _data_->property;
#line 516 "../src/contacts-linking.vala"
						if (contacts_attr_type_equal (_data_->_tmp32_, _data_->_tmp33_)) {
#line 517 "../src/contacts-linking.vala"
							_data_->_tmp34_ = _data_->removed;
#line 517 "../src/contacts-linking.vala"
							_data_->_tmp35_ = _data_->a4;
#line 517 "../src/contacts-linking.vala"
							gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp34_, _data_->_tmp35_);
#line 6786 "contacts-linking.c"
						}
#line 515 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->a4);
#line 6790 "contacts-linking.c"
					}
#line 515 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->_a4_it);
#line 6794 "contacts-linking.c"
				}
			}
#line 520 "../src/contacts-linking.vala"
			_data_->_tmp36_ = _data_->property;
#line 520 "../src/contacts-linking.vala"
			_data_->_tmp37_ = _data_->added;
#line 520 "../src/contacts-linking.vala"
			_data_->_tmp38_ = _data_->removed;
#line 520 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 520 "../src/contacts-linking.vala"
			contacts_persona_attribute_persona_apply_attributes (_data_->_tmp36_, _data_->persona, (GeeSet*) _data_->_tmp37_, (GeeSet*) _data_->_tmp38_, _data_->operation, contacts_persona_apply_attributes_ready, _data_);
#line 520 "../src/contacts-linking.vala"
			return FALSE;
#line 6809 "contacts-linking.c"
			_state_1:
#line 520 "../src/contacts-linking.vala"
			contacts_persona_attribute_persona_apply_attributes_finish (_data_->_tmp36_, _data_->_res_);
#line 505 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->removed);
#line 505 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->added);
#line 505 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->property);
#line 6819 "contacts-linking.c"
		}
#line 505 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_property_it);
#line 6823 "contacts-linking.c"
	}
#line 488 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->properties);
#line 488 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 488 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 488 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 488 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 6835 "contacts-linking.c"
		}
	}
#line 488 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 488 "../src/contacts-linking.vala"
	return FALSE;
#line 6842 "contacts-linking.c"
}

static void
contacts_link_contacts_data_free (gpointer _data)
{
	ContactsLinkContactsData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->main);
	_g_object_unref0 (_data_->other);
	_g_object_unref0 (_data_->contacts_store);
	_g_object_unref0 (_data_->result);
	g_slice_free (ContactsLinkContactsData, _data_);
}

void
contacts_link_contacts (FolksIndividual* main,
                        FolksIndividual* other,
                        ContactsStore* contacts_store,
                        GAsyncReadyCallback _callback_,
                        gpointer _user_data_)
{
	ContactsLinkContactsData* _data_;
	FolksIndividual* _tmp0_;
	FolksIndividual* _tmp1_;
	ContactsStore* _tmp2_;
	_data_ = g_slice_new0 (ContactsLinkContactsData);
	_data_->_async_result = g_task_new (NULL, NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, contacts_link_contacts_data_free);
	_tmp0_ = _g_object_ref0 (main);
	_g_object_unref0 (_data_->main);
	_data_->main = _tmp0_;
	_tmp1_ = _g_object_ref0 (other);
	_g_object_unref0 (_data_->other);
	_data_->other = _tmp1_;
	_tmp2_ = _g_object_ref0 (contacts_store);
	_g_object_unref0 (_data_->contacts_store);
	_data_->contacts_store = _tmp2_;
	contacts_link_contacts_co (_data_);
}

ContactsLinkOperation*
contacts_link_contacts_finish (GAsyncResult* _res_)
{
	ContactsLinkOperation* result;
	ContactsLinkContactsData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
	result = _data_->result;
	_data_->result = NULL;
	return result;
}

static void
_g_free0_ (gpointer var)
{
#line 571 "../src/contacts-linking.vala"
	var = (g_free (var), NULL);
#line 6899 "contacts-linking.c"
}

static void
_vala_GValue_free (GValue* self)
{
#line 571 "../src/contacts-linking.vala"
	g_value_unset (self);
#line 571 "../src/contacts-linking.vala"
	g_free (self);
#line 6909 "contacts-linking.c"
}

static void
__vala_GValue_free0_ (gpointer var)
{
#line 571 "../src/contacts-linking.vala"
	(var == NULL) ? NULL : (var = (_vala_GValue_free (var), NULL));
#line 6917 "contacts-linking.c"
}

static GValue*
_g_value_dup (GValue* self)
{
#line 575 "../src/contacts-linking.vala"
	return g_boxed_copy (G_TYPE_VALUE, self);
#line 6925 "contacts-linking.c"
}

static gpointer
__g_value_dup0 (gpointer self)
{
#line 575 "../src/contacts-linking.vala"
	return self ? _g_value_dup (self) : NULL;
#line 6933 "contacts-linking.c"
}

static void
contacts_link_contacts_ready (GObject* source_object,
                              GAsyncResult* _res_,
                              gpointer _user_data_)
{
	ContactsLinkContactsData* _data_;
#line 576 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 576 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 576 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 576 "../src/contacts-linking.vala"
	contacts_link_contacts_co (_data_);
#line 6950 "contacts-linking.c"
}

static gboolean
contacts_link_contacts_co (ContactsLinkContactsData* _data_)
{
#line 524 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 524 "../src/contacts-linking.vala"
		case 0:
#line 6960 "contacts-linking.c"
		goto _state_0;
#line 524 "../src/contacts-linking.vala"
		case 1:
#line 6964 "contacts-linking.c"
		goto _state_1;
#line 524 "../src/contacts-linking.vala"
		case 2:
#line 6968 "contacts-linking.c"
		goto _state_2;
		default:
#line 524 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 6973 "contacts-linking.c"
	}
	_state_0:
#line 527 "../src/contacts-linking.vala"
	g_object_set_data_full ((GObject*) _data_->main, "contacts-master-at-join", (gpointer) ((gintptr) TRUE), NULL);
#line 529 "../src/contacts-linking.vala"
	_data_->_tmp0_ = contacts_link_operation_new ();
#line 529 "../src/contacts-linking.vala"
	_data_->operation = _data_->_tmp0_;
#line 530 "../src/contacts-linking.vala"
	_data_->_tmp1_ = _data_->operation;
#line 530 "../src/contacts-linking.vala"
	contacts_link_operation_set_split_out_contact (_data_->_tmp1_, _data_->other);
#line 532 "../src/contacts-linking.vala"
	_data_->_tmp2_ = contacts_get_linkable_attributes_for_individual (_data_->main);
#line 532 "../src/contacts-linking.vala"
	_data_->main_linkables = _data_->_tmp2_;
#line 533 "../src/contacts-linking.vala"
	_data_->other_linkables = NULL;
#line 534 "../src/contacts-linking.vala"
	if (_data_->other != NULL) {
#line 535 "../src/contacts-linking.vala"
		_data_->_tmp3_ = contacts_get_linkable_attributes_for_individual (_data_->other);
#line 535 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->other_linkables);
#line 535 "../src/contacts-linking.vala"
		_data_->other_linkables = _data_->_tmp3_;
#line 7000 "contacts-linking.c"
	}
#line 536 "../src/contacts-linking.vala"
	_data_->linkables = NULL;
#line 539 "../src/contacts-linking.vala"
	_data_->_tmp4_ = _data_->other_linkables;
#line 539 "../src/contacts-linking.vala"
	if (_data_->_tmp4_ != NULL) {
#line 540 "../src/contacts-linking.vala"
		_data_->_tmp5_ = _data_->main_linkables;
#line 540 "../src/contacts-linking.vala"
		_data_->_tmp6_ = _data_->other_linkables;
#line 540 "../src/contacts-linking.vala"
		gee_collection_remove_all ((GeeCollection*) _data_->_tmp5_, (GeeCollection*) _data_->_tmp6_);
#line 541 "../src/contacts-linking.vala"
		_data_->_tmp7_ = _data_->other_linkables;
#line 541 "../src/contacts-linking.vala"
		_data_->_tmp8_ = _data_->main_linkables;
#line 541 "../src/contacts-linking.vala"
		gee_collection_remove_all ((GeeCollection*) _data_->_tmp7_, (GeeCollection*) _data_->_tmp8_);
#line 7020 "contacts-linking.c"
	}
#line 544 "../src/contacts-linking.vala"
	_data_->write_persona = NULL;
#line 7024 "contacts-linking.c"
	{
#line 545 "../src/contacts-linking.vala"
		_data_->_tmp9_ = folks_individual_get_personas (_data_->main);
#line 545 "../src/contacts-linking.vala"
		_data_->_tmp10_ = _data_->_tmp9_;
#line 545 "../src/contacts-linking.vala"
		_data_->_tmp11_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp10_);
#line 545 "../src/contacts-linking.vala"
		_data_->_p1_it = _data_->_tmp11_;
#line 545 "../src/contacts-linking.vala"
		while (TRUE) {
#line 545 "../src/contacts-linking.vala"
			_data_->_tmp12_ = _data_->_p1_it;
#line 545 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp12_)) {
#line 545 "../src/contacts-linking.vala"
				break;
#line 7042 "contacts-linking.c"
			}
#line 545 "../src/contacts-linking.vala"
			_data_->_tmp13_ = _data_->_p1_it;
#line 545 "../src/contacts-linking.vala"
			_data_->_tmp14_ = gee_iterator_get (_data_->_tmp13_);
#line 545 "../src/contacts-linking.vala"
			_data_->p1 = (FolksPersona*) _data_->_tmp14_;
#line 546 "../src/contacts-linking.vala"
			_data_->_tmp16_ = _data_->other_linkables;
#line 546 "../src/contacts-linking.vala"
			if (_data_->_tmp16_ != NULL) {
#line 547 "../src/contacts-linking.vala"
				_data_->_tmp17_ = _data_->p1;
#line 547 "../src/contacts-linking.vala"
				_data_->_tmp18_ = _data_->other_linkables;
#line 547 "../src/contacts-linking.vala"
				_data_->_tmp15_ = contacts_persona_can_link_to (_data_->_tmp17_, _data_->_tmp18_);
#line 7060 "contacts-linking.c"
			} else {
#line 546 "../src/contacts-linking.vala"
				_data_->_tmp15_ = FALSE;
#line 7064 "contacts-linking.c"
			}
#line 546 "../src/contacts-linking.vala"
			if (_data_->_tmp15_) {
#line 548 "../src/contacts-linking.vala"
				_data_->_tmp19_ = _data_->p1;
#line 548 "../src/contacts-linking.vala"
				_data_->_tmp20_ = _g_object_ref0 (_data_->_tmp19_);
#line 548 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->write_persona);
#line 548 "../src/contacts-linking.vala"
				_data_->write_persona = _data_->_tmp20_;
#line 549 "../src/contacts-linking.vala"
				_data_->_tmp21_ = _data_->other_linkables;
#line 549 "../src/contacts-linking.vala"
				_data_->_tmp22_ = _g_object_ref0 (_data_->_tmp21_);
#line 549 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->linkables);
#line 549 "../src/contacts-linking.vala"
				_data_->linkables = _data_->_tmp22_;
#line 550 "../src/contacts-linking.vala"
				_data_->_tmp23_ = _data_->write_persona;
#line 550 "../src/contacts-linking.vala"
				_data_->_tmp24_ = folks_persona_get_store (_data_->_tmp23_);
#line 550 "../src/contacts-linking.vala"
				_data_->_tmp25_ = _data_->_tmp24_;
#line 550 "../src/contacts-linking.vala"
				_data_->_tmp26_ = folks_persona_store_get_is_primary_store (_data_->_tmp25_);
#line 550 "../src/contacts-linking.vala"
				_data_->_tmp27_ = _data_->_tmp26_;
#line 550 "../src/contacts-linking.vala"
				if (_data_->_tmp27_) {
#line 551 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->p1);
#line 551 "../src/contacts-linking.vala"
					break;
#line 7100 "contacts-linking.c"
				}
			}
#line 545 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->p1);
#line 7105 "contacts-linking.c"
		}
#line 545 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_p1_it);
#line 7109 "contacts-linking.c"
	}
#line 555 "../src/contacts-linking.vala"
	if (_data_->other != NULL) {
#line 556 "../src/contacts-linking.vala"
		_data_->_tmp30_ = _data_->write_persona;
#line 556 "../src/contacts-linking.vala"
		if (_data_->_tmp30_ == NULL) {
#line 556 "../src/contacts-linking.vala"
			_data_->_tmp29_ = TRUE;
#line 7119 "contacts-linking.c"
		} else {
#line 556 "../src/contacts-linking.vala"
			_data_->_tmp31_ = _data_->write_persona;
#line 556 "../src/contacts-linking.vala"
			_data_->_tmp32_ = folks_persona_get_store (_data_->_tmp31_);
#line 556 "../src/contacts-linking.vala"
			_data_->_tmp33_ = _data_->_tmp32_;
#line 556 "../src/contacts-linking.vala"
			_data_->_tmp34_ = folks_persona_store_get_is_primary_store (_data_->_tmp33_);
#line 556 "../src/contacts-linking.vala"
			_data_->_tmp35_ = _data_->_tmp34_;
#line 556 "../src/contacts-linking.vala"
			_data_->_tmp29_ = !_data_->_tmp35_;
#line 7133 "contacts-linking.c"
		}
#line 556 "../src/contacts-linking.vala"
		_data_->_tmp28_ = _data_->_tmp29_;
#line 7137 "contacts-linking.c"
	} else {
#line 555 "../src/contacts-linking.vala"
		_data_->_tmp28_ = FALSE;
#line 7141 "contacts-linking.c"
	}
#line 555 "../src/contacts-linking.vala"
	if (_data_->_tmp28_) {
#line 7145 "contacts-linking.c"
		{
#line 557 "../src/contacts-linking.vala"
			_data_->_tmp36_ = folks_individual_get_personas (_data_->other);
#line 557 "../src/contacts-linking.vala"
			_data_->_tmp37_ = _data_->_tmp36_;
#line 557 "../src/contacts-linking.vala"
			_data_->_tmp38_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp37_);
#line 557 "../src/contacts-linking.vala"
			_data_->_p2_it = _data_->_tmp38_;
#line 557 "../src/contacts-linking.vala"
			while (TRUE) {
#line 557 "../src/contacts-linking.vala"
				_data_->_tmp39_ = _data_->_p2_it;
#line 557 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_data_->_tmp39_)) {
#line 557 "../src/contacts-linking.vala"
					break;
#line 7163 "contacts-linking.c"
				}
#line 557 "../src/contacts-linking.vala"
				_data_->_tmp40_ = _data_->_p2_it;
#line 557 "../src/contacts-linking.vala"
				_data_->_tmp41_ = gee_iterator_get (_data_->_tmp40_);
#line 557 "../src/contacts-linking.vala"
				_data_->p2 = (FolksPersona*) _data_->_tmp41_;
#line 558 "../src/contacts-linking.vala"
				_data_->_tmp42_ = _data_->p2;
#line 558 "../src/contacts-linking.vala"
				_data_->_tmp43_ = _data_->main_linkables;
#line 558 "../src/contacts-linking.vala"
				if (contacts_persona_can_link_to (_data_->_tmp42_, _data_->_tmp43_)) {
#line 560 "../src/contacts-linking.vala"
					_data_->_tmp45_ = _data_->write_persona;
#line 560 "../src/contacts-linking.vala"
					if (_data_->_tmp45_ == NULL) {
#line 560 "../src/contacts-linking.vala"
						_data_->_tmp44_ = TRUE;
#line 7183 "contacts-linking.c"
					} else {
#line 560 "../src/contacts-linking.vala"
						_data_->_tmp46_ = _data_->p2;
#line 560 "../src/contacts-linking.vala"
						_data_->_tmp47_ = folks_persona_get_store (_data_->_tmp46_);
#line 560 "../src/contacts-linking.vala"
						_data_->_tmp48_ = _data_->_tmp47_;
#line 560 "../src/contacts-linking.vala"
						_data_->_tmp49_ = folks_persona_store_get_is_primary_store (_data_->_tmp48_);
#line 560 "../src/contacts-linking.vala"
						_data_->_tmp50_ = _data_->_tmp49_;
#line 560 "../src/contacts-linking.vala"
						_data_->_tmp44_ = _data_->_tmp50_;
#line 7197 "contacts-linking.c"
					}
#line 560 "../src/contacts-linking.vala"
					if (_data_->_tmp44_) {
#line 561 "../src/contacts-linking.vala"
						_data_->_tmp51_ = _data_->p2;
#line 561 "../src/contacts-linking.vala"
						_data_->_tmp52_ = _g_object_ref0 (_data_->_tmp51_);
#line 561 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->write_persona);
#line 561 "../src/contacts-linking.vala"
						_data_->write_persona = _data_->_tmp52_;
#line 562 "../src/contacts-linking.vala"
						_data_->_tmp53_ = _data_->main_linkables;
#line 562 "../src/contacts-linking.vala"
						_data_->_tmp54_ = _g_object_ref0 (_data_->_tmp53_);
#line 562 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->linkables);
#line 562 "../src/contacts-linking.vala"
						_data_->linkables = _data_->_tmp54_;
#line 563 "../src/contacts-linking.vala"
						_data_->_tmp55_ = _data_->write_persona;
#line 563 "../src/contacts-linking.vala"
						_data_->_tmp56_ = folks_persona_get_store (_data_->_tmp55_);
#line 563 "../src/contacts-linking.vala"
						_data_->_tmp57_ = _data_->_tmp56_;
#line 563 "../src/contacts-linking.vala"
						_data_->_tmp58_ = folks_persona_store_get_is_primary_store (_data_->_tmp57_);
#line 563 "../src/contacts-linking.vala"
						_data_->_tmp59_ = _data_->_tmp58_;
#line 563 "../src/contacts-linking.vala"
						if (_data_->_tmp59_) {
#line 564 "../src/contacts-linking.vala"
							_g_object_unref0 (_data_->p2);
#line 564 "../src/contacts-linking.vala"
							break;
#line 7233 "contacts-linking.c"
						}
					}
				}
#line 557 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->p2);
#line 7239 "contacts-linking.c"
			}
#line 557 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_p2_it);
#line 7243 "contacts-linking.c"
		}
	}
#line 570 "../src/contacts-linking.vala"
	_data_->_tmp60_ = _data_->write_persona;
#line 570 "../src/contacts-linking.vala"
	if (_data_->_tmp60_ == NULL) {
#line 571 "../src/contacts-linking.vala"
		_data_->_tmp61_ = g_str_hash;
#line 571 "../src/contacts-linking.vala"
		_data_->_tmp62_ = g_str_equal;
#line 571 "../src/contacts-linking.vala"
		_data_->_tmp63_ = g_hash_table_new_full (_data_->_tmp61_, _data_->_tmp62_, _g_free0_, __vala_GValue_free0_);
#line 571 "../src/contacts-linking.vala"
		_data_->details = _data_->_tmp63_;
#line 7258 "contacts-linking.c"
		{
#line 573 "../src/contacts-linking.vala"
			memset (&_data_->_tmp64_, 0, sizeof (GValue));
#line 573 "../src/contacts-linking.vala"
			g_value_init (&_data_->_tmp64_, G_TYPE_STRING);
#line 573 "../src/contacts-linking.vala"
			_data_->v = _data_->_tmp64_;
#line 574 "../src/contacts-linking.vala"
			_data_->_tmp65_ = folks_individual_get_display_name (_data_->main);
#line 574 "../src/contacts-linking.vala"
			_data_->_tmp66_ = _data_->_tmp65_;
#line 574 "../src/contacts-linking.vala"
			g_value_set_string (&_data_->v, _data_->_tmp66_);
#line 575 "../src/contacts-linking.vala"
			_data_->_tmp67_ = _data_->details;
#line 575 "../src/contacts-linking.vala"
			_data_->_tmp68_ = g_strdup ("full-name");
#line 575 "../src/contacts-linking.vala"
			_data_->_tmp69_ = _data_->v;
#line 575 "../src/contacts-linking.vala"
			_data_->_tmp70_ = _data_->_tmp69_;
#line 575 "../src/contacts-linking.vala"
			_data_->_tmp71_ = __g_value_dup0 (&_data_->_tmp70_);
#line 575 "../src/contacts-linking.vala"
			g_hash_table_insert (_data_->_tmp67_, _data_->_tmp68_, _data_->_tmp71_);
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp73_ = contacts_store_get_aggregator (_data_->contacts_store);
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp74_ = _data_->_tmp73_;
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp75_ = folks_individual_aggregator_get_primary_store (_data_->_tmp74_);
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp76_ = _data_->_tmp75_;
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp77_ = _data_->details;
#line 576 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 576 "../src/contacts-linking.vala"
			folks_persona_store_add_persona_from_details (_data_->_tmp76_, _data_->_tmp77_, contacts_link_contacts_ready, _data_);
#line 576 "../src/contacts-linking.vala"
			return FALSE;
#line 7300 "contacts-linking.c"
			_state_1:
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp78_ = folks_persona_store_add_persona_from_details_finish (_data_->_tmp76_, _data_->_res_, &_data_->_inner_error0_);
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp72_ = _data_->_tmp78_;
#line 576 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 576 "../src/contacts-linking.vala"
				G_IS_VALUE (&_data_->v) ? (g_value_unset (&_data_->v), NULL) : NULL;
#line 7310 "contacts-linking.c"
				goto __catch21_g_error;
			}
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp79_ = _data_->_tmp72_;
#line 576 "../src/contacts-linking.vala"
			_data_->_tmp72_ = NULL;
#line 576 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->write_persona);
#line 576 "../src/contacts-linking.vala"
			_data_->write_persona = _data_->_tmp79_;
#line 577 "../src/contacts-linking.vala"
			_data_->_tmp80_ = _data_->operation;
#line 577 "../src/contacts-linking.vala"
			_data_->_tmp81_ = _data_->write_persona;
#line 577 "../src/contacts-linking.vala"
			contacts_link_operation_added_persona (_data_->_tmp80_, _data_->_tmp81_);
#line 578 "../src/contacts-linking.vala"
			_data_->_tmp82_ = _data_->main_linkables;
#line 578 "../src/contacts-linking.vala"
			_data_->_tmp83_ = _g_object_ref0 (_data_->_tmp82_);
#line 578 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->linkables);
#line 578 "../src/contacts-linking.vala"
			_data_->linkables = _data_->_tmp83_;
#line 579 "../src/contacts-linking.vala"
			_data_->_tmp84_ = _data_->other_linkables;
#line 579 "../src/contacts-linking.vala"
			if (_data_->_tmp84_ != NULL) {
#line 580 "../src/contacts-linking.vala"
				_data_->_tmp85_ = _data_->linkables;
#line 580 "../src/contacts-linking.vala"
				_data_->_tmp86_ = _data_->other_linkables;
#line 580 "../src/contacts-linking.vala"
				gee_collection_add_all ((GeeCollection*) _data_->_tmp85_, (GeeCollection*) _data_->_tmp86_);
#line 7345 "contacts-linking.c"
			}
#line 572 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_tmp72_);
#line 572 "../src/contacts-linking.vala"
			G_IS_VALUE (&_data_->v) ? (g_value_unset (&_data_->v), NULL) : NULL;
#line 7351 "contacts-linking.c"
		}
		goto __finally21;
		__catch21_g_error:
		{
#line 572 "../src/contacts-linking.vala"
			_data_->e = _data_->_inner_error0_;
#line 572 "../src/contacts-linking.vala"
			_data_->_inner_error0_ = NULL;
#line 582 "../src/contacts-linking.vala"
			g_object_set_data_full ((GObject*) _data_->main, "contacts-master-at-join", (gpointer) ((gintptr) FALSE), NULL);
#line 583 "../src/contacts-linking.vala"
			_data_->_tmp87_ = _data_->e;
#line 583 "../src/contacts-linking.vala"
			_data_->_tmp88_ = _data_->_tmp87_->message;
#line 583 "../src/contacts-linking.vala"
			g_warning ("contacts-linking.vala:583: Unable to create new persona when linking: " \
"%s\n", _data_->_tmp88_);
#line 584 "../src/contacts-linking.vala"
			_data_->result = _data_->operation;
#line 584 "../src/contacts-linking.vala"
			_g_error_free0 (_data_->e);
#line 584 "../src/contacts-linking.vala"
			_g_hash_table_unref0 (_data_->details);
#line 584 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->write_persona);
#line 584 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->linkables);
#line 584 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->other_linkables);
#line 584 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->main_linkables);
#line 584 "../src/contacts-linking.vala"
			g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 584 "../src/contacts-linking.vala"
			if (_data_->_state_ != 0) {
#line 584 "../src/contacts-linking.vala"
				while (!g_task_get_completed (_data_->_async_result)) {
#line 584 "../src/contacts-linking.vala"
					g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 7390 "contacts-linking.c"
				}
			}
#line 584 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 584 "../src/contacts-linking.vala"
			return FALSE;
#line 7397 "contacts-linking.c"
		}
		__finally21:
#line 572 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 572 "../src/contacts-linking.vala"
			_g_hash_table_unref0 (_data_->details);
#line 572 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->write_persona);
#line 572 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->linkables);
#line 572 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->other_linkables);
#line 572 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->main_linkables);
#line 572 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->operation);
#line 572 "../src/contacts-linking.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 572 "../src/contacts-linking.vala"
			g_clear_error (&_data_->_inner_error0_);
#line 572 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 572 "../src/contacts-linking.vala"
			return FALSE;
#line 7422 "contacts-linking.c"
		}
#line 570 "../src/contacts-linking.vala"
		_g_hash_table_unref0 (_data_->details);
#line 7426 "contacts-linking.c"
	}
#line 588 "../src/contacts-linking.vala"
	_data_->_tmp89_ = _data_->write_persona;
#line 588 "../src/contacts-linking.vala"
	_data_->_tmp90_ = _data_->linkables;
#line 588 "../src/contacts-linking.vala"
	_data_->_tmp91_ = _data_->operation;
#line 588 "../src/contacts-linking.vala"
	_data_->_state_ = 2;
#line 588 "../src/contacts-linking.vala"
	contacts_persona_apply_attributes (_data_->_tmp89_, _data_->_tmp90_, NULL, _data_->_tmp91_, contacts_link_contacts_ready, _data_);
#line 588 "../src/contacts-linking.vala"
	return FALSE;
#line 7440 "contacts-linking.c"
	_state_2:
#line 588 "../src/contacts-linking.vala"
	contacts_persona_apply_attributes_finish (_data_->_res_);
#line 590 "../src/contacts-linking.vala"
	g_object_set_data_full ((GObject*) _data_->main, "contacts-master-at-join", (gpointer) ((gintptr) FALSE), NULL);
#line 592 "../src/contacts-linking.vala"
	_data_->result = _data_->operation;
#line 592 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->write_persona);
#line 592 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->linkables);
#line 592 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->other_linkables);
#line 592 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->main_linkables);
#line 592 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 592 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 592 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 592 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 7464 "contacts-linking.c"
		}
	}
#line 592 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 592 "../src/contacts-linking.vala"
	return FALSE;
#line 7471 "contacts-linking.c"
}

static void
contacts_unlink_persona_data_free (gpointer _data)
{
	ContactsUnlinkPersonaData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->store);
	_g_object_unref0 (_data_->individual);
	_g_object_unref0 (_data_->persona_to_unlink);
	_g_object_unref0 (_data_->result);
	g_slice_free (ContactsUnlinkPersonaData, _data_);
}

void
contacts_unlink_persona (ContactsStore* store,
                         FolksIndividual* individual,
                         FolksPersona* persona_to_unlink,
                         GAsyncReadyCallback _callback_,
                         gpointer _user_data_)
{
	ContactsUnlinkPersonaData* _data_;
	ContactsStore* _tmp0_;
	FolksIndividual* _tmp1_;
	FolksPersona* _tmp2_;
	_data_ = g_slice_new0 (ContactsUnlinkPersonaData);
	_data_->_async_result = g_task_new (NULL, NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, contacts_unlink_persona_data_free);
	_tmp0_ = _g_object_ref0 (store);
	_g_object_unref0 (_data_->store);
	_data_->store = _tmp0_;
	_tmp1_ = _g_object_ref0 (individual);
	_g_object_unref0 (_data_->individual);
	_data_->individual = _tmp1_;
	_tmp2_ = _g_object_ref0 (persona_to_unlink);
	_g_object_unref0 (_data_->persona_to_unlink);
	_data_->persona_to_unlink = _tmp2_;
	contacts_unlink_persona_co (_data_);
}

ContactsLinkOperation*
contacts_unlink_persona_finish (GAsyncResult* _res_)
{
	ContactsLinkOperation* result;
	ContactsUnlinkPersonaData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
	result = _data_->result;
	_data_->result = NULL;
	return result;
}

static void
contacts_unlink_persona_ready (GObject* source_object,
                               GAsyncResult* _res_,
                               gpointer _user_data_)
{
	ContactsUnlinkPersonaData* _data_;
#line 678 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 678 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 678 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 678 "../src/contacts-linking.vala"
	contacts_unlink_persona_co (_data_);
#line 7537 "contacts-linking.c"
}

static gboolean
contacts_unlink_persona_co (ContactsUnlinkPersonaData* _data_)
{
#line 595 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 595 "../src/contacts-linking.vala"
		case 0:
#line 7547 "contacts-linking.c"
		goto _state_0;
#line 595 "../src/contacts-linking.vala"
		case 1:
#line 7551 "contacts-linking.c"
		goto _state_1;
#line 595 "../src/contacts-linking.vala"
		case 2:
#line 7555 "contacts-linking.c"
		goto _state_2;
#line 595 "../src/contacts-linking.vala"
		case 3:
#line 7559 "contacts-linking.c"
		goto _state_3;
#line 595 "../src/contacts-linking.vala"
		case 4:
#line 7563 "contacts-linking.c"
		goto _state_4;
#line 595 "../src/contacts-linking.vala"
		case 5:
#line 7567 "contacts-linking.c"
		goto _state_5;
		default:
#line 595 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 7572 "contacts-linking.c"
	}
	_state_0:
#line 596 "../src/contacts-linking.vala"
	_data_->_tmp0_ = contacts_persona_attribute_create_set ();
#line 596 "../src/contacts-linking.vala"
	_data_->persona_to_unlink_removals = _data_->_tmp0_;
#line 597 "../src/contacts-linking.vala"
	_data_->_tmp1_ = contacts_persona_attribute_create_set ();
#line 597 "../src/contacts-linking.vala"
	_data_->other_personas_removals = _data_->_tmp1_;
#line 599 "../src/contacts-linking.vala"
	_data_->_tmp2_ = contacts_link_operation_new ();
#line 599 "../src/contacts-linking.vala"
	_data_->operation = _data_->_tmp2_;
#line 600 "../src/contacts-linking.vala"
	_data_->_tmp3_ = _data_->operation;
#line 600 "../src/contacts-linking.vala"
	contacts_link_operation_set_main_contact (_data_->_tmp3_, _data_->individual);
#line 7591 "contacts-linking.c"
	{
#line 602 "../src/contacts-linking.vala"
		_data_->_tmp4_ = contacts_get_linkable_attributes (_data_->persona_to_unlink);
#line 602 "../src/contacts-linking.vala"
		_data_->_tmp5_ = _data_->_tmp4_;
#line 602 "../src/contacts-linking.vala"
		_data_->_tmp6_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp5_);
#line 602 "../src/contacts-linking.vala"
		_data_->_tmp7_ = _data_->_tmp6_;
#line 602 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_tmp5_);
#line 602 "../src/contacts-linking.vala"
		_data_->_a1_it = _data_->_tmp7_;
#line 602 "../src/contacts-linking.vala"
		while (TRUE) {
#line 602 "../src/contacts-linking.vala"
			_data_->_tmp8_ = _data_->_a1_it;
#line 602 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp8_)) {
#line 602 "../src/contacts-linking.vala"
				break;
#line 7613 "contacts-linking.c"
			}
#line 602 "../src/contacts-linking.vala"
			_data_->_tmp9_ = _data_->_a1_it;
#line 602 "../src/contacts-linking.vala"
			_data_->_tmp10_ = gee_iterator_get (_data_->_tmp9_);
#line 602 "../src/contacts-linking.vala"
			_data_->a1 = (ContactsPersonaAttribute*) _data_->_tmp10_;
#line 604 "../src/contacts-linking.vala"
			_data_->used_to_link = FALSE;
#line 7623 "contacts-linking.c"
			{
#line 605 "../src/contacts-linking.vala"
				_data_->_tmp11_ = folks_individual_get_personas (_data_->individual);
#line 605 "../src/contacts-linking.vala"
				_data_->_tmp12_ = _data_->_tmp11_;
#line 605 "../src/contacts-linking.vala"
				_data_->_tmp13_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp12_);
#line 605 "../src/contacts-linking.vala"
				_data_->_persona_it = _data_->_tmp13_;
#line 605 "../src/contacts-linking.vala"
				while (TRUE) {
#line 605 "../src/contacts-linking.vala"
					_data_->_tmp14_ = _data_->_persona_it;
#line 605 "../src/contacts-linking.vala"
					if (!gee_iterator_next (_data_->_tmp14_)) {
#line 605 "../src/contacts-linking.vala"
						break;
#line 7641 "contacts-linking.c"
					}
#line 605 "../src/contacts-linking.vala"
					_data_->_tmp15_ = _data_->_persona_it;
#line 605 "../src/contacts-linking.vala"
					_data_->_tmp16_ = gee_iterator_get (_data_->_tmp15_);
#line 605 "../src/contacts-linking.vala"
					_data_->persona = (FolksPersona*) _data_->_tmp16_;
#line 606 "../src/contacts-linking.vala"
					_data_->_tmp18_ = _data_->persona;
#line 606 "../src/contacts-linking.vala"
					if (_data_->_tmp18_ != _data_->persona_to_unlink) {
#line 607 "../src/contacts-linking.vala"
						_data_->_tmp19_ = _data_->a1;
#line 607 "../src/contacts-linking.vala"
						_data_->_tmp20_ = _data_->persona;
#line 607 "../src/contacts-linking.vala"
						_data_->_tmp17_ = contacts_persona_attribute_is_referenced_by_persona (_data_->_tmp19_, _data_->_tmp20_);
#line 7659 "contacts-linking.c"
					} else {
#line 606 "../src/contacts-linking.vala"
						_data_->_tmp17_ = FALSE;
#line 7663 "contacts-linking.c"
					}
#line 606 "../src/contacts-linking.vala"
					if (_data_->_tmp17_) {
#line 608 "../src/contacts-linking.vala"
						_data_->used_to_link = TRUE;
#line 609 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->persona);
#line 609 "../src/contacts-linking.vala"
						break;
#line 7673 "contacts-linking.c"
					}
#line 605 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->persona);
#line 7677 "contacts-linking.c"
				}
#line 605 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_persona_it);
#line 7681 "contacts-linking.c"
			}
#line 612 "../src/contacts-linking.vala"
			if (!_data_->used_to_link) {
#line 613 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->a1);
#line 613 "../src/contacts-linking.vala"
				continue;
#line 7689 "contacts-linking.c"
			}
#line 615 "../src/contacts-linking.vala"
			_data_->_tmp21_ = _data_->a1;
#line 615 "../src/contacts-linking.vala"
			if (contacts_persona_attribute_is_removable (_data_->_tmp21_, _data_->persona_to_unlink)) {
#line 618 "../src/contacts-linking.vala"
				_data_->_tmp22_ = _data_->persona_to_unlink_removals;
#line 618 "../src/contacts-linking.vala"
				_data_->_tmp23_ = _data_->a1;
#line 618 "../src/contacts-linking.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp22_, _data_->_tmp23_);
#line 7701 "contacts-linking.c"
			} else {
#line 622 "../src/contacts-linking.vala"
				_data_->_tmp24_ = _data_->other_personas_removals;
#line 622 "../src/contacts-linking.vala"
				_data_->_tmp25_ = _data_->a1;
#line 622 "../src/contacts-linking.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp24_, _data_->_tmp25_);
#line 7709 "contacts-linking.c"
			}
#line 602 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->a1);
#line 7713 "contacts-linking.c"
		}
#line 602 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_a1_it);
#line 7717 "contacts-linking.c"
	}
#line 642 "../src/contacts-linking.vala"
	_data_->_tmp26_ = contacts_persona_attribute_create_set ();
#line 642 "../src/contacts-linking.vala"
	_data_->main_persona_additions = _data_->_tmp26_;
#line 7723 "contacts-linking.c"
	{
#line 643 "../src/contacts-linking.vala"
		_data_->_tmp27_ = folks_individual_get_personas (_data_->individual);
#line 643 "../src/contacts-linking.vala"
		_data_->_tmp28_ = _data_->_tmp27_;
#line 643 "../src/contacts-linking.vala"
		_data_->_tmp29_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp28_);
#line 643 "../src/contacts-linking.vala"
		_data_->_p1_it = _data_->_tmp29_;
#line 643 "../src/contacts-linking.vala"
		while (TRUE) {
#line 643 "../src/contacts-linking.vala"
			_data_->_tmp30_ = _data_->_p1_it;
#line 643 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp30_)) {
#line 643 "../src/contacts-linking.vala"
				break;
#line 7741 "contacts-linking.c"
			}
#line 643 "../src/contacts-linking.vala"
			_data_->_tmp31_ = _data_->_p1_it;
#line 643 "../src/contacts-linking.vala"
			_data_->_tmp32_ = gee_iterator_get (_data_->_tmp31_);
#line 643 "../src/contacts-linking.vala"
			_data_->p1 = (FolksPersona*) _data_->_tmp32_;
#line 644 "../src/contacts-linking.vala"
			_data_->_tmp33_ = _data_->p1;
#line 644 "../src/contacts-linking.vala"
			if (_data_->_tmp33_ == _data_->persona_to_unlink) {
#line 645 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->p1);
#line 645 "../src/contacts-linking.vala"
				continue;
#line 7757 "contacts-linking.c"
			}
			{
#line 646 "../src/contacts-linking.vala"
				_data_->_tmp34_ = _data_->p1;
#line 646 "../src/contacts-linking.vala"
				_data_->_tmp35_ = contacts_get_linkable_attributes (_data_->_tmp34_);
#line 646 "../src/contacts-linking.vala"
				_data_->_tmp36_ = _data_->_tmp35_;
#line 646 "../src/contacts-linking.vala"
				_data_->_tmp37_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp36_);
#line 646 "../src/contacts-linking.vala"
				_data_->_tmp38_ = _data_->_tmp37_;
#line 646 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_tmp36_);
#line 646 "../src/contacts-linking.vala"
				_data_->_a2_it = _data_->_tmp38_;
#line 646 "../src/contacts-linking.vala"
				while (TRUE) {
#line 646 "../src/contacts-linking.vala"
					_data_->_tmp39_ = _data_->_a2_it;
#line 646 "../src/contacts-linking.vala"
					if (!gee_iterator_next (_data_->_tmp39_)) {
#line 646 "../src/contacts-linking.vala"
						break;
#line 7782 "contacts-linking.c"
					}
#line 646 "../src/contacts-linking.vala"
					_data_->_tmp40_ = _data_->_a2_it;
#line 646 "../src/contacts-linking.vala"
					_data_->_tmp41_ = gee_iterator_get (_data_->_tmp40_);
#line 646 "../src/contacts-linking.vala"
					_data_->a2 = (ContactsPersonaAttribute*) _data_->_tmp41_;
#line 647 "../src/contacts-linking.vala"
					_data_->_tmp42_ = _data_->other_personas_removals;
#line 647 "../src/contacts-linking.vala"
					_data_->_tmp43_ = _data_->a2;
#line 647 "../src/contacts-linking.vala"
					if (gee_abstract_collection_contains ((GeeAbstractCollection*) _data_->_tmp42_, _data_->_tmp43_)) {
#line 648 "../src/contacts-linking.vala"
						_g_object_unref0 (_data_->a2);
#line 648 "../src/contacts-linking.vala"
						continue;
#line 7800 "contacts-linking.c"
					}
#line 649 "../src/contacts-linking.vala"
					_data_->_tmp44_ = _data_->main_persona_additions;
#line 649 "../src/contacts-linking.vala"
					_data_->_tmp45_ = _data_->a2;
#line 649 "../src/contacts-linking.vala"
					gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp44_, _data_->_tmp45_);
#line 646 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->a2);
#line 7810 "contacts-linking.c"
				}
#line 646 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_a2_it);
#line 7814 "contacts-linking.c"
			}
#line 643 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->p1);
#line 7818 "contacts-linking.c"
		}
#line 643 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_p1_it);
#line 7822 "contacts-linking.c"
	}
#line 655 "../src/contacts-linking.vala"
	_data_->main_persona = NULL;
#line 7826 "contacts-linking.c"
	{
#line 656 "../src/contacts-linking.vala"
		_data_->_tmp46_ = folks_individual_get_personas (_data_->individual);
#line 656 "../src/contacts-linking.vala"
		_data_->_tmp47_ = _data_->_tmp46_;
#line 656 "../src/contacts-linking.vala"
		_data_->_tmp48_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp47_);
#line 656 "../src/contacts-linking.vala"
		_data_->_p2_it = _data_->_tmp48_;
#line 656 "../src/contacts-linking.vala"
		while (TRUE) {
#line 656 "../src/contacts-linking.vala"
			_data_->_tmp49_ = _data_->_p2_it;
#line 656 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp49_)) {
#line 656 "../src/contacts-linking.vala"
				break;
#line 7844 "contacts-linking.c"
			}
#line 656 "../src/contacts-linking.vala"
			_data_->_tmp50_ = _data_->_p2_it;
#line 656 "../src/contacts-linking.vala"
			_data_->_tmp51_ = gee_iterator_get (_data_->_tmp50_);
#line 656 "../src/contacts-linking.vala"
			_data_->p2 = (FolksPersona*) _data_->_tmp51_;
#line 657 "../src/contacts-linking.vala"
			_data_->_tmp53_ = _data_->p2;
#line 657 "../src/contacts-linking.vala"
			if (_data_->_tmp53_ != _data_->persona_to_unlink) {
#line 657 "../src/contacts-linking.vala"
				_data_->_tmp54_ = _data_->p2;
#line 657 "../src/contacts-linking.vala"
				_data_->_tmp55_ = _data_->main_persona_additions;
#line 657 "../src/contacts-linking.vala"
				_data_->_tmp52_ = contacts_persona_can_link_to (_data_->_tmp54_, (GeeSet*) _data_->_tmp55_);
#line 7862 "contacts-linking.c"
			} else {
#line 657 "../src/contacts-linking.vala"
				_data_->_tmp52_ = FALSE;
#line 7866 "contacts-linking.c"
			}
#line 657 "../src/contacts-linking.vala"
			if (_data_->_tmp52_) {
#line 658 "../src/contacts-linking.vala"
				_data_->_tmp56_ = _data_->p2;
#line 658 "../src/contacts-linking.vala"
				_data_->_tmp57_ = _g_object_ref0 (_data_->_tmp56_);
#line 658 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->main_persona);
#line 658 "../src/contacts-linking.vala"
				_data_->main_persona = _data_->_tmp57_;
#line 659 "../src/contacts-linking.vala"
				_data_->_tmp58_ = _data_->main_persona;
#line 659 "../src/contacts-linking.vala"
				_data_->_tmp59_ = folks_persona_get_store (_data_->_tmp58_);
#line 659 "../src/contacts-linking.vala"
				_data_->_tmp60_ = _data_->_tmp59_;
#line 659 "../src/contacts-linking.vala"
				_data_->_tmp61_ = folks_persona_store_get_is_primary_store (_data_->_tmp60_);
#line 659 "../src/contacts-linking.vala"
				_data_->_tmp62_ = _data_->_tmp61_;
#line 659 "../src/contacts-linking.vala"
				if (_data_->_tmp62_) {
#line 660 "../src/contacts-linking.vala"
					_g_object_unref0 (_data_->p2);
#line 660 "../src/contacts-linking.vala"
					break;
#line 7894 "contacts-linking.c"
				}
			}
#line 656 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->p2);
#line 7899 "contacts-linking.c"
		}
#line 656 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_p2_it);
#line 7903 "contacts-linking.c"
	}
#line 666 "../src/contacts-linking.vala"
	_data_->_tmp63_ = gee_hash_set_new (FOLKS_TYPE_PERSONA, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL);
#line 666 "../src/contacts-linking.vala"
	_data_->other_personas = _data_->_tmp63_;
#line 7909 "contacts-linking.c"
	{
#line 667 "../src/contacts-linking.vala"
		_data_->_tmp64_ = folks_individual_get_personas (_data_->individual);
#line 667 "../src/contacts-linking.vala"
		_data_->_tmp65_ = _data_->_tmp64_;
#line 667 "../src/contacts-linking.vala"
		_data_->_tmp66_ = gee_iterable_iterator ((GeeIterable*) _data_->_tmp65_);
#line 667 "../src/contacts-linking.vala"
		_data_->_p3_it = _data_->_tmp66_;
#line 667 "../src/contacts-linking.vala"
		while (TRUE) {
#line 667 "../src/contacts-linking.vala"
			_data_->_tmp67_ = _data_->_p3_it;
#line 667 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp67_)) {
#line 667 "../src/contacts-linking.vala"
				break;
#line 7927 "contacts-linking.c"
			}
#line 667 "../src/contacts-linking.vala"
			_data_->_tmp68_ = _data_->_p3_it;
#line 667 "../src/contacts-linking.vala"
			_data_->_tmp69_ = gee_iterator_get (_data_->_tmp68_);
#line 667 "../src/contacts-linking.vala"
			_data_->p3 = (FolksPersona*) _data_->_tmp69_;
#line 668 "../src/contacts-linking.vala"
			_data_->_tmp71_ = _data_->p3;
#line 668 "../src/contacts-linking.vala"
			if (_data_->_tmp71_ != _data_->persona_to_unlink) {
#line 669 "../src/contacts-linking.vala"
				_data_->_tmp72_ = _data_->p3;
#line 669 "../src/contacts-linking.vala"
				_data_->_tmp73_ = _data_->main_persona;
#line 669 "../src/contacts-linking.vala"
				_data_->_tmp70_ = _data_->_tmp72_ != _data_->_tmp73_;
#line 7945 "contacts-linking.c"
			} else {
#line 668 "../src/contacts-linking.vala"
				_data_->_tmp70_ = FALSE;
#line 7949 "contacts-linking.c"
			}
#line 668 "../src/contacts-linking.vala"
			if (_data_->_tmp70_) {
#line 670 "../src/contacts-linking.vala"
				_data_->_tmp74_ = _data_->other_personas;
#line 670 "../src/contacts-linking.vala"
				_data_->_tmp75_ = _data_->p3;
#line 670 "../src/contacts-linking.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) _data_->_tmp74_, _data_->_tmp75_);
#line 7959 "contacts-linking.c"
			}
#line 667 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->p3);
#line 7963 "contacts-linking.c"
		}
#line 667 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_p3_it);
#line 7967 "contacts-linking.c"
	}
#line 675 "../src/contacts-linking.vala"
	_data_->_tmp77_ = _data_->main_persona;
#line 675 "../src/contacts-linking.vala"
	if (_data_->_tmp77_ == NULL) {
#line 675 "../src/contacts-linking.vala"
		_data_->_tmp78_ = _data_->other_personas;
#line 675 "../src/contacts-linking.vala"
		_data_->_tmp79_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _data_->_tmp78_);
#line 675 "../src/contacts-linking.vala"
		_data_->_tmp80_ = _data_->_tmp79_;
#line 675 "../src/contacts-linking.vala"
		_data_->_tmp76_ = _data_->_tmp80_ > 1;
#line 7981 "contacts-linking.c"
	} else {
#line 675 "../src/contacts-linking.vala"
		_data_->_tmp76_ = FALSE;
#line 7985 "contacts-linking.c"
	}
#line 675 "../src/contacts-linking.vala"
	if (_data_->_tmp76_) {
#line 676 "../src/contacts-linking.vala"
		_data_->_tmp81_ = g_str_hash;
#line 676 "../src/contacts-linking.vala"
		_data_->_tmp82_ = g_str_equal;
#line 676 "../src/contacts-linking.vala"
		_data_->_tmp83_ = g_hash_table_new_full (_data_->_tmp81_, _data_->_tmp82_, _g_free0_, __vala_GValue_free0_);
#line 676 "../src/contacts-linking.vala"
		_data_->details = _data_->_tmp83_;
#line 7997 "contacts-linking.c"
		{
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp85_ = contacts_store_get_aggregator (_data_->store);
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp86_ = _data_->_tmp85_;
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp87_ = folks_individual_aggregator_get_primary_store (_data_->_tmp86_);
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp88_ = _data_->_tmp87_;
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp89_ = _data_->details;
#line 678 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 678 "../src/contacts-linking.vala"
			folks_persona_store_add_persona_from_details (_data_->_tmp88_, _data_->_tmp89_, contacts_unlink_persona_ready, _data_);
#line 678 "../src/contacts-linking.vala"
			return FALSE;
#line 8015 "contacts-linking.c"
			_state_1:
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp90_ = folks_persona_store_add_persona_from_details_finish (_data_->_tmp88_, _data_->_res_, &_data_->_inner_error0_);
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp84_ = _data_->_tmp90_;
#line 678 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 8023 "contacts-linking.c"
				goto __catch22_g_error;
			}
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp91_ = _data_->_tmp84_;
#line 678 "../src/contacts-linking.vala"
			_data_->_tmp84_ = NULL;
#line 678 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->main_persona);
#line 678 "../src/contacts-linking.vala"
			_data_->main_persona = _data_->_tmp91_;
#line 679 "../src/contacts-linking.vala"
			_data_->_tmp92_ = _data_->main_persona;
#line 679 "../src/contacts-linking.vala"
			_data_->_tmp93_ = folks_individual_get_display_name (_data_->individual);
#line 679 "../src/contacts-linking.vala"
			_data_->_tmp94_ = _data_->_tmp93_;
#line 679 "../src/contacts-linking.vala"
			_data_->_state_ = 2;
#line 679 "../src/contacts-linking.vala"
			folks_name_details_change_full_name (G_TYPE_CHECK_INSTANCE_TYPE (_data_->_tmp92_, FOLKS_TYPE_NAME_DETAILS) ? ((FolksNameDetails*) _data_->_tmp92_) : NULL, _data_->_tmp94_, contacts_unlink_persona_ready, _data_);
#line 679 "../src/contacts-linking.vala"
			return FALSE;
#line 8046 "contacts-linking.c"
			_state_2:
#line 679 "../src/contacts-linking.vala"
			folks_name_details_change_full_name_finish (G_TYPE_CHECK_INSTANCE_TYPE (_data_->_tmp92_, FOLKS_TYPE_NAME_DETAILS) ? ((FolksNameDetails*) _data_->_tmp92_) : NULL, _data_->_res_, &_data_->_inner_error0_);
#line 679 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 679 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_tmp84_);
#line 8054 "contacts-linking.c"
				goto __catch22_g_error;
			}
#line 680 "../src/contacts-linking.vala"
			_data_->_tmp95_ = _data_->operation;
#line 680 "../src/contacts-linking.vala"
			_data_->_tmp96_ = _data_->main_persona;
#line 680 "../src/contacts-linking.vala"
			contacts_link_operation_added_persona (_data_->_tmp95_, _data_->_tmp96_);
#line 677 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_tmp84_);
#line 8065 "contacts-linking.c"
		}
		goto __finally22;
		__catch22_g_error:
		{
#line 677 "../src/contacts-linking.vala"
			_data_->e = _data_->_inner_error0_;
#line 677 "../src/contacts-linking.vala"
			_data_->_inner_error0_ = NULL;
#line 682 "../src/contacts-linking.vala"
			_data_->_tmp97_ = _data_->e;
#line 682 "../src/contacts-linking.vala"
			_data_->_tmp98_ = _data_->_tmp97_->message;
#line 682 "../src/contacts-linking.vala"
			g_warning ("contacts-linking.vala:682: Unable to create new persona when unlinking" \
": %s\n", _data_->_tmp98_);
#line 683 "../src/contacts-linking.vala"
			_data_->result = _data_->operation;
#line 683 "../src/contacts-linking.vala"
			_g_error_free0 (_data_->e);
#line 683 "../src/contacts-linking.vala"
			_g_hash_table_unref0 (_data_->details);
#line 683 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->other_personas);
#line 683 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->main_persona);
#line 683 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->main_persona_additions);
#line 683 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->other_personas_removals);
#line 683 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->persona_to_unlink_removals);
#line 683 "../src/contacts-linking.vala"
			g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 683 "../src/contacts-linking.vala"
			if (_data_->_state_ != 0) {
#line 683 "../src/contacts-linking.vala"
				while (!g_task_get_completed (_data_->_async_result)) {
#line 683 "../src/contacts-linking.vala"
					g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 8104 "contacts-linking.c"
				}
			}
#line 683 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 683 "../src/contacts-linking.vala"
			return FALSE;
#line 8111 "contacts-linking.c"
		}
		__finally22:
#line 677 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 677 "../src/contacts-linking.vala"
			_g_hash_table_unref0 (_data_->details);
#line 677 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->other_personas);
#line 677 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->main_persona);
#line 677 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->main_persona_additions);
#line 677 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->operation);
#line 677 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->other_personas_removals);
#line 677 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->persona_to_unlink_removals);
#line 677 "../src/contacts-linking.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 677 "../src/contacts-linking.vala"
			g_clear_error (&_data_->_inner_error0_);
#line 677 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 677 "../src/contacts-linking.vala"
			return FALSE;
#line 8138 "contacts-linking.c"
		}
#line 675 "../src/contacts-linking.vala"
		_g_hash_table_unref0 (_data_->details);
#line 8142 "contacts-linking.c"
	}
#line 687 "../src/contacts-linking.vala"
	g_object_set_data_full ((GObject*) _data_->persona_to_unlink, "contacts-new-contact", (gpointer) ((gintptr) TRUE), NULL);
#line 691 "../src/contacts-linking.vala"
	_data_->_tmp99_ = _data_->main_persona;
#line 691 "../src/contacts-linking.vala"
	if (_data_->_tmp99_ != NULL) {
#line 692 "../src/contacts-linking.vala"
		_data_->_tmp100_ = _data_->main_persona;
#line 692 "../src/contacts-linking.vala"
		_data_->_tmp101_ = _data_->main_persona_additions;
#line 692 "../src/contacts-linking.vala"
		_data_->_tmp102_ = _data_->other_personas_removals;
#line 692 "../src/contacts-linking.vala"
		_data_->_tmp103_ = _data_->operation;
#line 692 "../src/contacts-linking.vala"
		_data_->_state_ = 3;
#line 692 "../src/contacts-linking.vala"
		contacts_persona_apply_attributes (_data_->_tmp100_, (GeeSet*) _data_->_tmp101_, (GeeSet*) _data_->_tmp102_, _data_->_tmp103_, contacts_unlink_persona_ready, _data_);
#line 692 "../src/contacts-linking.vala"
		return FALSE;
#line 8164 "contacts-linking.c"
		_state_3:
#line 692 "../src/contacts-linking.vala"
		contacts_persona_apply_attributes_finish (_data_->_res_);
#line 8168 "contacts-linking.c"
	}
	{
#line 693 "../src/contacts-linking.vala"
		_data_->_tmp104_ = _data_->other_personas;
#line 693 "../src/contacts-linking.vala"
		_data_->_tmp105_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _data_->_tmp104_);
#line 693 "../src/contacts-linking.vala"
		_data_->_p_it = _data_->_tmp105_;
#line 693 "../src/contacts-linking.vala"
		while (TRUE) {
#line 693 "../src/contacts-linking.vala"
			_data_->_tmp106_ = _data_->_p_it;
#line 693 "../src/contacts-linking.vala"
			if (!gee_iterator_next (_data_->_tmp106_)) {
#line 693 "../src/contacts-linking.vala"
				break;
#line 8185 "contacts-linking.c"
			}
#line 693 "../src/contacts-linking.vala"
			_data_->_tmp107_ = _data_->_p_it;
#line 693 "../src/contacts-linking.vala"
			_data_->_tmp108_ = gee_iterator_get (_data_->_tmp107_);
#line 693 "../src/contacts-linking.vala"
			_data_->p = (FolksPersona*) _data_->_tmp108_;
#line 694 "../src/contacts-linking.vala"
			_data_->_tmp109_ = _data_->p;
#line 694 "../src/contacts-linking.vala"
			_data_->_tmp110_ = _data_->other_personas_removals;
#line 694 "../src/contacts-linking.vala"
			_data_->_tmp111_ = _data_->operation;
#line 694 "../src/contacts-linking.vala"
			_data_->_state_ = 4;
#line 694 "../src/contacts-linking.vala"
			contacts_persona_apply_attributes (_data_->_tmp109_, NULL, (GeeSet*) _data_->_tmp110_, _data_->_tmp111_, contacts_unlink_persona_ready, _data_);
#line 694 "../src/contacts-linking.vala"
			return FALSE;
#line 8205 "contacts-linking.c"
			_state_4:
#line 694 "../src/contacts-linking.vala"
			contacts_persona_apply_attributes_finish (_data_->_res_);
#line 693 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->p);
#line 8211 "contacts-linking.c"
		}
#line 693 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_p_it);
#line 8215 "contacts-linking.c"
	}
#line 697 "../src/contacts-linking.vala"
	_data_->_tmp112_ = _data_->persona_to_unlink_removals;
#line 697 "../src/contacts-linking.vala"
	_data_->_tmp113_ = _data_->operation;
#line 697 "../src/contacts-linking.vala"
	_data_->_state_ = 5;
#line 697 "../src/contacts-linking.vala"
	contacts_persona_apply_attributes (_data_->persona_to_unlink, NULL, (GeeSet*) _data_->_tmp112_, _data_->_tmp113_, contacts_unlink_persona_ready, _data_);
#line 697 "../src/contacts-linking.vala"
	return FALSE;
#line 8227 "contacts-linking.c"
	_state_5:
#line 697 "../src/contacts-linking.vala"
	contacts_persona_apply_attributes_finish (_data_->_res_);
#line 699 "../src/contacts-linking.vala"
	g_object_set_data_full ((GObject*) _data_->persona_to_unlink, "contacts-new-contact", (gpointer) ((gintptr) FALSE), NULL);
#line 701 "../src/contacts-linking.vala"
	_data_->result = _data_->operation;
#line 701 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->other_personas);
#line 701 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->main_persona);
#line 701 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->main_persona_additions);
#line 701 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->other_personas_removals);
#line 701 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->persona_to_unlink_removals);
#line 701 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 701 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 701 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 701 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 8253 "contacts-linking.c"
		}
	}
#line 701 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 701 "../src/contacts-linking.vala"
	return FALSE;
#line 8260 "contacts-linking.c"
}

static inline gpointer
contacts_link_operation2_get_instance_private (ContactsLinkOperation2* self)
{
	return G_STRUCT_MEMBER_P (self, ContactsLinkOperation2_private_offset);
}

ContactsLinkOperation2*
contacts_link_operation2_construct (GType object_type,
                                    ContactsStore* contacts_store)
{
	ContactsLinkOperation2 * self = NULL;
	ContactsStore* _tmp0_;
	GeeLinkedList* _tmp1_;
#line 711 "../src/contacts-linking.vala"
	g_return_val_if_fail (contacts_store != NULL, NULL);
#line 711 "../src/contacts-linking.vala"
	self = (ContactsLinkOperation2*) g_object_new (object_type, NULL);
#line 712 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (contacts_store);
#line 712 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->contacts_store);
#line 712 "../src/contacts-linking.vala"
	self->priv->contacts_store = _tmp0_;
#line 714 "../src/contacts-linking.vala"
	_tmp1_ = gee_linked_list_new (GEE_TYPE_HASH_SET, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL);
#line 714 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->old_personas_distribution);
#line 714 "../src/contacts-linking.vala"
	self->priv->old_personas_distribution = _tmp1_;
#line 711 "../src/contacts-linking.vala"
	return self;
#line 8294 "contacts-linking.c"
}

ContactsLinkOperation2*
contacts_link_operation2_new (ContactsStore* contacts_store)
{
#line 711 "../src/contacts-linking.vala"
	return contacts_link_operation2_construct (CONTACTS_TYPE_LINK_OPERATION2, contacts_store);
#line 8302 "contacts-linking.c"
}

void
contacts_link_operation2_add_persona_set (ContactsLinkOperation2* self,
                                          GeeSet* persona_set)
{
	gint _tmp0_;
	gint _tmp1_;
#line 717 "../src/contacts-linking.vala"
	g_return_if_fail (self != NULL);
#line 717 "../src/contacts-linking.vala"
	g_return_if_fail (persona_set != NULL);
#line 718 "../src/contacts-linking.vala"
	_tmp0_ = gee_collection_get_size ((GeeCollection*) persona_set);
#line 718 "../src/contacts-linking.vala"
	_tmp1_ = _tmp0_;
#line 718 "../src/contacts-linking.vala"
	if (_tmp1_ > 0) {
#line 8321 "contacts-linking.c"
		GeeHashSet* s = NULL;
		GeeHashSet* _tmp2_;
		GeeLinkedList* _tmp9_;
		GeeHashSet* _tmp10_;
#line 719 "../src/contacts-linking.vala"
		_tmp2_ = gee_hash_set_new (FOLKS_TYPE_PERSONA, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL);
#line 719 "../src/contacts-linking.vala"
		s = _tmp2_;
#line 8330 "contacts-linking.c"
		{
			GeeIterator* _p_it = NULL;
			GeeIterator* _tmp3_;
#line 720 "../src/contacts-linking.vala"
			_tmp3_ = gee_iterable_iterator ((GeeIterable*) persona_set);
#line 720 "../src/contacts-linking.vala"
			_p_it = _tmp3_;
#line 720 "../src/contacts-linking.vala"
			while (TRUE) {
#line 8340 "contacts-linking.c"
				GeeIterator* _tmp4_;
				FolksPersona* p = NULL;
				GeeIterator* _tmp5_;
				gpointer _tmp6_;
				GeeHashSet* _tmp7_;
				FolksPersona* _tmp8_;
#line 720 "../src/contacts-linking.vala"
				_tmp4_ = _p_it;
#line 720 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_tmp4_)) {
#line 720 "../src/contacts-linking.vala"
					break;
#line 8353 "contacts-linking.c"
				}
#line 720 "../src/contacts-linking.vala"
				_tmp5_ = _p_it;
#line 720 "../src/contacts-linking.vala"
				_tmp6_ = gee_iterator_get (_tmp5_);
#line 720 "../src/contacts-linking.vala"
				p = (FolksPersona*) _tmp6_;
#line 721 "../src/contacts-linking.vala"
				_tmp7_ = s;
#line 721 "../src/contacts-linking.vala"
				_tmp8_ = p;
#line 721 "../src/contacts-linking.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp7_, _tmp8_);
#line 720 "../src/contacts-linking.vala"
				_g_object_unref0 (p);
#line 8369 "contacts-linking.c"
			}
#line 720 "../src/contacts-linking.vala"
			_g_object_unref0 (_p_it);
#line 8373 "contacts-linking.c"
		}
#line 723 "../src/contacts-linking.vala"
		_tmp9_ = self->priv->old_personas_distribution;
#line 723 "../src/contacts-linking.vala"
		_tmp10_ = s;
#line 723 "../src/contacts-linking.vala"
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp9_, _tmp10_);
#line 718 "../src/contacts-linking.vala"
		_g_object_unref0 (s);
#line 8383 "contacts-linking.c"
	}
}

static void
contacts_link_operation2_undo_data_free (gpointer _data)
{
	ContactsLinkOperation2UndoData* _data_;
	_data_ = _data;
#line 704 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->self);
#line 704 "../src/contacts-linking.vala"
	g_slice_free (ContactsLinkOperation2UndoData, _data_);
#line 8396 "contacts-linking.c"
}

void
contacts_link_operation2_undo (ContactsLinkOperation2* self,
                               GAsyncReadyCallback _callback_,
                               gpointer _user_data_)
{
	ContactsLinkOperation2UndoData* _data_;
	ContactsLinkOperation2* _tmp0_;
#line 704 "../src/contacts-linking.vala"
	_data_ = g_slice_new0 (ContactsLinkOperation2UndoData);
#line 704 "../src/contacts-linking.vala"
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
#line 704 "../src/contacts-linking.vala"
	g_task_set_task_data (_data_->_async_result, _data_, contacts_link_operation2_undo_data_free);
#line 704 "../src/contacts-linking.vala"
	_tmp0_ = _g_object_ref0 (self);
#line 704 "../src/contacts-linking.vala"
	_data_->self = _tmp0_;
#line 704 "../src/contacts-linking.vala"
	contacts_link_operation2_undo_co (_data_);
#line 8418 "contacts-linking.c"
}

void
contacts_link_operation2_undo_finish (ContactsLinkOperation2* self,
                                      GAsyncResult* _res_)
{
	ContactsLinkOperation2UndoData* _data_;
#line 704 "../src/contacts-linking.vala"
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
#line 8428 "contacts-linking.c"
}

static void
contacts_link_operation2_undo_ready (GObject* source_object,
                                     GAsyncResult* _res_,
                                     gpointer _user_data_)
{
	ContactsLinkOperation2UndoData* _data_;
#line 738 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 738 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 738 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 738 "../src/contacts-linking.vala"
	contacts_link_operation2_undo_co (_data_);
#line 8445 "contacts-linking.c"
}

static gboolean
contacts_link_operation2_undo_co (ContactsLinkOperation2UndoData* _data_)
{
#line 727 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 727 "../src/contacts-linking.vala"
		case 0:
#line 8455 "contacts-linking.c"
		goto _state_0;
#line 727 "../src/contacts-linking.vala"
		case 1:
#line 8459 "contacts-linking.c"
		goto _state_1;
#line 727 "../src/contacts-linking.vala"
		case 2:
#line 8463 "contacts-linking.c"
		goto _state_2;
		default:
#line 727 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 8468 "contacts-linking.c"
	}
	_state_0:
#line 728 "../src/contacts-linking.vala"
	_data_->ind = NULL;
#line 729 "../src/contacts-linking.vala"
	_data_->_tmp0_ = _data_->self->priv->old_personas_distribution;
#line 729 "../src/contacts-linking.vala"
	_data_->_tmp1_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _data_->_tmp0_);
#line 729 "../src/contacts-linking.vala"
	_data_->_tmp2_ = _data_->_tmp1_;
#line 729 "../src/contacts-linking.vala"
	if (_data_->_tmp2_ > 0) {
#line 730 "../src/contacts-linking.vala"
		_data_->_tmp3_ = _data_->self->priv->old_personas_distribution;
#line 730 "../src/contacts-linking.vala"
		_data_->_tmp4_ = gee_linked_list_first (_data_->_tmp3_);
#line 730 "../src/contacts-linking.vala"
		_data_->ps = (GeeHashSet*) _data_->_tmp4_;
#line 8487 "contacts-linking.c"
		{
#line 731 "../src/contacts-linking.vala"
			_data_->_tmp5_ = _data_->ps;
#line 731 "../src/contacts-linking.vala"
			_data_->_tmp6_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _data_->_tmp5_);
#line 731 "../src/contacts-linking.vala"
			_data_->_p_it = _data_->_tmp6_;
#line 731 "../src/contacts-linking.vala"
			while (TRUE) {
#line 731 "../src/contacts-linking.vala"
				_data_->_tmp7_ = _data_->_p_it;
#line 731 "../src/contacts-linking.vala"
				if (!gee_iterator_next (_data_->_tmp7_)) {
#line 731 "../src/contacts-linking.vala"
					break;
#line 8503 "contacts-linking.c"
				}
#line 731 "../src/contacts-linking.vala"
				_data_->_tmp8_ = _data_->_p_it;
#line 731 "../src/contacts-linking.vala"
				_data_->_tmp9_ = gee_iterator_get (_data_->_tmp8_);
#line 731 "../src/contacts-linking.vala"
				_data_->p = (FolksPersona*) _data_->_tmp9_;
#line 732 "../src/contacts-linking.vala"
				_data_->_tmp10_ = _data_->p;
#line 732 "../src/contacts-linking.vala"
				_data_->_tmp11_ = folks_persona_get_individual (_data_->_tmp10_);
#line 732 "../src/contacts-linking.vala"
				_data_->_tmp12_ = _data_->_tmp11_;
#line 732 "../src/contacts-linking.vala"
				_data_->_tmp13_ = _g_object_ref0 (_data_->_tmp12_);
#line 732 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->ind);
#line 732 "../src/contacts-linking.vala"
				_data_->ind = _data_->_tmp13_;
#line 733 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->p);
#line 733 "../src/contacts-linking.vala"
				break;
#line 8527 "contacts-linking.c"
			}
#line 731 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_p_it);
#line 8531 "contacts-linking.c"
		}
#line 729 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->ps);
#line 8535 "contacts-linking.c"
	}
#line 736 "../src/contacts-linking.vala"
	_data_->_tmp14_ = _data_->ind;
#line 736 "../src/contacts-linking.vala"
	if (_data_->_tmp14_ != NULL) {
#line 8541 "contacts-linking.c"
		{
#line 738 "../src/contacts-linking.vala"
			_data_->_tmp15_ = _data_->self->priv->contacts_store;
#line 738 "../src/contacts-linking.vala"
			_data_->_tmp16_ = contacts_store_get_aggregator (_data_->_tmp15_);
#line 738 "../src/contacts-linking.vala"
			_data_->_tmp17_ = _data_->_tmp16_;
#line 738 "../src/contacts-linking.vala"
			_data_->_tmp18_ = _data_->ind;
#line 738 "../src/contacts-linking.vala"
			_data_->_state_ = 1;
#line 738 "../src/contacts-linking.vala"
			folks_individual_aggregator_unlink_individual (_data_->_tmp17_, _data_->_tmp18_, contacts_link_operation2_undo_ready, _data_);
#line 738 "../src/contacts-linking.vala"
			return FALSE;
#line 8557 "contacts-linking.c"
			_state_1:
#line 738 "../src/contacts-linking.vala"
			folks_individual_aggregator_unlink_individual_finish (_data_->_tmp17_, _data_->_res_, &_data_->_inner_error0_);
#line 738 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 8563 "contacts-linking.c"
				goto __catch23_g_error;
			}
		}
		goto __finally23;
		__catch23_g_error:
		{
#line 737 "../src/contacts-linking.vala"
			_data_->e1 = _data_->_inner_error0_;
#line 737 "../src/contacts-linking.vala"
			_data_->_inner_error0_ = NULL;
#line 740 "../src/contacts-linking.vala"
			_data_->_tmp19_ = _data_->ind;
#line 740 "../src/contacts-linking.vala"
			_data_->_tmp20_ = folks_individual_get_id (_data_->_tmp19_);
#line 740 "../src/contacts-linking.vala"
			_data_->_tmp21_ = _data_->_tmp20_;
#line 740 "../src/contacts-linking.vala"
			_data_->_tmp22_ = _data_->e1;
#line 740 "../src/contacts-linking.vala"
			_data_->_tmp23_ = _data_->_tmp22_->message;
#line 740 "../src/contacts-linking.vala"
			g_warning ("contacts-linking.vala:740: Error unlinking individual %s: %s", _data_->_tmp21_, _data_->_tmp23_);
#line 737 "../src/contacts-linking.vala"
			_g_error_free0 (_data_->e1);
#line 8588 "contacts-linking.c"
		}
		__finally23:
#line 737 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 737 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->ind);
#line 737 "../src/contacts-linking.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 737 "../src/contacts-linking.vala"
			g_clear_error (&_data_->_inner_error0_);
#line 737 "../src/contacts-linking.vala"
			g_object_unref (_data_->_async_result);
#line 737 "../src/contacts-linking.vala"
			return FALSE;
#line 8603 "contacts-linking.c"
		}
	}
	{
#line 744 "../src/contacts-linking.vala"
		_data_->_tmp24_ = _data_->self->priv->old_personas_distribution;
#line 744 "../src/contacts-linking.vala"
		_data_->_tmp25_ = _g_object_ref0 (_data_->_tmp24_);
#line 744 "../src/contacts-linking.vala"
		_data_->_ps_list = _data_->_tmp25_;
#line 744 "../src/contacts-linking.vala"
		_data_->_tmp26_ = _data_->_ps_list;
#line 744 "../src/contacts-linking.vala"
		_data_->_tmp27_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _data_->_tmp26_);
#line 744 "../src/contacts-linking.vala"
		_data_->_tmp28_ = _data_->_tmp27_;
#line 744 "../src/contacts-linking.vala"
		_data_->_ps_size = _data_->_tmp28_;
#line 744 "../src/contacts-linking.vala"
		_data_->_ps_index = -1;
#line 744 "../src/contacts-linking.vala"
		while (TRUE) {
#line 744 "../src/contacts-linking.vala"
			_data_->_ps_index = _data_->_ps_index + 1;
#line 744 "../src/contacts-linking.vala"
			if (!(_data_->_ps_index < _data_->_ps_size)) {
#line 744 "../src/contacts-linking.vala"
				break;
#line 8631 "contacts-linking.c"
			}
#line 744 "../src/contacts-linking.vala"
			_data_->_tmp29_ = _data_->_ps_list;
#line 744 "../src/contacts-linking.vala"
			_data_->_tmp30_ = gee_abstract_list_get ((GeeAbstractList*) _data_->_tmp29_, _data_->_ps_index);
#line 744 "../src/contacts-linking.vala"
			_data_->_vala1_ps = (GeeHashSet*) _data_->_tmp30_;
#line 8639 "contacts-linking.c"
			{
#line 746 "../src/contacts-linking.vala"
				_data_->_tmp31_ = _data_->self->priv->contacts_store;
#line 746 "../src/contacts-linking.vala"
				_data_->_tmp32_ = contacts_store_get_aggregator (_data_->_tmp31_);
#line 746 "../src/contacts-linking.vala"
				_data_->_tmp33_ = _data_->_tmp32_;
#line 746 "../src/contacts-linking.vala"
				_data_->_tmp34_ = _data_->_vala1_ps;
#line 746 "../src/contacts-linking.vala"
				_data_->_state_ = 2;
#line 746 "../src/contacts-linking.vala"
				folks_individual_aggregator_link_personas (_data_->_tmp33_, (GeeSet*) _data_->_tmp34_, contacts_link_operation2_undo_ready, _data_);
#line 746 "../src/contacts-linking.vala"
				return FALSE;
#line 8655 "contacts-linking.c"
				_state_2:
#line 746 "../src/contacts-linking.vala"
				folks_individual_aggregator_link_personas_finish (_data_->_tmp33_, _data_->_res_, &_data_->_inner_error0_);
#line 746 "../src/contacts-linking.vala"
				if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 8661 "contacts-linking.c"
					goto __catch24_g_error;
				}
			}
			goto __finally24;
			__catch24_g_error:
			{
#line 745 "../src/contacts-linking.vala"
				_data_->_vala1_e1 = _data_->_inner_error0_;
#line 745 "../src/contacts-linking.vala"
				_data_->_inner_error0_ = NULL;
#line 748 "../src/contacts-linking.vala"
				_data_->_tmp35_ = _data_->_vala1_e1;
#line 748 "../src/contacts-linking.vala"
				_data_->_tmp36_ = _data_->_tmp35_->message;
#line 748 "../src/contacts-linking.vala"
				g_warning ("contacts-linking.vala:748: Error linking personas: %s", _data_->_tmp36_);
#line 745 "../src/contacts-linking.vala"
				_g_error_free0 (_data_->_vala1_e1);
#line 8680 "contacts-linking.c"
			}
			__finally24:
#line 745 "../src/contacts-linking.vala"
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 745 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_vala1_ps);
#line 745 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->_ps_list);
#line 745 "../src/contacts-linking.vala"
				_g_object_unref0 (_data_->ind);
#line 745 "../src/contacts-linking.vala"
				g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 745 "../src/contacts-linking.vala"
				g_clear_error (&_data_->_inner_error0_);
#line 745 "../src/contacts-linking.vala"
				g_object_unref (_data_->_async_result);
#line 745 "../src/contacts-linking.vala"
				return FALSE;
#line 8699 "contacts-linking.c"
			}
#line 744 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->_vala1_ps);
#line 8703 "contacts-linking.c"
		}
#line 744 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_ps_list);
#line 8707 "contacts-linking.c"
	}
#line 727 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->ind);
#line 727 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 727 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 727 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 727 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 8719 "contacts-linking.c"
		}
	}
#line 727 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 727 "../src/contacts-linking.vala"
	return FALSE;
#line 8726 "contacts-linking.c"
}

static void
contacts_link_operation2_class_init (ContactsLinkOperation2Class * klass,
                                     gpointer klass_data)
{
#line 704 "../src/contacts-linking.vala"
	contacts_link_operation2_parent_class = g_type_class_peek_parent (klass);
#line 704 "../src/contacts-linking.vala"
	g_type_class_adjust_private_offset (klass, &ContactsLinkOperation2_private_offset);
#line 704 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (klass)->finalize = contacts_link_operation2_finalize;
#line 8739 "contacts-linking.c"
}

static void
contacts_link_operation2_instance_init (ContactsLinkOperation2 * self,
                                        gpointer klass)
{
#line 704 "../src/contacts-linking.vala"
	self->priv = contacts_link_operation2_get_instance_private (self);
#line 8748 "contacts-linking.c"
}

static void
contacts_link_operation2_finalize (GObject * obj)
{
	ContactsLinkOperation2 * self;
#line 704 "../src/contacts-linking.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, CONTACTS_TYPE_LINK_OPERATION2, ContactsLinkOperation2);
#line 705 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->contacts_store);
#line 709 "../src/contacts-linking.vala"
	_g_object_unref0 (self->priv->old_personas_distribution);
#line 704 "../src/contacts-linking.vala"
	G_OBJECT_CLASS (contacts_link_operation2_parent_class)->finalize (obj);
#line 8763 "contacts-linking.c"
}

static GType
contacts_link_operation2_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (ContactsLinkOperation2Class), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) contacts_link_operation2_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ContactsLinkOperation2), 0, (GInstanceInitFunc) contacts_link_operation2_instance_init, NULL };
	GType contacts_link_operation2_type_id;
	contacts_link_operation2_type_id = g_type_register_static (G_TYPE_OBJECT, "ContactsLinkOperation2", &g_define_type_info, 0);
	ContactsLinkOperation2_private_offset = g_type_add_instance_private (contacts_link_operation2_type_id, sizeof (ContactsLinkOperation2Private));
	return contacts_link_operation2_type_id;
}

GType
contacts_link_operation2_get_type (void)
{
	static volatile gsize contacts_link_operation2_type_id__volatile = 0;
	if (g_once_init_enter (&contacts_link_operation2_type_id__volatile)) {
		GType contacts_link_operation2_type_id;
		contacts_link_operation2_type_id = contacts_link_operation2_get_type_once ();
		g_once_init_leave (&contacts_link_operation2_type_id__volatile, contacts_link_operation2_type_id);
	}
	return contacts_link_operation2_type_id__volatile;
}

static void
contacts_link_contacts_list_data_free (gpointer _data)
{
	ContactsLinkContactsListData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->contact_list);
	_g_object_unref0 (_data_->contacts_store);
	_g_object_unref0 (_data_->result);
	g_slice_free (ContactsLinkContactsListData, _data_);
}

void
contacts_link_contacts_list (GeeLinkedList* contact_list,
                             ContactsStore* contacts_store,
                             GAsyncReadyCallback _callback_,
                             gpointer _user_data_)
{
	ContactsLinkContactsListData* _data_;
	GeeLinkedList* _tmp0_;
	ContactsStore* _tmp1_;
	_data_ = g_slice_new0 (ContactsLinkContactsListData);
	_data_->_async_result = g_task_new (NULL, NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, contacts_link_contacts_list_data_free);
	_tmp0_ = _g_object_ref0 (contact_list);
	_g_object_unref0 (_data_->contact_list);
	_data_->contact_list = _tmp0_;
	_tmp1_ = _g_object_ref0 (contacts_store);
	_g_object_unref0 (_data_->contacts_store);
	_data_->contacts_store = _tmp1_;
	contacts_link_contacts_list_co (_data_);
}

ContactsLinkOperation2*
contacts_link_contacts_list_finish (GAsyncResult* _res_)
{
	ContactsLinkOperation2* result;
	ContactsLinkContactsListData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
	result = _data_->result;
	_data_->result = NULL;
	return result;
}

static void
contacts_link_contacts_list_ready (GObject* source_object,
                                   GAsyncResult* _res_,
                                   gpointer _user_data_)
{
	ContactsLinkContactsListData* _data_;
#line 765 "../src/contacts-linking.vala"
	_data_ = _user_data_;
#line 765 "../src/contacts-linking.vala"
	_data_->_source_object_ = source_object;
#line 765 "../src/contacts-linking.vala"
	_data_->_res_ = _res_;
#line 765 "../src/contacts-linking.vala"
	contacts_link_contacts_list_co (_data_);
#line 8845 "contacts-linking.c"
}

static gboolean
contacts_link_contacts_list_co (ContactsLinkContactsListData* _data_)
{
#line 754 "../src/contacts-linking.vala"
	switch (_data_->_state_) {
#line 754 "../src/contacts-linking.vala"
		case 0:
#line 8855 "contacts-linking.c"
		goto _state_0;
#line 754 "../src/contacts-linking.vala"
		case 1:
#line 8859 "contacts-linking.c"
		goto _state_1;
		default:
#line 754 "../src/contacts-linking.vala"
		g_assert_not_reached ();
#line 8864 "contacts-linking.c"
	}
	_state_0:
#line 755 "../src/contacts-linking.vala"
	_data_->_tmp0_ = contacts_link_operation2_new (_data_->contacts_store);
#line 755 "../src/contacts-linking.vala"
	_data_->operation = _data_->_tmp0_;
#line 757 "../src/contacts-linking.vala"
	_data_->_tmp1_ = gee_hash_set_new (FOLKS_TYPE_PERSONA, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL);
#line 757 "../src/contacts-linking.vala"
	_data_->all_personas = _data_->_tmp1_;
#line 8875 "contacts-linking.c"
	{
#line 758 "../src/contacts-linking.vala"
		_data_->_tmp2_ = _g_object_ref0 (_data_->contact_list);
#line 758 "../src/contacts-linking.vala"
		_data_->_i_list = _data_->_tmp2_;
#line 758 "../src/contacts-linking.vala"
		_data_->_tmp3_ = _data_->_i_list;
#line 758 "../src/contacts-linking.vala"
		_data_->_tmp4_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _data_->_tmp3_);
#line 758 "../src/contacts-linking.vala"
		_data_->_tmp5_ = _data_->_tmp4_;
#line 758 "../src/contacts-linking.vala"
		_data_->_i_size = _data_->_tmp5_;
#line 758 "../src/contacts-linking.vala"
		_data_->_i_index = -1;
#line 758 "../src/contacts-linking.vala"
		while (TRUE) {
#line 758 "../src/contacts-linking.vala"
			_data_->_i_index = _data_->_i_index + 1;
#line 758 "../src/contacts-linking.vala"
			if (!(_data_->_i_index < _data_->_i_size)) {
#line 758 "../src/contacts-linking.vala"
				break;
#line 8899 "contacts-linking.c"
			}
#line 758 "../src/contacts-linking.vala"
			_data_->_tmp6_ = _data_->_i_list;
#line 758 "../src/contacts-linking.vala"
			_data_->_tmp7_ = gee_abstract_list_get ((GeeAbstractList*) _data_->_tmp6_, _data_->_i_index);
#line 758 "../src/contacts-linking.vala"
			_data_->i = (FolksIndividual*) _data_->_tmp7_;
#line 759 "../src/contacts-linking.vala"
			_data_->_tmp8_ = _data_->i;
#line 759 "../src/contacts-linking.vala"
			_data_->_tmp9_ = folks_individual_get_personas (_data_->_tmp8_);
#line 759 "../src/contacts-linking.vala"
			_data_->_tmp10_ = _data_->_tmp9_;
#line 759 "../src/contacts-linking.vala"
			_data_->_tmp11_ = _g_object_ref0 (_data_->_tmp10_);
#line 759 "../src/contacts-linking.vala"
			_data_->ps = _data_->_tmp11_;
#line 760 "../src/contacts-linking.vala"
			_data_->_tmp12_ = _data_->all_personas;
#line 760 "../src/contacts-linking.vala"
			_data_->_tmp13_ = _data_->ps;
#line 760 "../src/contacts-linking.vala"
			gee_collection_add_all ((GeeCollection*) _data_->_tmp12_, (GeeCollection*) _data_->_tmp13_);
#line 761 "../src/contacts-linking.vala"
			_data_->_tmp14_ = _data_->operation;
#line 761 "../src/contacts-linking.vala"
			_data_->_tmp15_ = _data_->ps;
#line 761 "../src/contacts-linking.vala"
			contacts_link_operation2_add_persona_set (_data_->_tmp14_, _data_->_tmp15_);
#line 758 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->ps);
#line 758 "../src/contacts-linking.vala"
			_g_object_unref0 (_data_->i);
#line 8933 "contacts-linking.c"
		}
#line 758 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->_i_list);
#line 8937 "contacts-linking.c"
	}
	{
#line 765 "../src/contacts-linking.vala"
		_data_->_tmp16_ = contacts_store_get_aggregator (_data_->contacts_store);
#line 765 "../src/contacts-linking.vala"
		_data_->_tmp17_ = _data_->_tmp16_;
#line 765 "../src/contacts-linking.vala"
		_data_->_tmp18_ = _data_->all_personas;
#line 765 "../src/contacts-linking.vala"
		_data_->_state_ = 1;
#line 765 "../src/contacts-linking.vala"
		folks_individual_aggregator_link_personas (_data_->_tmp17_, (GeeSet*) _data_->_tmp18_, contacts_link_contacts_list_ready, _data_);
#line 765 "../src/contacts-linking.vala"
		return FALSE;
#line 8952 "contacts-linking.c"
		_state_1:
#line 765 "../src/contacts-linking.vala"
		folks_individual_aggregator_link_personas_finish (_data_->_tmp17_, _data_->_res_, &_data_->_inner_error0_);
#line 765 "../src/contacts-linking.vala"
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 8958 "contacts-linking.c"
			goto __catch25_g_error;
		}
	}
	goto __finally25;
	__catch25_g_error:
	{
#line 764 "../src/contacts-linking.vala"
		_data_->e1 = _data_->_inner_error0_;
#line 764 "../src/contacts-linking.vala"
		_data_->_inner_error0_ = NULL;
#line 767 "../src/contacts-linking.vala"
		_data_->_tmp19_ = _data_->e1;
#line 767 "../src/contacts-linking.vala"
		_data_->_tmp20_ = _data_->_tmp19_->message;
#line 767 "../src/contacts-linking.vala"
		g_warning ("contacts-linking.vala:767: Error linking personas: %s", _data_->_tmp20_);
#line 764 "../src/contacts-linking.vala"
		_g_error_free0 (_data_->e1);
#line 8977 "contacts-linking.c"
	}
	__finally25:
#line 764 "../src/contacts-linking.vala"
	if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
#line 764 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->all_personas);
#line 764 "../src/contacts-linking.vala"
		_g_object_unref0 (_data_->operation);
#line 764 "../src/contacts-linking.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
#line 764 "../src/contacts-linking.vala"
		g_clear_error (&_data_->_inner_error0_);
#line 764 "../src/contacts-linking.vala"
		g_object_unref (_data_->_async_result);
#line 764 "../src/contacts-linking.vala"
		return FALSE;
#line 8994 "contacts-linking.c"
	}
#line 770 "../src/contacts-linking.vala"
	_data_->result = _data_->operation;
#line 770 "../src/contacts-linking.vala"
	_g_object_unref0 (_data_->all_personas);
#line 770 "../src/contacts-linking.vala"
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
#line 770 "../src/contacts-linking.vala"
	if (_data_->_state_ != 0) {
#line 770 "../src/contacts-linking.vala"
		while (!g_task_get_completed (_data_->_async_result)) {
#line 770 "../src/contacts-linking.vala"
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
#line 9008 "contacts-linking.c"
		}
	}
#line 770 "../src/contacts-linking.vala"
	g_object_unref (_data_->_async_result);
#line 770 "../src/contacts-linking.vala"
	return FALSE;
#line 9015 "contacts-linking.c"
}

